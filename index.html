<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="ZJH"><meta name="copyright" content="ZJH"><title>Zany's Blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  hexoVersion: '7.3.0'
} </script><meta name="generator" content="Hexo 7.3.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">ZJH</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">12</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">19</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">8</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Zany's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Zany's Blog</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/">【转载】最强分析 ｜一文理解Lumen及全局光照的实现机制</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2026-01-18</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%BD%AC%E8%BD%BD/">转载</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/">计算机</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/">图形学</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Games-104/">Games 104</a></span><div class="content"><h1 id="最强分析-｜一文理解Lumen及全局光照的实现机制"><a href="#最强分析-｜一文理解Lumen及全局光照的实现机制" class="headerlink" title="最强分析 ｜一文理解Lumen及全局光照的实现机制"></a>最强分析 ｜一文理解Lumen及全局光照的实现机制</h1><p> <strong>Author:</strong> [GAMES104官方账号]</p>
<p> <strong>Link:</strong> [<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/643337359]">https://zhuanlan.zhihu.com/p/643337359]</a></p>
<h2 id="Dynamic-Global-Illumination-andLumen"><a href="#Dynamic-Global-Illumination-andLumen" class="headerlink" title="Dynamic Global Illumination andLumen"></a>Dynamic Global Illumination andLumen</h2><p>我们今天的课程主题是动态全局光照和Lumen ，在讲Lumen之前，我们需要首先需要了解GI（Global Illumination），如果不把GI讲清楚，大家将会陷入Lumen复杂深邃的技术细节中。<br>如果不了解GI的发展演变，大家会感觉Lumen中的某些细节处理是凭空从天上掉下来的。但其实不然，Lumen中的很多算法和思想在之前的一些GI算法中都有出现和实践过，因此Lumen更像一个各种GI算法的集大成者。我们只有理解GI最宏观的体系结构，你才能理解Lumen 是怎么产生的。</p>
<h3 id="一-Global-Illumination"><a href="#一-Global-Illumination" class="headerlink" title="一. Global Illumination"></a>一. Global Illumination</h3><p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-78547d4764131258e357a7cedab05711_1440w.jpg">  </p>
<p>第一步我们是要了解渲染中最著名的Render Equation ，这在之前的课程中也讲到过。我们今天几乎做的所有Rendering 相关的工作都是去满足这个Render Equation 。但是至今为止，没有任何一款游戏引擎能够做到实时的完全按照Render Equation来进行渲染，我们能做到的只是在无限的逼近它。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-75ea529e0b2f17fa8d47b69cd4bd92ec_1440w.jpg">  </p>
<p>如果只计算点光（Point Lighting）的直接光照（Direct Lighting）还是比较简单的。但 GI 并不只计算点光，而是需要计算四面八方照的光，这些光和物体表面的 BRDF方程都要进行积分，才能形成我最终的光照。</p>
<p>这里面复杂的积分过程非常麻烦，电脑屏幕上拥有百万甚至千万级别的 pixel 。对于每个pixel，都要去采集四面八方射过来的光线，从而计算出它的积分值。离线情况尚且困难，更何况是实时的情况下，一秒钟还要渲染几十帧甚至上百帧，这里面的计算量简直恐怖如斯。</p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-69e56d2bbd4b801b525e06d2869596e7_1440w.jpg">  </p>
<p>更糟糕的是，需要计算的光线数量严格意义上是无限多的。就算你在场景里面只摆放了一个光源，但这个光源可以把周围物体无数个小面片照亮，每一个被照亮的小面片依旧可以视为一个新的光源来照亮其他物体。同时被这些小面片照亮的其他地方也会继续反弹光线。我们把只进行一次反弹叫做 SingleBounce，把多次反弹叫做 MultiBounce 。<br>上图右侧是著名的渲染场景康奈尔盒（Cornell Box），通过比较渲染场景和同一场景的实际照片来确定渲染的准确性。它的左边是红色，右边是绿色，上面放置一个光源，下面放有一个长方块和一个方形块。这里需要注意的是，上方放置的光源并不是点光源，而是一个面光源，因此光源本身就可以分解成无限多个。就算是Cornell Box 这么简单的场景，如果你想把它做到接近真实也是非常困难的，并且如果想要做到实时渲染更是难上加难。<br>我们如果仔细观察，这个简单场景中的的光学现象其实非常复杂。光源照射到红色墙反弹回来后会出现很多红光，红光会照亮这长方块的左侧面。同样，右边墙上也看到绿色。而这就是 GI 的效果。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-47f813b1694ffa609b968af4abad7446_1440w.jpg"><br>我们以游戏为例，如果游戏中只有直接光照，最终的效果就如上图左侧一样。而通常我们在游戏看到的效果并非如此，因为通常我们还会加上环境光。环境光其实是对 GI 的一个 hack，如上图右侧。虽然有了环境光的效果会让场景显得好了一点，但依旧达不到真正GI非常丰富且复杂效果。<br>阳光投进洞口的岩洞，拉开窗帘的房间，打着手电的傍晚，这些场景如果没有GI 来模拟复杂MultiBounce 的光学现象，整个画面会看上去非常塑料。因此我们需要去实现GI的这种效果。<br>Monte Carlo Integration  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-734cf1b5867b2d28b981af4373dcecbe_1440w.jpg"><br>如之前所述，Global Illumination 中最复杂的问题就是积分，通常来讲，我们可以使用蒙特卡罗（Monte Carlo）积分法来解决这个积分。蒙特卡洛是一类统计模拟的积分方法，在求解积分时，如果找不到被积函数的原函数，那么利用经典积分方法是得不到积分结果的，但是蒙特卡洛积分方法告诉我们，利用一个随机变量对被积函数进行采样（Sampling），并将采样值进行一定的处理，那么当拥有一定数量的采样时，最终估算得到的结果可以很好的近似原积分的结果。这样一来，我们就不用去求原函数的形式，就能求得积分的近似结果。<br>他的想法其实非常简单，假设对于一个函数f(x)区间 A 到 B ，我们在做Render 时的积分区间就是在法线朝向的半球上进行积分。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-dcabff7e11d3eccf0980292deb1a307a_1440w.jpg">  </p>
<p>我们对于区间A到B内的点进行采样，得到每一个点的函数值，然后进行平均，就能知道你的这个积分的估算值是多少。对于 Shading 来讲，就是采样多个方向的光线计算的Radiance，最后把他们加在一起。</p>
<h3 id="二-Monte-Carlo-Ray-Tracing"><a href="#二-Monte-Carlo-Ray-Tracing" class="headerlink" title="二.Monte Carlo Ray Tracing"></a>二.Monte Carlo Ray Tracing</h3><p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-756f5f37d102d7d30983a0dfb6b95bcc_1440w.jpg">  </p>
<p>使用Monte Carlo 求解GI 最直接的应用就是Monte Carlo Ray Tracing。<br>Monte Carlo Ray Tracing的思想非常简单，首先从我们的眼睛出发，也就是屏幕上的每个像素，发出射线（Ray），这些射线会射中场景中的某个物体。我们从被射中的位置点出发，再往它的四面八方去投射射线（1 Bounce），这些发出的射线会打中其他的物体，它又会在新的点向四周发射射线（2 Bounce），以此类推。在此期间，如果某根Ray射中了光源，那么我们就可以根据这条路径计算出对应的Radiance 。<br>Monte Carlo Ray Tracing通过多次反弹，每增加一层Bounce的，它的计算复杂度会进行指数级的扩张。SingleBounce如果还能勉强接受，但是MultiBounce计算量会随着迭代的次数急速膨胀。<br>我们需要注意的是，在我们实际应用的场景中，真正对于结果有贡献，或者说有亮度的地方是非常不均匀的。比如说一个硕大无比的房间，它真正亮的地方可能就是阳光射进窗子里的那一部分。你的整个房间都是被就是被它的MultiBounce照亮。这个时候你在进行采样的时候，你会经常发现，只有极少数的射线有机会打中窗子，绝大多数射线只会采样到了房间内黑暗的部分，根本没采到光。<br>因此Monte Carlo Ray Tracing 最大的问题实际上就是采样，因为采样是随机的，所以没有办法保证相邻的 pixel A 和 pixel B 能够产生同样的结果，A可能采样到了光，而B则没有，因此你会在屏幕上看到很多的噪点。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-695bac0d64bd8ebd0520668e2a80903d_1440w.jpg">  </p>
<p>如上图所示，最左上角的图中是每次只发射一根射线，可以看到会有很明显的 Noise 。之后它每一张图从左到右从上到下采样数量都是翻倍的。<br>因此右下角图中的射线数量是2的16次方64,000 条射线。可以看到最后渲染的结果已经非常 Smooth 了。如果我们只需要一次Bounce 的结果 ，如果硬件够狠，几分钟你也许能渲染出来，但是如果是 MultiBounce 的话，依旧需要非常非常久的时间才能得到结果。<br>综上所述，你会发现基于Monte Carlo的方法，你的 Sampling数量越多效果越好，但是也会越慢。如何 Sampling是所有基于蒙特卡罗的GI 方法的核心。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-e73b314b7d26a7ab66292fddff07ae01_1440w.jpg">  </p>
<p>Sampling最简单的方法就是均匀采样 （Uniform Sampling）。但是绝大部分情况下信号的分布是不均匀的。使用Uniform Sampling除非密度很高，否则的话得出的结果其实并不尽如人意。如同上面我们的例子中，在一个房间内只有一个窗子是亮的，渲染的时候你在半球内实施Uniform Sampling，只有很少的射线能够采样到窗户。这就是Uniform Sampling 的一个问题。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-99dcdf17d82f149161afa3db776e3083_1440w.jpg">  </p>
<p>我们要引入一个很有意思的概念叫概率密度函数（probability distribution function )PDF。我们按照PDF的概率去选取我们的采样点，而不是按区间A到B均匀分布。我们只要在积分中除以选取采样点的概率，最后算出的积分是等价的。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-886e9e52d0f9f2ed134b9e2b4a7df3c7_1440w.jpg">  </p>
<p>如上图所示，蓝色函数是我们要求解的函数，我们选取与被积函数 f(x) 相似的概率密度函数 p(x) 。根据 p(x) 在f(x) 越大的地方，采样点选取的概率越大，也就是信号强烈的地方，我们的采样点会比其他地方更多，在f(x)值较小的地方，采样点的选取的概率越小。在数学上可以证明，这样的采样方法，可以用尽可能少的采样来获取更为逼近的真实积分值的结果。<br>这个概念其实也很简单，我们尽可能朝着光比较亮的地方，或者尽可能沿着我的法线正对的地方去多投射一些采样的射线，那这样的话我就可以用更少量的射线来获得我想要的结果。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-845e2f59368207f6f3adcb66d03a090b_1440w.jpg">  </p>
<p>我们在做 Rendering 的时候，如果假设大部分反射是 diffuse的 ，对光的这个敏感度就是一个Cosine Lobe，靠近法线（Normal）的方向会敏感，然后对其他的角度衰减扩散。就算你的光线很强，但你是从很侧面射来，我对这个光的感应度其实也并不高。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-f920c7eb772421fec52de8ac2be54571_1440w.jpg">  </p>
<p>如上图，左边是Uniform Sampling，而右边是Cosine Lobe，也就是采样点的分布会稍微密集的靠近天顶的地方，你可以发现同样是256 spp( Sampling per pixel)，使用Uniform Sampling会有很多噪点，而Cosine Lobe噪点会明显下降 。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-f8bf0c87cc5ffa64e0aaee5d7d460f4b_1440w.jpg">  </p>
<p>如上图所示，GGX材质高频足够高低频足够宽。这种情况下，我们使用GGX 的PDF会比使用Cosine Lobe更为Sharp，更能表达Glossy的效果。<br>总而言之，GI 核心是你需要去找到一个好的 Sampling 方法，用尽可能少的射线去获取一个来自于四面八方的光场提供给你的信息。</p>
<h3 id="三-Reflective-Shadow-Map-RSM"><a href="#三-Reflective-Shadow-Map-RSM" class="headerlink" title="三.Reflective Shadow Map(RSM )"></a>三.Reflective Shadow Map(RSM )</h3><p>前面我讲了Monte Carlo Ray Tracing的GI 算法，但它是一种离线方案，通常是在电影行业中使用，因为这种方案对于实时计算的游戏来说太过昂贵。这一章节们来讲 Reflective Shadow map(RSM )，它核心解决的问题是我怎么把光注入到场景中去。<br>在图形学里面，我们大致有两类的GI方法，一类就是之前最经典的Monte Carlo Ray Tracing。另一个著名的方法叫做光子映射（Photon Mapping）。<br>Photon Mapping 的思想非常有意思，和我们之前的Ray tracing从相机为原点发出射线向整个世界不同，Photon Mapping 是从光源出发。Photon Mapping的思想是：我们之所以能看到世界中的物体，原因是因为从光源射出来的光子打到了物体表面，进而不停地反弹，人眼收集到了这些光子，进而你看到了整个世界。因此Photon Mapping使用光学中最基础的概念，从光的角度去看待整个问题。<br>关于Photon Mapping具体的实现细节，我们今天就不展开了。简单的讲Photon Mapping就是说我发射出无数的光子，然后这些光子在物体的表面来回 Bounce 。当到达一定条件后，那些光子就会停留在物体表面。我们在做 Shading 时，收集这些Photon然后进行插值，最后得出Shading的结果。 这就是Photon Mapping一个核心思想，大家如果有兴趣的话可以查阅相关的资料。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-ca3e33d78185b334abdc55356040551d_1440w.jpg">  </p>
<p>接着我们来讲 RSM ，它的想法基于一个直观的观察。我们在渲染阴影的时候，需要渲染一帧 Shadow Map，Shadow Map的渲染和正常的渲染不同，正常的渲染是从当前相机的视角去渲染。而 Shadow Map 是从光源的位置和视角去渲染。<br>因此，如果我们从光源的位置和视角，把整个场景正常渲染一遍，当只有直接光照的时候，所有被光源照亮的物体表面都会渲染到我的Map 里面。换句话说，从光的位置，你能看到所有被它直接照亮的表面。所有被第一次被灯光照亮的表面将被我渲染进去，一个像素不会多，一个像素也不会少。<br>当然这里我们除了存储光照通量之外，还需要存储WorldPos 和Normal，以提供给后续 Shading 读取。那么在做Shading 的时候，就提前拥有了RSM，我们就能知道所有在空间中被光源第一次照亮的点和它对应的亮度信息。<br>对应上图，假设我们要渲染X点的光照值，X点因为被桌子挡住，光源无法直接照亮这个点，因此X点并没有直接光照。我们根据之前渲染的那张Reflective Shadow Map，得知光源会射到 Xp 点，Xp点会沿着它的法线方向进行散射，我就可以把Xp 点的 Radiance 给接过来进行 Shading 。这就是RSM的一个核心想法。   </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-e6d287703564c502be4859bd9afbfe9b_1440w.jpg">  </p>
<p>以此类推，最简单直接的方法就是将RSM中的每个像素都当成是一个小光源，把RSM上的每一个点都进行一次渲染，但这个方法有个问题就是过于粗暴，比如RSM分辨率大小是 512x512，那也是将近有几十万个点。把每个像素都当作光源渲染一遍是一个极度缓慢的过程。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-77ed1a4269f71669b8224c0001131ea7_1440w.jpg">  </p>
<p>我们的改进的思路也很简单，距离我们比较近的间接光照对我们的影响最大，比较远的那些采样点贡献度则更低，因此我们不去对RSM上每个点都去采样，而是在世界空间中去不同方向发射Cone Tracing ，并且各个方向的方向采样密度不相同。如果某个方向上采样点距离比较远，我们采样的密度低一些，如果比较近，我们采样的密度会高一些。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-b6ba43b0292782ec6d8684d510a1ed10_1440w.jpg">  </p>
<p>RSM只需要 400 次采样就能得到 1 bounce 的 GI 的效果，这也说明间接光照其实是非常低频的数据，它并不像直接光照那么高频。根据这个思想，我们可以用更低分辨率来计算间接光照，也就是每隔两个或者每隔四个pixel来做一次间接光计算，旁边像素可以跟共用周围像素计算的结果。<br>当然这也会产生一些问题，如果采样点和我当前渲染像素空间位置相差很大，或者法线朝向不共面，会产生很多Artifact 。当然这些渲染错误的 pixel 不会很多，对于整个屏幕来讲可能不到 1% 甚至千分之一。因此对于这种情况，我们就认为这是个无效的差值，重新对它进行一次完整的采样。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-2104ac087328051ea87480028bd4754c_1440w.jpg">  </p>
<p>很早以前的游戏中其实已经实现了RMS，所以你可以在游戏中看到手电筒照照亮周围物体的效果。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-e5080dfcf4811dce3f90f0a66eba63b0_1440w.jpg">  </p>
<p>我们非常感谢RSM，首先想到了用把光子注入到世界当中这种方法。并且给我们提供了可以在更低分辨率的屏幕空间里面去采集这些间接光照的思路，还给我们提供了出现了 Error时，处理这些错误像素的方法。Lumen中很多地方都使用了这种思路。<br>RSM毕竟是个早期算法，有很多的局限性。首先是只能解决 SingleBounce ，而且它也不检测 Visibility ，并且没有考虑间接光照的遮挡。但是毫无疑问RMS 是一个非常具有启发性的一个工作。</p>
<h3 id="四-Light-Propagation-Volumes（LPV）"><a href="#四-Light-Propagation-Volumes（LPV）" class="headerlink" title="四.Light Propagation Volumes（LPV）"></a>四.Light Propagation Volumes（LPV）</h3><p>既然光子已经注进去了，那我们就要让光在这个世界里面流动起来。这里就要介绍一个也非常具有启发性的算法 Light Propagation Volumes（LPV）。</p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-3a45de30fe5b528c7dd591d7a45bbbaf_1440w.jpg">  </p>
<p>LPV最早是 Cry Engine 3 提出的一种实时、无需任何预计算的全局光照技术。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-6b8f5ec9bcfe14cd75f5bc3747153219_1440w.jpg">  </p>
<p>在RSM中，我们找到并定义了一系列的虚拟点光源，LPV的第一步仍是如此。它在找到虚拟点光源后，把整个场景分成的一个个小格子叫做Voxel（体素）。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-ec55d7afd24eb15370088a98570ebe3f_1440w.jpg">  </p>
<p>我们需要把在RSM得到的虚拟点光源“注入”到它对应的Voxel中。<br>由于在Voxel里可能有多个虚拟光源存在，因此存储时可以使用多个Cubemap来暴力存储，但是这会造成巨大的存储开销，通常来讲我们可以用二阶的球谐函数（Spherical Harmonics）SH来拟合这里的光照结果，因为球谐函数SH能够将光照是加权累积在一起。最后我就得到了在小格子里面Radiance 在空间上的分布场。<br>对于任何一个物体，在Shading 的时候，就可以拿到世界空间中每个Voxel内部光照的 SH 进行光照计算。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-349ed5eade9b8a4709ab46083ee0c0a7_1440w.jpg">  </p>
<p>当我们有了Voxel 之后，还需要对场景进行扩散。对于一个Voxel，在传播时可以传播上下左右前后共六个格子。它从每个Voxel发出对应方向的射线，例如穿过了Voxel的右面就传播到右边的相邻格子。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-62c85cfc61bb57b784a3146a54189c59_1440w.jpg">  </p>
<p>这种扩散叫Propagation，LPV的主要问题是当Radiance 扩散出去之后，你这个Voxel内部还有没有 Radiance ，如果内部还有Radiance ，那么能量是不守恒的；如果 Radiance 不在，那个地方就是黑的，那么周围为什么还能被照亮呢？<br>我们会发现这个光的扩散的速度扩散的范围跟你做了多少次 Iteration 有关，这种感觉就像是说光是有限速度在各个这个 Radiance 里面去传递的。因此LPV 的方法不太符合物理学原理。<br>为什么要提起这个算法呢，我觉得最核心的就是他是第一个把空间进行 Voxel 的划分，在每个Voxel 里面去保存Radiance 的分布情况，并且更有意义的是他提出了把Radiance 的分布用SH存储的方案。</p>
<h3 id="五-Sparse-Voxel-Octree-for-Real-time-Global-Illumination-SVOGI"><a href="#五-Sparse-Voxel-Octree-for-Real-time-Global-Illumination-SVOGI" class="headerlink" title="五. Sparse Voxel Octree for Real-time Global Illumination (SVOGI)"></a>五. Sparse Voxel Octree for Real-time Global Illumination (SVOGI)</h3><p>接下来我们要介绍 SVOGI ，SVOGI是对之前LPV的空间的升级，之前的LPV虽然对空间进行Voxel 划分，但每个Voxel如果你分得太粗，就不能够准确地表达这个世界里面的光的分布，如果分的太细，那我就将拥有极其多的Voxel。并且物体里面的空间是是中空的，没有Voxel存在的必要，因为Voxel只需要存物体里面的光照信息。</p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-03d3f531aa0b1353a548698342237e0a_1440w.jpg">  </p>
<p>因此SVOGI提出一个叫做保守光栅化的方法。一般来讲，决定一个三角形是否占有一个像素的标准是三角形是否覆盖了像素的中心，保守光栅化则是只要覆盖到像素的任何区域我都会进行Voxel。比如很小很薄的三角形只占有像素的很小部分，依旧会进行Voxel。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-870d10e835fd04e26c9add136882cbf9_1440w.jpg">  </p>
<p>如上图所示，我们把表面的 Voxel 全部收集起来。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-7420aa06da6b118a543ee2925deb8499_1440w.jpg">  </p>
<p>如果我们要表达的空间非常大，自然而然我们可以使用树来存储。大家知道空间上我的每一个维度上都进行二分，三维空间上八次分，因此我们使用八叉树。如果这个区间里没有对应物体，这颗树就会分得特别粗，如果有物体则会继续细分。<br>实际原文的实现非常复杂的。对于每一个节点，它不仅存自己的数据，还要存了周围的数据。因为它要做 Filtering 的时候需要这些数据来做差值，因此所需要的数据结构惊人的复杂。<br>我们很努力的想找到它的源代码，但很遗憾由于我们的信息渠道不够充沛，并没有找到源代码。所以有一些他们没有讲到但我们很关注的一些细节无法得知。<br>但他首先意识到Voxel的空间分布是不均匀的，基本上只要用到空间结构表达，使用这种Octree Tree空间划分的思想就是一个很自然而然的想法。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-9d07ec44a958d703fbb9ec15b37cb4bc_1440w.jpg">  </p>
<p>SVOGI 另一个很启发性的思路是，通常采样时你需要采样几百根Ray才能达到你想要的效果。他的想法是我想要重点采样的地方，并不是使用Ray而是Cone，Cone的英文是圆锥，当圆锥体展开的时候，对应的面积就会越来越大，那它在远处就会扫到更大颗粒的Voxel。由于Voxel 对空间的表达是一个树状结构，越靠近树的根部，它Voxel表达的空间区域就越大。所以你远处的颗粒更大的Voxel存储的值，实际上是一个很大面积的Radiance 的集合。<br>SVOGI提出的这个思想非常的好，因为你只要对空间进行结构性的Voxel 表达，你就会有这样的优势。</p>
<h3 id="六-Voxelization-Based-Global-Illumination-VXGI"><a href="#六-Voxelization-Based-Global-Illumination-VXGI" class="headerlink" title="六.Voxelization Based Global Illumination (VXGI)"></a>六.Voxelization Based Global Illumination (VXGI)</h3><p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-eb3e78e8ec8dd3a258643eda0057687b_1440w.jpg">  </p>
<p>SVOGI的很多细节我们查不到，但是这并不重要，因为实际上没有人再用这个算法。原因很简单，八叉树的数据结构在 GPU 上表达非常的复杂。这在VXGI发明后，一切都被变成了浮云。<br>VXGI的思路是，我们其实并不需要整个场景的表达，对于 GI 来讲，我们最重要的工作是把我眼睛看到的地方的GI做好，并且离我比较近的区域的GI更为重要，远处区域的 GI虽然也重要，但是我不需要对它进行很高精度的采样。<br>这个时候我们使用传统的Clip Map 的思想，离我相机近的地方，我用更密的 Voxel 去表达；离我远一点精度就下降一倍，以此类推。<br>这样就不用极其费劲的去构建一个稀疏的八叉树结构，我依旧还是构建了一个树状结构，并且这个树状结构基于View的密度分布，对 GPU 更加友好，并且实现起来更加的清晰明确。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-1dce103470df9d2d9c08061e786865b8_1440w.jpg">  </p>
<p>由于场景中你的相机总是在动，那么对应的ClipMap 也要跟随着进行更新。VXGI提出一种可循环的寻址系统。当你的相机移动变化时，我们只需要进行增量更新，也就是在 GPU 中，你每次只需要更新它边上那圈数据，而不需要把中间那些没有必要更新的数据重新生成和赋值。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-087217c168a74c65ecec04d40483fff7_1440w.jpg">  </p>
<p>这样我们对整个空间就有一个近处密、远处稀疏的Voxel 表达。如上图所示，远处的 Voxel 也没有显得特别稀疏，这是因为随让远处的Voxel很大，但是因为透视投影的原因，在屏幕空间中感觉并没有没有特别明显，但实际上它已经离你很远了。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-e7d13b27b1953df149ed3530e30d4736_1440w.jpg">  </p>
<p>VXGI 还需要考虑透明度的问题。每个Voxel 并不是只有透光和不透光两个状态。实际每个 Voxel 有一个 Opacity 。假设Voxel里面有一个Mesh，这个Mesh把55%的光挡住，而45%的光透过，并且各个方向的透光率不一样，因此我们要沿着它各个方向算出它的不透明度。<br>我们在采样时，不像大家想的那样 hit 到了一个 Voxel 我就停在那里，而是有一个有半透明效果。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-4b4ae18f095ab738d091b7851d5ec864_1440w.jpg">  </p>
<p>如上图所示，对于一个场景而言里面的Voxel 会有很多半透（灰色）的区域。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-0156147601e0da676d55e595276177e8_1440w.jpg">  </p>
<p>对于VXGI，我们同样使用RSM，注入到我们每一个表面的Voxel 上去。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-5b7855d56d190322561e706dae10715d_1440w.jpg">  </p>
<p>大家可以看到只有一些 Voxel被照亮 ，因为只有这些Voxel 接受到了直接光照。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-e62b23dfe2c26b4e623d0cf1c46875e0_1440w.jpg">  </p>
<p>接下来，我们对于每个屏幕上的像素，进行Cone Tracing 。对于非常粗糙的表面，我就以Cosine Lobe四面八方的采样；如果表面是比较光滑我就沿着大致的反射方向采样；如果非常光滑的表面，我不仅只沿着反射方向去取那个间接光照，Cone还会变得非常的细。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-5adbcf916ece189806e5d62b562a6a17_1440w.jpg">  </p>
<p>根据之前所讲，如果沿着这个方向的 Opacity不是完全遮蔽，那么光能透露过来。这时候我再继续往后走，越往上走，我的采样面积就越大。我就取 Clip map 里面更高的 Mip 的那个Voxel，这样我一次性就能覆盖很大的区域。<br>我光线的透过的Alpha会随着我不断的透射而变低，当Alpha小于某个阈值，很接近于零的时候，我们就说，就当做不透明算了，我们就不往后再走了，这样能让我们的算法更快一点。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-90e0fa760bd0f1e5cc3b062b62b51d78_1440w.jpg">  </p>
<p>VXGI 实际上是我个人认为非常好的一个算法。虚幻引擎中有一代里面有一个插件就可以实现 VXGI。我对所有能够实装的算法都是比较敬畏的。<br>因为你真的敢把一个算法放出来，让大家在各种场景里测试的话，说明它本身的效率性能和它的鲁棒性已经达到了一定的程度。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-c86b0ea1dcb39e3d60b16315f4e62d98_1440w.jpg">  </p>
<p>VXGI 其实也有很多的问题了，比如实际的Cone Tracing中opacity 累积是一个估计值。<br>如上图中右上所示，绿色三角形在Voxel 里面阻挡了一部分光照，黄色的方块也阻挡了部分光。它两个Alpha如果按照乘法累积肯定不为零。但是在实际上光路上其实已经完全阻挡了光照。<br>实际的渲染中的表现就是 Light Leaking漏光，特别是对于那种一些很薄的物体，或者本身不是很薄但是距离比较远的物体尤其严重。</p>
<h3 id="七-Screen-Space-Global-Illumination-SSGI"><a href="#七-Screen-Space-Global-Illumination-SSGI" class="headerlink" title="七.Screen Space Global Illumination (SSGI)"></a>七.Screen Space Global Illumination (SSGI)</h3><p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-2ffc95e5e90e826843a4de3df22e72ea_1440w.jpg">  </p>
<p>SSGI的工作最早是2015年寒霜在SIGGRAPH 上发表的工作。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-d632776adee51ffcc55144306775dd8c_1440w.jpg">  </p>
<p>SSGI的原始思想很简单，如上图所示，红色框的是我直接渲染出来的东西。下面白色的部分，如果我要我去渲染它的间接光，因为他的表面非常的 Mirror ，所以我只要在屏幕空间里面把红色部分反一下，这些数据我就可以用了。因此SSGI的思路是，我在屏幕空间中把这些渲染好的像素点作为我全局光照的小光源。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-a78d97a2f565314d21d54e256bd88000_1440w.jpg">  </p>
<p>如上图，假设整个屏幕中的像素已经渲染好了，当我要Shading图中黄色的点时，我已经知道了Normal和相机方向，我就可以沿着反射方向射一些Ray。这些Ray就在我的屏幕空间里面去找空间上位置正确的点，如果这个点是红色我就获得了一些红色的Radiance ，如果这个点是绿色我就收到了一些绿色的 Radiance ，这样的话我就可以直接用屏幕空间的数据进行 Indirect Lighting 。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-2fb6abfc9d64c370d688180b0c63ac60_1440w.jpg">  </p>
<p>我们在屏幕空间中找到对应采样点的方法叫做Raymarching。假设我们从一个点出发射出一根Ray，这根Ray使用均匀间隔一直往前走，如果它当前位置的深度值比我这跟Ray的深度更靠前，就说明这跟Ray被挡住了，这个时候我就认为找到了一个交点。这就是均匀的 Remarching ，它要求步进间距非常的密，速度也就会很慢。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-523cef4cfa6c44fc411bee9600c60950_1440w.jpg">  </p>
<p>当然我们需要另一种方法加速Remarching 。GPU 硬件提供了生成一个特殊Buffer的方法，当然我们也可以自己实现，叫做HZB，也叫做Hi-Z。它可以把 Z buffer 做成一层层的 Mip，每个上层 Mip里面的一个像素，都对应它下层Mip里面四个点的像素。上层 Mip像素点的值，是下层Mip四个像素点中深度的最小值，也就是离我最近的那个值。<br>如果我们拥有了Hi-Z，一根Ray如果跟 Hi-Z的某个Mip不相交，那我跟你下层的Mip一定不相交。如果我跟你某个Mip相交，那我一定跟你下层某个Mip的像素相交。所以它实际上把这个Depth Buffer 做成了一个 Hierarchy 的结构。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-1b9af47b9db798250eac108e0318aa75_1440w.jpg">  </p>
<p>当我有了Hi-Z，想做Raymarching的时候 就比较简单了。比如初始状态下，我在Mip0层，我先在Mip0层往外走一格。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-8fd0dab568753048dc3355d35a5a4ab0_1440w.jpg">  </p>
<p>如果发现在Mip0层没有交点，我需要接着走，不过这时我往上跑一层跑到Mip 1走一格，这就相当于走了两格。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-a179f4fe6612dc13731b7499bfef5baa_1440w.jpg">  </p>
<p>这个时候如果我发现还没有交点，我就开始胆子更大了，我在再往上走一层在Mip2走一格，我再做一次深度测试的话，这一次我相当于做到了四格。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-1ea178bd286fa9cab3715f39bdd359f1_1440w.jpg">  </p>
<p>这个时候假设我不小心发现我检测到了物体。如今我是在 Mip2级别，我就知道他可能交到了Mip1 或者Mip0 的某个点，但是具体是哪个点我不知道。这时候，我回退到 Mip 1往前走一格。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-794d34ee620087601d9dfa32c1fe6fea_1440w.jpg">  </p>
<p>我发现好像跟 Mip 1也有个交点。那我再回退到 Mip 0 继续走。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-ed3553179141194ba684c56b64e6ad42_1440w.jpg">  </p>
<p>这时我们就能找到交点。虽然听上去Hi-Z比均匀采样更为复杂，但是它的算法复杂度是 log 2 的，也就是说你就算是 1024 或者更高的分辨率，我也最多只需要十几步就走到了。如果你用 Uniform 的 Raymarching 可能要走五六十步才能走到。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-a6c8e208a8e95cb8fb221cb04faaab6c_1440w.jpg">  </p>
<p>SSGI 还有一个很有意思的思想就是复用采样。当我对一个像素求出了采样点，我周围的点在也要进行球面采样的时候，如果不考虑 visibility ，他采样到的那个小灯泡实际上也是你的小灯泡，相当于帮你也做了一次采样。这个思想其实也是非常重要的。因为在我们真正做 GI 的时候，你不可能对每一个采样点的位置射那么多的Ray，不然整个计算就会爆炸。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-6acce8143b246dc9e601be1e7707f83a_1440w.jpg">  </p>
<p>和之前一样，我们提供采样的Scene Color 也会做Mipmap，对于远处的Cone Tracing 会采样到分辨率更低的贴图，这相当于对整个光照进行了一次 Filtering。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-f39fd462d41062f0c975d6e246c1d279_1440w.jpg">  </p>
<p>当然SSGI也会有一些问题，如果在屏幕空间没有的东西，我就看不到。比如像上面例子中框出的部分因为反射的数据拿不到，所以下面的整个都变白了。但是这不影响SSGI作为一个非常有用的算法。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-300d3f2e9f85618990dfe08e23c91629_1440w.jpg">  </p>
<p>SSGI 拥有很多优点：  </p>
<ol>
<li>因为Hi-Z的精度非常高，所以两个物体的交接面，非常细腻的几个 pixel 的内容误差，它都能把你算出来，因此SSGI能够处理非常近的Contact Shadow。而以前 Voxel的方法对它的处理很糟糕。</li>
<li>对于Hit的计算，因为用了Hi-Z 的方法非常准确，这比Voxel去估计要准得多。</li>
<li>无论场景有多复杂，SSGI对场景的 complexity 是无感的</li>
<li>SSGI能够处理动态的物体。</li>
</ol>
<p>这几个优势非常重要，这就是为什么在这么复杂的 Lumen 架构里面，还使用到了SSGI 。</p>
<h2 id="Lumen"><a href="#Lumen" class="headerlink" title="Lumen"></a>Lumen</h2><p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-bde4d4867e8e841196e4b8e42bac90fb_1440w.jpg">  </p>
<p>首先我们需要知道Lumen需要解决哪些问题。</p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-9005037078939cc8691b3402cb62853c_1440w.jpg">  </p>
<p>很多人都会问，既然已经有了硬件的Raytracing ，我们为什么还要Lumen呢。这是由于很多硬件并不支持 Realtime Raytracing，对于支持的那些硬件， N 卡还算是勉强可以，而 A 卡支持的比较糟糕。并且实际测试中，3080大概 1 秒钟能做10 个billion 的计算，这个实际的计算量用来做GI 的话，实际还是比较费力的。<br>比如游戏里最常见的Indoor场景，你需要每像素500 根Ray才能得到想要的效果，但是我们只能付得起每像素二分之一个Ray。因此我们需要解决如何在软件层面解决掉快速Ray Tracing 的问题。</p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-9ba3cfe8699e14830de482f7aca5960e_1440w.jpg"><br>另一个大的问题就是Sampling。之前的章节我们也讲到了Sampling，过去几十年时间离线GI都在和 Important Sampling 做殊死搏斗，直到现在也没有让我们特别满意。而我们的Realtime 的 Sampling 数量又被卡的很死，这进一步增加了我们处理问题的难度。<br>如上图所示，靠近窗口的Sampling 结果基本是可以接受的，虽然它有些Noisy，但是你可以通过 Filtering 解决这个问题。但是如果离窗子稍微远一点，那 Filtering 也救不了你，最终你看到的就是一个一个的大色斑。因此Lumen也需要解决如何Sampling的问题。</p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-edfe9c7f91b3be0a3ee3af52e15fc905_1440w.jpg"><br>我们知道Indirect Lighting 可以在 Low Resolution 上面采样得出，Lumen的想法是在屏幕空间放一大堆的 Probes，屏幕空间 的特点是紧贴那些要被渲染的物体表面，通过 Probe获取光照。比如每16 个 pixel 我放置一个Probe，每个像素去 Shading 的时候，它的高频信息可以通过表面法线产生，最后得到右边非常逼真的效果。<br>因此Lumen最核心的思想是三点：</p>
<ol>
<li>在不用硬件Ray Trace的前提下，我如何进行快速的Ray Trace。</li>
<li>尽可能的在 sample 里做的优化。</li>
<li>放置的Probe 尽可能贴着真实物体表面，使它的精度足够的高。</li>
</ol>
<h3 id="Phase-1-Fast-Ray-Trace-in-Any-Hardware"><a href="#Phase-1-Fast-Ray-Trace-in-Any-Hardware" class="headerlink" title="Phase 1 : Fast Ray Trace in Any Hardware"></a>Phase 1 : Fast Ray Trace in Any Hardware</h3><p>Lumen最核心的点就是要解决我怎么样的在任意硬件上能进行非常快速的 Raytracing ，它要解决如何我在射出一根Ray时，快速得到这个Ray到底能不能交到一个物体，并且知道和它相交的物体是谁。<br>这个 Raytracing 当然是可以用硬件Raytracing 去做，Lumen也提供能够开启硬件Raytracing 的功能来做更高精度Raytracing的表现，不过为了兼顾各种硬件，Lumen 最主要的是提供了基于软件的SDF(Signed Distance Field )的Tracing算法。</p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-755c260433e3262ac2fa15d670f136aa_1440w.jpg"><br>SDF叫做空间距离场，假设空间中有一个Mesh，我们会生成一个空间场的数据信息，对于空间上的任何一个点P，你都可以查询到P距离Mesh 上最近的距离是多少。如果P点在Mesh外部，那它的数值是正的；当P点在物体表面，那它的数值是0；如果P点在Mesh内部，那它就是负值。<br>在过去我们对一个形状的表达是使用 Triangle （点线面），它非常符合我们人的直觉。但是它是离散的，顶点数据之间并没有任何联系，它必须要通过 index buffer 关联起来。三角形和三角形之间的连接也不存在，因为它必须要通过顶点，查询到共用两个相同 index 的顶点，我才知道三角形两个边是连接起来的。<br>SDF从数学上是 Triangle的等价变换。他是连续和均匀的，是可微的，既然是可微的，就能做很多事情。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-2234e14203e8aaafc07ec15c502f4d38_1440w.jpg">  </p>
<p>我们现在已经知道了SDF的定义，接下来我们来看如何生成SDF。最直接方案是，我对每个Mesh都生成自己的SDF。对于一个游戏场景来说，如果有上万个物体，实际的场景物体可能就是几百种物体通过平移旋转放缩得到。我只需要存这几百个物体的 SDF加上它的Transform ，我就可以把场景表达出来。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-95ddd7b29d90ca6c232a1cf26fc8a864_1440w.jpg">  </p>
<p>在生成SDF的时候，需要考虑Mesh特别细小于我距离场密度的情况。如上图左侧所示，如果我们采样到的是5和5中间红色点的位置，因为插值的关系，我们采样到的还是5。因此我们在这里把Mesh撑开一点。因为生成的时候会做这样的操作，因此我在做Trace 的时候也会进行一个偏移的修正。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-fc1e1dea8ad30d59104832d401c29838_1440w.jpg">  </p>
<p>接下来我们要解决如何使用SDF 进行Ray Tracing 找到交点。我们这里使用Raymarching的方法，不过我们这里是在世界空间中去做，而不是之前在屏幕空间。Raymarching的主要问题就是步长如何选择。<br>如右图所示，从出发点P0出发，你的第一个Distance 距离就是P0点SDF的值，因为SDF是你距离最近的Mesh的距离，小于这个值的范围内根本不会有任何物体。这时你就会从 P0 点跳到 P1 点，从 P1 点再去找它的SDF，可以找到 P2 点，这样以此类推，我们就可以非常快的hit 到物体的表面。<br>实际上这是比较安全的，就算你穿进物体内部了，因为 SDF 它是有符号的，进去之后它会给你一个负数，那个负数就告诉你说你的表面应该在哪，你还可以弹回来。所以使用SDF 的Raymarching既快又鲁棒，这是 SDF非常大的好处。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-8752ffc5f0ff185072cb9dea16ad1835_1440w.jpg"><br>SDF第二个好处是做Cone Tracing 。比如说我们要做 Soft shadow ，从需要计算阴影强度的着色点o出发，向光源发射一条Shadow Ray，沿着该方向进行marching ，每marching 到一个点，我们可以得到一个圆心为当前点，半径为当前点的SDF值的球，从出发点向该圆作一条切线，可以得到一个夹角，取所有这些夹角中的最小值，根据这个值来确定半影大小。</p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-aa50c663a76444688376d0ec610eaf15_1440w.jpg"><br>由于SDF的显存占用过高，我们其实可以对SDF 进行稀疏化处理，使用间接存储的结构。如上图所示，我们可以把那些 Voxel的 distance 大于某个阈值（体外）和小于某个值（体内）的Voxel全部干掉，用一个简单的 index 就可以把SDF的存储减少很多。</p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-123a5cfaa9d65fb049bd8e2f548315dc_1440w.jpg">  </p>
<p>但是我个人一直在怀疑一件事情，确实只要大于一个阈值，你把那些 Voxel 全部标为空，你这样只要存那些有用的区域，但它会导致你marching 迭代的步长变长。因为以前一次性可以跳一大步，但现在如果是空的话，我只能一步一步的试，但是这个里面工程上肯定有办法可以解决，我们就不展开了。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-b3d20440e9d13d4469472a997a768858_1440w.jpg"><br>SDF 还可以做LOD，而LOD 还有一个很有意思的属性，因为它是空间上连续的可导的，你可以用它反向求梯度，实际就是它的法线。也就是说我们用了一个 Uniform 的表达，可以表达出一个无限精度的一个 Mesh ，我既能得到它的面积，又能对它进行快速的求交运算，还能够迅速的求出它连续的这个法线方向。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-2f8118dd5690e6ece4b80c3fdf5cee9e_1440w.jpg">  </p>
<p>如果你使用 LOD 和Sparse Mesh，可以节省40%到 60% 的空间，这在硬件上还是蛮可观的。对于远处的物体，可以先用这个 Low level 的SDF，当你切换到近处的时候再去使用密度高的SDF，这样也可以很好的控制内存消耗。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-68a05ce5075af56aff9d048e28a03b7a_1440w.jpg"><br>如果你用Per-Mesh SDF去做Raytracing，对于单个 mesh 来讲，你做 Raytracing速度会很快。但是你架不住场景的物体数量特别的多，比如说我一根Ray打过去的话，沿途所有的 Object 我都得问一遍。如果场景全是物体，那你的计算复杂度就会越来越高。如上图所示，越亮代表Step的次数越多，会发现越靠近 Mesh 的边界上的像素，它需要的Step 就越多。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-15871f8d89086fefcc4f8414489d38f6_1440w.jpg">  </p>
<p>一个非常简单的想法就是，既然你们都是分散的，那我把你这些SDF 合成一个大的低精度的 Global SDF ，这是对整个场景的表达。当然这里面的细节比较复杂，物体的移动，消失，增加，都需要提供一套 Update 的算法。今天就不展开了，如果有兴趣的同学可以自己研究。<br>不管怎么说，我们能形成一整个场景的 SDF 。如果有了整个场景的SDF，Raytracing 的速度就会非常快，因为它不再依赖于一个一个的物体。当然它的缺点是受制于存储空间，不能像 Per-Mesh SDF 那么精细，但它是一个非常好的加速的方法。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-fb2c39c9744d4efc6224a8205e9c5842_1440w.jpg"><br>在 Lumen 里面，Global SDF 和Per-Mesh SDF 都使用到了。如果一开始你就使用Per-Mesh SDF，你可能要二百多次的物体测试，一旦有了Global SDF，物体的测试数量就会极大的下降，因为它可以快速的找到一些近处的点，然后再根据周边的Per-Mesh SDF去做。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-2c5eef462b1bed013647b1a647752608_1440w.jpg">  </p>
<p>Global SDF 在实际上的运算中它会做成四层 mip， 在 Camera 近处 SDF 精度高一点。远处我 SDF 精度低一点。因为SDF跟 Texture 一样是一个非常 Uniform 的表达，所以它天然的支持 Clip Map。<br>SDF虽然并不能直接用作渲染，但它可以把很多渲染的计算进行迅速的优化。使用 SDF我们可以快速的提供场景的表达，在这个表达到上面做 Raytracing的效率非常高，并且不依赖于硬件的Raytracing。</p>
<h3 id="Phase-2-Radiance-Injection-and-Caching"><a href="#Phase-2-Radiance-Injection-and-Caching" class="headerlink" title="Phase 2 : Radiance Injection and Caching"></a>Phase 2 : Radiance Injection and Caching</h3><p>那接下来我们要解决如何把光子注入到世界。</p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-cb0a15438332556eca003fa2f2118aa2_1440w.jpg"><br>在Lumen里面，他搞了一套非常特殊的东西叫做 Mesh Card 。当我们计算全局光照的时候，从光的视角我们去照亮整个世界，其实整个世界里面无论你看得见的还是看不见的 pixel 它实际上都会被这个光给照亮。每一个被照亮的 pixel ，实际上也成为GI 的一个贡献者，就是我的小光源之一。<br>我们的Mesh SDF Trace虽然可以拿到对应的相交点，但是对应物体的材质信息是拿不到的，我们还需要知道物体表面的材质属性，但SDF 并不包含 Material 的Attribute。并且仅使用RSM也是不够的，因为它只有灯光看到的那些表面的信息，其余的很多的角度依旧看不见。<br>Lumen想到了一个方案，首先就是每个Mesh导入的时候，如上图所示，会生成Mesh Card，这样在使用Per-Mesh SDF的时候，就可以找到对应的MeshCard。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-fcae33c325165e2c991ad4a397761ae4_1440w.jpg">  </p>
<p>这是我们在 UE 5 里面搭的一个场景，你可以看到生成的 Card ，其主要作用是提供光照采样的位置和方向。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-556ce794d62f9cfc75d811a659adf3bb_1440w.jpg">  </p>
<p>Cards只是Lumen捕获光线的位置，其可以离线生成，而存储其中的数据则必须实时捕获，因为不同的Mesh之间会有交叉和遮挡，因此就算是同样的材质渲染出的Cache结果也是不一样的。<br>所以我们没有办法在离线的时候把这个信息Cache住，而是在运行时给每个Card渲染出它的表面Cache，里面包含有Albedo，Opacity，Depth等各种信息。如果你带有自发光的话，也会把你的 Emissive也存储进去。<br>可以看到这里的Surface Cache的数据与 Deferred Shading 的 G-Buffer 很像，我们在计算光照的时候直接就可以通过这里的Cache数据来计算。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-2c254fc41c199ff1df35626a61be9d92_1440w.jpg">  </p>
<p>当离我的相机比较近的物体，Surface Cache的分辨率会高一点，相机远离的物体Surface Cache分辨率低一点。比如说我侧面有一个石头，这个石头可能只有两米高，但是它可能占据了我平面 1&#x2F;3 的地方。那我平面近处的东西很可能会受这个石头的影响。远处可能有个雕像，它有 5 米高，但它距离我 100 米远，它的精度就可以低一点。<br>我们是以Atlas的方式去排布所有的Surface Cache在对应的4096x4096 的空间里。这里需要注意的是 Surface Cache并是一个单张的 Texture ，而是一系列的 Texture的集合。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-27ceeb2c02e7ca70807ebb0c6453a985_1440w.jpg">  </p>
<p>Surface Cache内部的贴图都会进行一遍硬件支持压缩，这样可以减少显存的占用。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-6de571004d9773926754fcec7880862d_1440w.jpg">  </p>
<p>Surface Cache存储着Gbuffer 的信息，不过这还不够，因为我们不能再在相交点重新发射大量的光线然后不停的递归去计算间接光，我们希望把Radiance 固化在Surface Cache上面就如同Photon Mapping 的思路一样。<br>因此我们希望它Surface Cache上还能存储对应的Radiance信息，那就是Radiance Cache，有了 Radiance Cache，就可以在 Trace 时直接进行采样作为 Trace 方向对应的 Radiance。当然这里面会有两个重要的问题。  </p>
<ol>
<li>第一个就是 Surface Cache的某个点，这个光的照耀下它到底有多亮，它有可能会被 Shadow 挡住，那么我们怎么去知道这件事情呢。</li>
<li>第二件事情是，我既然知道你的GBuffer信息，直接光照我可以得到，但如果你是 Multi Bouncing 我怎么办？</li>
</ol>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-2dee7c020fd02deb6aa64f4a75df70ee_1440w.jpg">  </p>
<p>如上图，最核心是要生成Surface Cache Final Lighting。   </p>
<ol>
<li>第一步，对于 Surface Cache 上的每个像素，我们可以很简单的计算 Direct Lighting 。对于刚才第一个问题，如果在Shadow里面，我们可以通过Shadowmap来做。</li>
<li>第二步，其实比较复杂，为了能够计算Indirect Lighting，我需要在 WorldSpace里面其实建了一批对光的 VoxelLighting的表达，这一步的 VoxelLighting并不是给当前帧用的，而是给下一帧使用。为什么要做这一步，并且VoxelLighting的具体细节将会在接下来的章节中讲述。</li>
<li>第三步，我们使用上一帧的第二步建立的Voxel Lighting，采样出对应的 Indirect Lighting ，把它和Direct Lighting 这两个合到一起，就变成了我的这一帧的这个 Final Lighting。</li>
</ol>
<p>随着时间的积累，第一帧F0的时候只有一次 Bouncing ， 第二帧F1 的时候，其实我就有这个两次 Bouncing 的值了。在F2时就具有三次Bouncing 的值。<br>Surface Cache Direct Lighting  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-d519aef7d8a2910fb20f94d2462153e4_1440w.jpg">  </p>
<p>第一步是计算Surface Cache上的直接光照，这是比较简单的，Surface Cache每一个 pixel我去找对应的Lighting，只要采样Shadow map 我就知道是否在阴影里。并且我也不用真的渲染Shadow map，实际上我只要用我的 SDF 查询一下灯光的可见性，就知道我这个点和灯光可不可见。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-3f3e5d59fc88357d447c77d36e2261cf_1440w.jpg">  </p>
<p>如果你有多光源，我就对于每一个Page的每个光源都算一遍，最后累加在一起。<br>World Space Voxel lighting  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-3874c3a0f662b7706cd9f32f0d7483f9_1440w.jpg">  </p>
<p>当我们解决了Surface Cache直接光照后，我们需要处理间接光照，间接光照如果在很近的地方，是可以使用Per-Mesh SDF来找到对应的Surface Cache进行更新，但是如果采样点很远，我们对于远处的物体并不会使用Per-Mesh SDF ，而是会使用 Global SDF Tracing，因此我们没有办法同 Per-Mesh SDF 一样从 Surface Cache 上获取 Material Attribute。<br>因此我们对于远处的物体需要构建一个针对 Global SDF tracing的结构。我们把整个场景以相机为中心，做了一个 Voxel的表达。所有需要 Globa SDF Ray tracing 的功能都需要采样 Voxel Lighting。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-106b87bdbbbf48d7888d5f6e144b0bdf_1440w.jpg">  </p>
<p>与传统的 Voxel Lighting 不同，Lumen 并不是体素化全部场景，而是体素化相机周围一定范围内的空间做一个Clip Map ， Clip Map 里面有 4 层，每层 64x64x64 个Voxel，把它存储到一个 3D 的 texture 里面。这样，我们将 Lighting 注入到 Voxel 中，这样就以更粗的粒度记录了空间中的光照信息。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-928253d006884815b9423bfa7fd2155c_1440w.jpg">  </p>
<p>在之前我们讲VXGI 里面，它一般都是用保守光栅化的方法去构建Voxel。但是在 Lumen 里面，他的方法就更为巧妙，Lumen 将 Clipmap 又进行了网格化，将 4x4x4 的 Voxels 合并为一个 Tile，Clipmap 有 64x64x64 个 Voxels，因此每个 Clipmap 可划分为 16x16x16 个 Tiles。从每个Voxel的边上，随机的射一根Ray进去，如果我能打中任意一个 Mesh在我的这个Voxel里面，就说明这个 Voxel 不为空的。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-902aed9c376274c70fd4357d53c4020f_1440w.jpg">  </p>
<p>每个Tile 顶多五六个物体，这样我们只需要跟大概四五个物体进行求交，运算效率会非常高的。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-2dee7c020fd02deb6aa64f4a75df70ee_1440w.jpg">  </p>
<p>当我们有了整个空间的Voxel表达，我们现在要知道Voxel 的lighting。需要注意的是，每帧我们会重新的体素化更新所有的Voxel 的lighting。<br>实际Voxel 的数据是根据从 6 个方向分别采样与 Voxel 相交的 SDF，根据它采样的 Mesh Card 信息再从 Surface Cache 中的 Final Lighting 中采样 Irradiance。<br>第一帧F0的时候，Voxel是全黑的，这个时候没有Indirect Lighting，只有 Direct Lighting ，因此我们 Surface Cache 的 Final Lighting 实际上就是直接光照的结果，这时我们把Final Lighting 的结果注入到对应的Voxel Lighting中。<br>下一帧里，我就有了Voxel 的信息，虽然Voxel只有直接光的信息，不过没关系，我就用第一帧Voxel 的信息再去更新我的Final Lighting 。然后我再把Final Lighting的信息写到Voxel 里面。经过多帧的跌断，我取到的信息天然的就具有 Multi Bouncing 的结果，这个方法非常的巧妙。<br>有些比较复杂的东西，比如说 terrain 肯定不能用 Mesh Card 去表达；再比如中间有半透明的雾怎么去做处理。 Lumen 里面有无数的细节，我们作为 10 系列的课程也就不展开了。<br>Surface Cache Indirect Lighting  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-7322b09131e228397a608896756faad6_1440w.jpg">  </p>
<p>当我们有了整套对世界的表达，我们将要去做Indirect Lighting 的计算。Lumen将屏幕空间的 Surface Cache 划分为8x8像素的 Tile，在 Tile 上放置 Probe，每 Tile 可放置 2x2 个 Probe。每个 Probe 在半球方向上进行16次的 Cone Tracing，但我会存入8x8Trace 的结果，这个结果是需要16次的 Cone Tracing差值得到。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-890545f8d18c8b7318f648484e2e3bbc_1440w.jpg">  </p>
<p>我们将会得到的的数据存成了SH， 因为我要根据采样点把16个点进行差值为64个点，所以使用SH来进行。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-f48e1f6a47bbc76a7ba7ecc41dbc486b_1440w.jpg">  </p>
<p>如图所示，直接光照其实是 HDR 所以你看上去它会偏亮，实际上的话它之间亮度差得很大。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-84d98ca8b613dba71fb947eb5882209c_1440w.jpg">  </p>
<p>这样，两个Lighting 就可以结合在一起，形成我们想要的这样的一个 Multiple lighting。<br>使用 Surface Cache还把一个很难的问题给解决掉了，就是自发光。大家在做游戏的时候，自发光其实很难处理。如果你只考虑它本身变量的话，那很简单，在最终的颜色上硬生生的加上去一个光。但是如果我们想自发光能够影响GI的话，这其实非常难。<br>虽然在前面我们讲了很多方法能解决 Multi Light source 问题，但是我这是一条光带，我怎么去渲染呢？如果使用Surface Cache，即使是一个光带，我实际上也能够把它整体Cache 到 Lighting 里面去。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-3d356f86d22e785240b2d8fef7855a4f_1440w.jpg"><br>对于整个 Surface Cache的更新还是非常耗时的。因此Lumen里规定，每帧最多不超过 1024 x 1024 个texels更新，对于间接光照因为它要在很多Voxels 上采样，因此最多更新512 x512 个texels。对于每一个 Mesh Card来讲，他都要排队请求自身更新。这里面其实有一整套的比较复杂的排队算法。</p>
<h3 id="Phase-3-Build-a-lot-of-Probes-with-Different-Kinds"><a href="#Phase-3-Build-a-lot-of-Probes-with-Different-Kinds" class="headerlink" title="Phase 3 : Build a lot of Probes with Different Kinds"></a>Phase 3 : Build a lot of Probes with Different Kinds</h3><p>前面讲的内容依旧无法直接给我们渲染提供直接帮助，这一节我们将来看如何能够拿到对应像素点的间接光数据。<br>Screen Space Probe  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-175355663a229094a80035380fc2808d_1440w.jpg">  </p>
<p>对于最终的渲染来讲，我们需要拿到当前像素点法线半球面的所有Radiance，也就是对应 Radiance的一个 Probe 的表达。所以我们首先需要去分布这些Probe，最自然的一个想法是在空间上均匀分布，因为我既然已经有 Surface Cache 我又得到了一个 Voxel，我这样简单去构建整个 Probe 分布是可以的，比如说每隔一米放一个 Probe 。<br>但它并不能保证你能准确地表达光场的变化，如果这个变化如果你表达不了的话，实际上你渲染出来的东西看上去就很怪。就如我们经常用一句行话：这看上去很平。所有的预计算生成 Probe 的 方案都会产生类似的问题。<br>而Lumen就比较大胆，他说我就在 Screen Space 去洒 Probe 。如果我够狠一点的话，我屏幕上的每个像素点，我都对它进行整个Probe的 采样，这当然在结果上没什么问题。<br>但是Lumen还没有那么粗暴，它每隔 16x16 个 pixel ，去采样一个 Screen Space 的这个Probe 。因为实际上，近处位置16x16 个pixel 的范围在空间上相距不会太远，而间接光照非常低频，在这么近的距离里面，它的变化不会很大。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-7b6c78238802913ef894b28abbb993ab_1440w.jpg">  </p>
<p>对于屏幕空间 Probe ，我们使用八面体映射（Octchedron mapping） 来进行球面坐标到2D纹理空间坐标的转换。虽然在球面上撒采样点最简单的方法就是按照经纬度采样，但是经纬度采样如果映射到一个 2d 的 texture 会出一个问题：极点附近的采样密度特别高，赤道附近的采样密度过低。而我们希望一个分布相对均匀的采样，并且这个采样需要满足，我给你任何一个方向，能迅速的知道它的 UV 空间的位置。因此我们选择使用Octchedron mapping来进行映射。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-37eb4755da204f602a12075e7ac0066e_1440w.jpg">  </p>
<p>虽然Lumen每隔 16 个 Screen Pixel 放置一个Probe，但是我们放置完之后，还需要检查当前像素平面和对应Probe彼此之间是否在一个平面上。我们可以根据深度和Normal很容易得到平面信息。<br>如上图黄色部分就是那些对应Probe无法满足需求的像素。这时说明当前16 x16 的精度对他们来说不够，对于这些像素，我们会自适应地细化为8x8 像素的Probe，如果还不够的话，我们会继续细化为4x4。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-cd5ce31e402fba48c4e977d12b2b0f6e_1440w.jpg">  </p>
<p>每个pixel 渲染时，都要从临近的4个 Probe 之间去取它的插值，这时我需要通过法线和位置计算出自己的空间平面，把四个 Probe 的中心点投影到我的平面上，通过获得的投影距离来确认对应的光照权重。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-877590e369dd14f7c28e79f5c863b1a8_1440w.jpg">  </p>
<p>我们根据投影权重会计算出一个 Error值，如果Error值累计大于某一个 threshold 我就认为这个Probe不能用了。如果我这些采样点很多都不能用的话，我认为就是你这四个采样点对我是无效的。这时，我就会进行自适应使用更细化的Probe来进行我的间接光插值计算。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-70cba73063757da8492787d06c6fd566_1440w.jpg">  </p>
<p>Screen Space 的所有 Probe都放在一个 Atlas里面。由于我们的贴图都是正方形，但是我们的屏幕是长方形，因此天然就会一些贴图空间的冗余。 它会把你这些需要自适应的 Probe packing 在它的下面。因此它没用用到额外的存储空间就做到了Adaptive 的采样。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-945611ea97bde7c59ee51d514a265694_1440w.jpg">  </p>
<p>如上图，我们是把Lumen的Screen Space Probe 打印了出来，暗红色的点是 16x16 ，黄色 8x8 或者 4x4 的。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-efa2332be5f8ead4709765860a353b4b_1440w.jpg">  </p>
<p>我们在进行屏幕空间 Probe采样的时候，用了 jitter 来防止过于重复。 多次jitter的结果在时序上又变成了一次Multi Bouncing 的采样。<br>Importance Sampling<br>我们如今已经知道如何去分布我们的 Probe ，接下来我们就要去采样。之前讲过，我们如何使用Uniform 的采样会导致一些问题，在一个房间里，如果不知道窗户在哪里，采样如果不是使劲的朝着窗户方向去采的话，结果就会像秃头般一样的，黑一块白一块非常丑。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-bded3e9ead582a02e7b4bcf382d35c13_1440w.jpg">  </p>
<p>如果不进行important Sampling 我们看到了 lighting 的结果大概如上图所示。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-ac1659af95920a6b369f42640201f62b_1440w.jpg">  </p>
<p>因此我们最重要的一件事情是找窗户，我要尽可能往窗户的那个方向多射一些Ray，也就是说你需要环境感知。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-68b0dd9091d136593cfa200211d32f92_1440w.jpg"><br>如之前的章节所说，我要尽可能让我的这个概率函数P符合上面函数的分布。上面这个函数是两个函数的积，其中一个是光，另一个是我表面的BRDF。所以首先你需要知道光在哪儿，第二个你需要知道法线在哪，因为背面的光对我来说毫无意义。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-9ba17c68ef987eb4af2e56455ad586f3_1440w.jpg">  </p>
<p>如何得到光的方向呢，虽然并不知道这一帧的光在哪，但是我做一个假设，就是光的变化没有那么快。因此我们可以把上一帧的 Probe 采一遍，重投影上一帧周围四个的Probe的值，把对应SH的信息画在一个 8x8 的图里，这个图中亮的地方就是光比较亮的地方。这样我就大概知道哪个地方亮，哪个地方暗。当然如果上一帧这里不可见的时候，会出现有失败的情况。我们会Fallback到世界空间的Radiance Cache里面  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-846e0a444c9d102808473f551edd74fb_1440w.jpg">  </p>
<p>第二点对于BRDF的部分，大家天然的能够想到，沿着 Normal 做一个 Cosine Lobe 。这听上去非常合理。但是这里面有一个很大的错误，那就是像素的Normal 非常非常高频。比如一个小区域中可能有一千多个pixel ，那一千多个 pixel 加权的法线朝向并不能由我这单独采样点的法线所代表。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-69b87eb735d577b0131b1fc86969b1ff_1440w.jpg"><br>如果真的把 1024 个 Pixel 的 Normal 全部加在一起也太夸张了，因此我们使用64 个采样点去估计，并且不使用随机采样，它会根据Depth的权重，确保这些采样点和当前像素点的Depth彼此相差不要太大。然后我把这些 Normal 的Consin lobe 全部积分在一起。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-6c35cccb6cf287f6734e188646eef8a5_1440w.jpg">  </p>
<p>Lumen 采用了一种称为结构化重要性采样（Structured Importance Sampling）的机制，其核心思想是把不重要的采样分给重要的采样部分。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-c34a91eaa916c46ad1019bcd660109e8_1440w.jpg">  </p>
<p>当我们知道了Lighting和BRDF的贡献值，我们可以对所有采样点进行排序，排列出哪些点是重要的，哪些点是不重要的。这个时候我们设置一个阈值，找出排名靠后的三个最不重要的方向，假设他们的这个 PDF 值都小于我设定的阈值的时候，我们就不去采样这三个方向，把这三个采样留给我最需要采样的方向，我就可以对我最需要采样的方向进行一次 Super Sampling。<br>依此类推，通过这个 PDF 的值，把最不重要的方向全部过滤掉，然后让我的采样尽量集中在重要的方向，这个方向可能来自于你的法线方向也可能来自于光源。这样，就有了固定开销的Adaptive Sampling。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-dec3d2b350c36cf305163e803518a34d_1440w.jpg">  </p>
<p>如图所示，右边使用Structured Importance Sampling，它的光线会集中在墙上相对比较亮的地方，整个 Rendering 的结果就会好很多。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-ba542dda8526b89c693052dfb303ee04_1440w.jpg"><br>如图所示，左边是没有做important Sampling，右面是做了这个important Sampling。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-6aca35a7ad7b06a1a2fd25c7c1dd8153_1440w.jpg"><br>这张图同样如此。<br>Denoising and Spatial Probe Filtering<br>接下来我们需要进行降噪，做 GI 的话Filtering 就是你逃不掉的东西。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-ab3d3dd99af073ec3b76ffc59e4c521a_1440w.jpg">  </p>
<p>按照16x16 Pixel的 Probe 得到的信息是非常不稳定的。因此我们使用周围3x3的 Probe 来做Filtering。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-1b30146bb1a266122a19c0905407867b_1440w.jpg"><br>每一个Probe都射出去了 64 根Ray，如果我把临近Probe同方向的Ray的光照结果，直接加到一起其实是不对的。<br>因为Neighbor Probe 和Current Probe存在一定距离，Neighbor Probe相同方向射到的物体在Current Probe 看过去的射线角度可能完全不一样。如上图所示，有两个Probe，他们相同方向上有两根Ray，一个蓝色一个灰色，蓝色射中的物体在Current Probe视角下并不是一个方向。<br>所以当我们去加权这些 Ray 的时候，对于所有的 Neighbor Probe 的Ray 都要做一次可用性检测。如果这个夹角超过了10 度，我就不用了。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-56ad9ee770e8f208baff98a7d72c3634_1440w.jpg">  </p>
<p>如图所示，如果这个东西不处理，这个墙上会有很多的 noise 。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-e1500c561856495c5f4bc915db08f8ff_1440w.jpg">  </p>
<p>仅仅处理角度还不够，假设我Neighbor Probe的Ray交点非常的远，但Current Probe射到的距离很近的，虽然角度是对的，但不好意思，我认为这种情况也是无效的，我还是只用我自己的数据。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-d64ff273679d46eef4e20889c8ffdde2_1440w.jpg"><br>这个问题不解决的话，它就会出现这种漏光的问题。如上图左边，你发现那个毛巾的这个内侧面，和它靠近墙的地方。如果你不考虑这个差值，很多光就会漏进来。<br>World Space Probes and Ray Connecting<br>Screen Space Probe如果它跑的太远，效率会很低。因此Lumen希望Screen Space Probe 你只处理周边的东西。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-64181fe31d4524e91b8183f74af4cfb4_1440w.jpg"><br>对于远处的物体，我们会在 World Space 里面预先放好一些 Probe ，我们把远处的lighting 都Cache在里面，这样当 Screen Space Probe 取一个方向的Ray的时候，就可以在沿途的 World Space Probe 里面的光线给你取出来。<br>如果你的场景是一个相对静态的场景，光源也基本固定，但你的相机仍会走来走去，因此你 Screen Space Probe 一直是不稳定的，每一帧都要去更新。而World Space Probe 使用 Clip Map 的方法去部署，我在运动的时候只需要在边缘处增加几个 Probe 后面删掉几个Probe 就可以了。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-1505a4c7fe6591d6614378030c4c3dd6_1440w.jpg">  </p>
<p>如上图，我们可以看到World Space Probe的分布。Screen Space 在整个球面上的采样是 8x8 ，而World Space Probe作为最后的救赎者，采样数是32 乘32，差不多 1000 多根Ray。有了World Space Probe，很多时候Screen Space Probe 就不用跑得很远，它只要跑到附近的 World Space Probe里面就去借他的光就可以了。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-789ae61a73f171b480ea13a5145e55b5_1440w.jpg">  </p>
<p>那么我们如何我把光怎么接起来呢。 Screen Space Probe的Ray只会在近处采样，当我走到临近的World Space Probe 的时候，我就罢工了，远处剩下的内容我只需要去World Scape Probe取就可以了。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-68783c6392730bd00b6e1d27a6401a1f_1440w.jpg"><br>World Space Probe的覆盖范围形成一个 Bounding，Screen Space Probe 做 Raytracing的时候，只会走Bounding对角线长度的两倍.<br>距离相机较近的地方的Screen Space Probe周围的World Space Probe密度会高一点，如果你到了远处，World Space Probe的范围其实已经比较大了，所以那个时候Screen Space Probe Ray 跑的距离就会比较远。<br>而World Space Probe的Ray在采样的时候也会 Skip 掉自己的对角线长的距离，因为它没有必要采样近处的内容，近处的只需要交给 Screen Space Probe就可以了。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-b73bdaa22017b773314f948dc64aa650_1440w.jpg">  </p>
<p>这里面讲一个很有意思的 Artifact ， Screen Space Probe 射出一根Ray，World Space Probe如果沿着 Screen Space Probe 那个同样的方向去找，就会产生一个很有意思的问题。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-780a9f49aa5a9e9cb8fb20c8aed244a4_1440w.jpg">  </p>
<p>World Space Probe很可能会跳过靠近我的一个阻挡物，这个时候就会出现漏光的问题。因此我们需要让光线弯曲一下。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-d85be5ddaeef003366481f756e5f2222_1440w.jpg">  </p>
<p>做渲染的时候我们其实不是那么特别 Care 物理的完全正确，需要光线拐弯的时候，它光线就给我拐弯。我们求Screen Space Probe发出的射线到World Space Probe范围边缘的交点，我用交点和Screen Space Probe中心构造一个新的方向，然后我用这个方向当做World Space Probe采样的方向，虽然光转弯了，但它确实能解决一部分的漏光的问题。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-65c55d4dfdcc03ba75f0942a51d8b371_1440w.jpg">  </p>
<p>最终渲染时，我们还是只使用 Screen Space Probe去渲染， World Space Probe只是帮助我们去快速的获取远处的光线。 因此如果World Space Probe 对应的空间内没有物体，也不在我的 Screen Space 里面，这些地方的 Probe 是不需要采样的。<br>也就是说，只有那些对 Screen Space Probe 有差值需求的World Space Probe才会去更新。我们会把Screen Space Probe周围八个 World Space Probe标记为 marked 。那只有这些 marked 的 World Space Probe 才有必要进行采样。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-0b7c9f08358d5894119bdc4162a1d749_1440w.jpg"><br>如上图，如果你只是用Screen Space Probe 的话，它如果只有两米，你看到的结果大概是这个样子的。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-25be1ea51aafcfab78d338540570ef85_1440w.jpg">  </p>
<p>但是如果你有World Space Probe，你可以看到这个光看上去就准确的多了。</p>
<h3 id="Phase-4-Shading-Full-Pixels-with-Screen-Space-Probes"><a href="#Phase-4-Shading-Full-Pixels-with-Screen-Space-Probes" class="headerlink" title="Phase 4 : Shading Full Pixels with Screen Space Probes"></a>Phase 4 : Shading Full Pixels with Screen Space Probes</h3><p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-c894f1dd1f27de9566363098e83e1a06_1440w.jpg"><br>虽然我们做了 Important Sampling ，但实际上 Indirect Lighting还是很不稳定，因此我们把这些光全部投影到 SH 上面去。 SH 本质上相当于对我们的整个 Indirect Lighting进行了一个低通滤波，把它变成了一个低频信号，用它来做 Shading 的时候看上去就柔和了非常多。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-f2792cd2c146396aaf76db3ba00a527c_1440w.jpg"><br>这就是我们最终能够得到的结果。</p>
<h2 id="Overall-Performance-and-Result"><a href="#Overall-Performance-and-Result" class="headerlink" title="Overall, Performance and Result"></a>Overall, Performance and Result</h2><p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-ec5e2d55b37def8e89e26b4596ad85a9_1440w.jpg"><br>对于不同的 Raytracing方案，硬件上的成本是不一样的。最快的tracing就是基于 Global SDF 。其次就是在屏幕空间我进行 linear Screen 去插值。那么比它稍微慢一点的就是 Per-Mesh SDF 。 HZB 它稍微比 linear Screen 要慢，但是它的准确度其实会更高。硬件Raytracing的准确度肯定是最高的，但是它开销会更高。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-f16f79447188bb429d19df1162618189_1440w.jpg"><br>我们通过这张图可以看到Lumen使用了混合的Tracing方法。红色区我们使用 Screen Space 的Tracing；绿色的区域用 Per-Mesh SDF ；蓝图的部分也就是说更远的地方，我只能用 Global SDF 。<br>如果每一个 Pixel Tracing使用的方法是单一的，我们应该看到的是纯色图，但现在我们看到的图是渐变图。这其实也说明我们每个Probe采样中，混合使用了各种方法 。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-72df6b80403a22e64ec92d6067871a4f_1440w.jpg"><br>我们希望越靠前的方法，准确性越高。  </p>
<ol>
<li>我们首先是使用Screen Space Trace 。它基于HZB走50 步，如果能 Trace 到，我就把这个结果拿过来。</li>
<li>如果 Screen Space Trace失败，我们就会使用最主要的Per-Mesh SDF的方案。 Per-Mesh SDF Trace 的距离非常近，只有 1.8 米。这个时候我可以返回Mesh ID，可以直接拿到Surface Cache。</li>
<li>再远一点，我们只用 Global SDF， 而Global SDF只能拿到Voxel Lighting 。</li>
<li>如果 Global SDF 也失败了，你就采到CubeMap上去。</li>
</ol>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-29adfe3318946fbac68c9d5dcd0d75c8_1440w.jpg"><br><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-e86c28900e9fb40e9c77d4e2ffabedf7_1440w.jpg"><br>这里我们需要重点提一下SSGI，如果没有SSGI只有Lumen的话，可以看到下面那个倒影其实很粗糙。因此对于近处高频的物体，SSGI 还是蛮重要的。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-d1bbd317cbd2c68b0355995006965c8d_1440w.jpg"><br><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-e9b5f73ea4e4b053185bd8df948e9d23_1440w.jpg"><br>Lumen最了不起的地方，还是在工程上真的完成了交付。在 PS5 的这个硬件平台上，能做到 3.74 毫秒。如果你愿意降低采样分辨率，你的效率可以更高，可以从将近3.74 毫秒下降到 2.15 毫秒。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-a23badece2d64d6311f5656c5d1b72e9_1440w.jpg"><br><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-b3aecd74b0d6c460aed9e3cee70fddca_1440w.jpg"><br>所以16x16 的 pixel 的选择，我相信作者自己肯定也做了大量的尝试，得出的一个兼顾性能和效果的参数。  </p>
<p><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-ceda26cfc2cbaf20b129412fcff41242_1440w.jpg"><br><img src="/2026/01/17/%E8%BD%AC%E8%BD%BD/(20230713)%E6%9C%80%E5%BC%BA%E5%88%86%E6%9E%90_%E4%B8%80%E6%96%87%E7%90%86%E8%A7%A3Lumen%E5%8F%8A%E5%85%A8%E5%B1%80%E5%85%89%E7%85%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6_GAMES104%E5%AE%98%E6%96%B9%E8%B4%A6%E5%8F%B7/v2-eeaecfe71b721a8ebcb820eba32cb326_1440w.jpg"><br>Lumen对整个动画电影行业，都有着非常巨大的影响，将室内设计师，效果图公司所梦寐以求的离线渲染的效果，做到了可以实时产生，非常的了不起。。<br>Lumen也奠定了未来 10 年下一代的游戏引擎的渲染标杆，我们认为 GI是下一代顶级游戏引擎的标配，你只要做下一代游戏引擎，你的 GI 必须是实时的。<br>Lumen 只是这一系列伟大征程的开始，你可以看到Lumen 基于现有的硬件， 还是做了大量的妥协。未来十年随着硬件的发展， 实时GI 将会变得更加成熟，也会变得更加简洁。而Lumen 是一方向的开山鼻祖，他的创作者必然会载入史册。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2024/01/11/%E8%BD%AC%E8%BD%BD/%E8%B6%85%E8%BF%871000%E6%9C%AC%E7%9A%84%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%8F%E5%85%B8%E4%B9%A6%E7%B1%8D%E5%88%86%E4%BA%AB/">【转载】1000本的计算机经典书籍分享</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2024-01-12</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%BD%AC%E8%BD%BD/">转载</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/">计算机</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E4%B9%A6%E7%B1%8D/">书籍</a></span><div class="content"><h1 align="center">超过1000本的计算机经典书籍分享</h1>
<p align="center">
    <a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/forthespada/mediaImage2@4.0/202103/%E9%98%BF%E7%A7%80%E4%B8%AA%E4%BA%BA%E5%BE%AE%E4%BF%A1%E6%97%A0%E6%B1%89%E5%AD%972.png"><img src="https://img.shields.io/badge/WeChat-微信群-blue.svg" alt="微信群"></a>
<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/gRw25aRFBVB0lUhBAJqV5g"><img src="https://img.shields.io/badge/公众号-拓跋阿秀-green.svg" alt="公众号"></a>
  <a target="_blank" rel="noopener" href="https://www.zhihu.com/people/tuo-ba-a-xiu"><img src="https://img.shields.io/badge/知乎-拓跋阿秀-informational.svg" alt="知乎"></a>
   <a target="_blank" rel="noopener" href="https://blog.csdn.net/songhao19?spm=1000.2115.3001.5343&type=blog"><img src="https://img.shields.io/badge/CSDN-拓跋阿秀-important.svg" alt="CSDN"></a>
       <a target="_blank" rel="noopener" href="https://blog.nowcoder.net/hello32"><img src="https://img.shields.io/badge/牛客网-拱白菜的阿秀-9cf" alt="牛客网"></a>
    <a target="_blank" rel="noopener" href="https://github.com/forthespada/InterviewGuide"><img src="https://img.shields.io/badge/GitHub-计算机校招社招面试题汇总-critical.svg" alt="八股文">      <a target="_blank" rel="noopener" href="https://interviewguide.cn/#/"><img src="https://img.shields.io/badge/推荐阅读-大佬好文-import.svg" alt="学习"></a>
           <a target="_blank" rel="noopener" href="https://github.com/forthespada/CS-Books"><img src="https://img.shields.io/badge/PDF-免费计算机书籍-lightgrey.svg" alt="免费PDF"></a>
        </p>

<p>希望阿秀开发的网站能够对你有所帮助！祝你求职顺利！<strong>网站链接</strong>：<a target="_blank" rel="noopener" href="https://top.interviewguide.cn/">https://top.interviewguide.cn/</a></p>
<h4 id="1、👉-如果国内访问Github网速较慢，我在码云也放了一份书籍资源，国内访问速度更快，点此直达"><a href="#1、👉-如果国内访问Github网速较慢，我在码云也放了一份书籍资源，国内访问速度更快，点此直达" class="headerlink" title="1、👉 如果国内访问Github网速较慢，我在码云也放了一份书籍资源，国内访问速度更快，点此直达 "></a>1、👉 如果国内访问Github网速较慢，我在码云也放了一份书籍资源，国内访问速度更快，<a href="https://gitee.com/ForthEspada/CS-Books" target="_blank">点此直达 </a></h4><p>本仓库<strong>持续更新</strong>中，后续会陆续分享更多经典电子书，<strong>强烈建议大家 Star 下本仓库</strong>，下次找书可以直接 <strong>Ctrl + F</strong>，找书再也不愁 ！ </p>
<blockquote>
<p>简单附赠两个云服务器优惠信息： </p>
<p>【阿里云】云服务器狂欢特惠，<strong>2核2G5M</strong> 轻量级应用服务器 <strong>60</strong> 元&#x2F;年【阿秀目前使用】   <a href="http://1v9.xyz/1NfKlv" target="_blank">传送门</a> </p>
<p>【腾讯云】轻量应用服务器限时秒杀，<strong>1核2G6M</strong> 限时首年<strong>74</strong>元&#x2F;年【阿秀强烈推荐】 <a href="https://curl.qcloud.com/R21rJgZ7" target="_blank">传送门</a></p>
</blockquote>
<h4 id="2、🔥🔥🔥计算机校招求职学习网站"><a href="#2、🔥🔥🔥计算机校招求职学习网站" class="headerlink" title="2、🔥🔥🔥计算机校招求职学习网站"></a>2、🔥🔥🔥计算机校招求职学习网站</h4><p>我把<strong>自己秋招时的上岸字节跳动的学习笔记</strong>做成一个网站了，适用于<strong>计算机校招应届生以及毕业三年之内的社招求职党</strong>，<a href="https://interviewguide.cn/#/" target="_blank">传送门</a></p>
<div align="center">
  <a target="_blank" rel="noopener" href="https://interviewguide.cn/notes/01-guide/web-guide-reading.html">
  <img src="http://oss.interviewguide.cn/img/202205161146636.png" target="_blank">
  </a>
</div>


<h4 id="3、😄学习计算机八九年收集到的一些不错的资料免费分享，包括清华北大计算机课程资源等，点此一键白嫖"><a href="#3、😄学习计算机八九年收集到的一些不错的资料免费分享，包括清华北大计算机课程资源等，点此一键白嫖" class="headerlink" title="3、😄学习计算机八九年收集到的一些不错的资料免费分享，包括清华北大计算机课程资源等，点此一键白嫖"></a>3、😄学习计算机八九年收集到的一些不错的资料免费分享，包括清华北大计算机课程资源等，<a target="_blank" rel="noopener" href="https://interviewguide.cn/notes/07-resources/01-free/01-introduce.html">点此一键白嫖</a></h4><h4 id="4、❤️走心内推！字节跳动核心岗位在职员工校招社招内推方式，传送门"><a href="#4、❤️走心内推！字节跳动核心岗位在职员工校招社招内推方式，传送门" class="headerlink" title="4、❤️走心内推！字节跳动核心岗位在职员工校招社招内推方式，传送门"></a>4、❤️走心内推！字节跳动核心岗位在职员工校招社招内推方式，<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=Mzg2MDU0ODM3MA==&mid=2247507684&idx=1&sn=72aa278890931b4551391f5f008fad60&chksm=ce262299f951ab8fa668ab148c94296fe8e2baf712bd65c2495897d03ceb8e70e1ce6a8b9648&token=867943050&lang=zh_CN#rd">传送门</a></h4><h4 id="5、👍🏻两位字节跳动后端研发工程师学习笔记，点此一键免费获取"><a href="#5、👍🏻两位字节跳动后端研发工程师学习笔记，点此一键免费获取" class="headerlink" title="5、👍🏻两位字节跳动后端研发工程师学习笔记，点此一键免费获取"></a>5、👍🏻两位字节跳动后端研发工程师学习笔记，<a href="./Doc/other.md" target="_blank">点此一键免费获取</a></h4><h4 id="6、⭐计算机经典图书榜单Top50-互联网一二线中厂校招面试PDF合集，点此一键免费获取"><a href="#6、⭐计算机经典图书榜单Top50-互联网一二线中厂校招面试PDF合集，点此一键免费获取" class="headerlink" title="6、⭐计算机经典图书榜单Top50&amp;互联网一二线中厂校招面试PDF合集，点此一键免费获取"></a>6、⭐计算机经典图书榜单Top50&amp;互联网一二线中厂校招面试PDF合集，<a href="./Doc/当当Top50.md" target="_blank">点此一键免费获取</a></h4><h4 id="7、😜发现一个相当不错的计算机各类种语言-学科学习路线仓库，-点此查看"><a href="#7、😜发现一个相当不错的计算机各类种语言-学科学习路线仓库，-点此查看" class="headerlink" title="7、😜发现一个相当不错的计算机各类种语言&amp;学科学习路线仓库， 点此查看"></a>7、😜发现一个相当不错的计算机各类种语言&amp;学科学习路线仓库， <a href="https://github.com/awesome-cs-community/developer-roadmap-zh-CN" target="_blank">点此查看</a></h4><h4 id="8、赞赏"><a href="#8、赞赏" class="headerlink" title="8、赞赏"></a>8、赞赏</h4><div align=left>
    <p>这些书籍基本都是我从一个盗版电子书网站上收集到的，网址是：kanshuy1234.com，现在分享出来希望能对大家有所帮助，自己也花了很久时间整理出来的。<br>
      如果觉得本仓库有用，赏赐一块钱，买杯奶茶喝可好？感谢您了~</p>
<figure class="half" align="center">
    <img src="https://cdn.jsdelivr.net/gh/forthespada/mediaImage1@1.2.5.4/202012/支付宝赞赏4.png" style="right;zoom: 40%;" />
                                                                                                                        <img src="https://cdn.jsdelivr.net/gh/forthespada/mediaImage1@1.2.5.4/202012/微信赞赏4.png"  style="right;zoom: 40%;" />
                                                                                                                         </figure></div>

<p>[TOC]</p>
<blockquote>
<p>点击下列目录直接跳转书籍所在类别，但有时目录跳转会失灵…如果没有没有正常跳转可以动动小手向下拉即可，全部的书籍都在本页面。 </p>
<p>笔者是一个人在维护这个仓库，本地大概是1100多本书了，需要一步步慢慢上传，我只能在闲暇时间慢慢更新，目前已经更新超过500+了，如果没有您要用的书，可以加一下**个人微信(<a target="_blank" rel="noopener" href="http://oss.interviewguide.cn/img/202204281304520.png">coderxiu2</a>)**，注明来意，我会慢慢添加上去的。一个人的力量是有限的，请谅解一下。</p>
</blockquote>
<ul>
<li><a href="#00c%E8%AF%AD%E8%A8%80">00、C语言</a></li>
<li><a href="#01c">01、C++</a></li>
<li><a href="#02java">02、Java</a><ul>
<li><a href="#21java%E5%9F%BA%E7%A1%80%E5%88%B0%E8%BF%9B%E9%98%B6">2.1、Java基础到进阶</a></li>
<li><a href="#22java-%E5%A4%A7%E6%95%B0%E6%8D%AE">2.2、Java 大数据</a></li>
<li><a href="#23java%E5%B7%A5%E5%85%B7">2.3、Java工具</a></li>
</ul>
</li>
<li><a href="#03python">03、Python</a>  <ul>
<li><a href="#31python%E4%B9%A6%E7%B1%8D">3.1 Python书籍</a></li>
<li><a href="#32python%E7%88%AC%E8%99%AB">3.2 Python爬虫</a></li>
<li><a href="#33python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90">3.3 Python数据分析</a></li>
<li><a href="#34python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96">3.4 Python数据可视化</a></li>
<li><a href="#35python%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98">3.5 Python数据挖掘</a></li>
</ul>
</li>
<li><a href="#04go%E8%AF%AD%E8%A8%80">04、Go语言</a></li>
<li><a href="#05%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95">05、数据结构与算法</a></li>
<li><a href="#06%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F">06、操作系统</a></li>
<li><a href="#07linux">07、Linux</a></li>
<li><a href="#08%E5%90%8E%E7%AB%AF%E6%9E%B6%E6%9E%84">08、后端架构</a></li>
<li><a href="#09%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E7%9F%A5%E8%AF%86">09、计算机系统知识</a></li>
<li><a href="#10%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C">10、计算机网络</a></li>
<li><a href="#11%E6%95%B0%E6%8D%AE%E5%BA%93">11、数据库</a></li>
<li><a href="#12%E5%89%8D%E7%AB%AF%E5%85%A8%E6%A0%88">12、前端&amp;全栈</a></li>
<li><a href="#13%E5%AE%89%E5%8D%93ios%E9%80%86%E5%90%91">13、安卓IOS逆向</a></li>
<li><a href="#14%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD">14、机器学习&amp;深度学习&amp;人工智能</a><ul>
<li><a href="#141%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0">14.1 机器学习</a></li>
<li><a href="#142%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0">14.2 深度学习</a></li>
<li><a href="#143opencv">14.3 OpenCv</a></li>
<li><a href="#144%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89cv">14.4 计算机视觉(CV)</a></li>
<li><a href="#145%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86nlp">14.5 自然语言处理(NLP)</a></li>
</ul>
</li>
<li><a href="#15%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F">15、设计模式</a></li>
<li><a href="#16%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80">16、汇编语言</a></li>
<li><a href="#17git">17、Git</a></li>
<li><a href="#18%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3">18、数学相关</a></li>
<li><a href="#19%E7%A8%8B%E5%BA%8F%E5%91%98%E8%BD%AF%E6%8A%80%E8%83%BD">19、程序员个人能力提升</a></li>
<li><a href="#20%E5%85%B6%E4%BD%99%E8%B5%84%E6%96%99">20、其余资料</a></li>
<li><a href="#21%E7%A4%BE%E6%8B%9B%E6%A0%A1%E6%8B%9B%E6%B1%87%E6%80%BB">21、社招校招各种面经汇总</a></li>
<li><a href="#22%E6%88%91%E5%BB%BA%E8%AE%AE%E4%BD%A0%E4%B8%8B%E8%BD%BD%E4%BB%A5%E5%90%8E%E8%82%AF%E5%AE%9A%E7%94%A8%E5%BE%97%E4%B8%8A">22、我建议你下载，以后肯定用得上</a></li>
<li><a href="#Donate">友情打赏</a></li>
</ul>
<h4 id="00、C语言"><a href="#00、C语言" class="headerlink" title="00、C语言"></a><span id="00、C语言">00、C语言</span></h4><ul>
<li><p>《C程序设计语言（第二版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1haNxg0Ett2MvCDc05N0O0g">百度云链接</a>  提取码：2and </p>
</li>
<li><p>《C Primer Plus 中英版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1O8lJSj7P78NyffnKNG1pbw">百度云链接</a> 提取码：2dox </p>
</li>
<li><p>《征服C指针》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1rZYNFyDcuTsiQak4dUsmVQ">百度云链接</a>   提取码：c7gx </p>
</li>
<li><p>《C陷阱与缺陷》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1YiT2O6srFgtcYnK47gz8gA">百度云链接</a> 提取码：rq3g </p>
</li>
<li><p>《C和指针中文版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1QANwu3qu1dq2JRaVmYxm7Q">百度云链接</a> 提取码：1gt3 </p>
</li>
<li><p>《经典C程序100例》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1AVcXE4i_iUJ3bh-QeRJzLA">百度云链接</a>  提取码：juxk </p>
</li>
<li><p>《C专家编程》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1rjer0Wmv2v3TclcBSJtAtQ">百度云链接</a> 提取码：i4yp </p>
</li>
<li><p>《C语言深度解剖》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/100km3RzJcnwX2Kzr10_rTQ">百度云链接</a>  提取码：zekk </p>
</li>
<li><p>《C语言解析教程》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1n8Dny_r70OYtgIkcKisuxg">百度云链接</a>  提取码：ndi3 </p>
</li>
<li><p>《C语言函数大全》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1pJLgloXUCpyKLIzvPuP0LQ">百度云链接</a> 提取码：peou </p>
</li>
<li><p>《C语言程序设计-现代方法》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1DEbvpUOuIkcKC2DqY8Us_Q">百度云链接</a> 提取码：kn4d </p>
</li>
<li><p>《C语言参考手册第五版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1AabhkPDP-MqLmw4V6GaGWA">百度云链接</a>  提取码：0kjd </p>
</li>
<li><p>《C语言编程精粹》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1vTsLTZ4-Q6r0JyAHnZAvUA">百度云链接</a>  提取码：tior </p>
</li>
<li><p>《C程序设计语言（第2版新版）及其课后答案》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1UZlIkyzwejAVNwVyYHq7qA">百度云链接</a> 提取码：e4zs </p>
</li>
<li><p>《C程序设计语言（第2版英文）及其课后答案》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1CcTYBiykp-RlVx8PwvE4sg">百度云链接</a>  提取码：8s3d </p>
</li>
<li><p>《C程序设计语言(英文第2版)Prentice Hall.-.The C Programming Language(2nd Edition)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1wE_f5jLlKhPJbkHArocV5g">百度云链接</a>  提取码：14x6</p>
</li>
</ul>
<h4 id="01、C"><a href="#01、C" class="headerlink" title="01、C++"></a>01、C++</h4><ul>
<li><p>《阿秀个人在学习C++过程中的笔记，包括黑马C++视频笔记，TCPIP网络编程笔记》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/18XAu8OTsJmX_sfZ1qpmCcw">百度云链接</a>   提取码：fw8s</p>
</li>
<li><p>《<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/PuZpyvFzYr7ZBqe5imS9BQ">6个可以写在简历上的C++项目</a>》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1efly72L--IaBt8prveuwwQ">百度云链接</a>   提取码：sq61 </p>
</li>
<li><p>《<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/IHh4p-Pd6x6UPHXJrlDgQg">推荐一个不错的C++项目，我可能是发现这个项目的第一人</a>》  <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Mw6158y5ZtIfvSgTSqWd1A">百度云链接</a>  提取码：s04w</p>
</li>
<li><p>《侯捷C++视频合集-包括C++面向对象开发&amp;STL标准库与源码解析&amp;C++内存管理机制&amp;C++新标准C++11&amp;14》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1vbK1_zbyPySLR5nn5CLFvw">百度云链接</a>     提取码：h5if </p>
</li>
<li><p>《陈硕-Linux&amp;C++ 网络编程实践》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ydTecrZg5V5wIVlFxshZKw">百度云链接</a>   提取码：ubjp </p>
</li>
<li><p>《C++ Primer Plus》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1TzMuz-lAwZYNptDET84F6g">百度云链接</a> 提取码：zy86 </p>
</li>
<li><p>《C++ Primer(第五版)带书签 高清完整版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ADj-FnyloWB4xeobjVimeA">百度云链接</a> 提取码：ksax </p>
</li>
<li><p>《C++ Primer 习题集》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1S_iGX7aWf_xHROheDr0LBw">百度云链接</a> 提取码：yjqc </p>
</li>
<li><p>《C++ Primer-第4版》<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1acriBigOzoY4sH2Ndwt8Rw">百度云链接</a> 提取码：9vox </p>
</li>
<li><p>《C++ Templates》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1P1aHoTzEQtMaRiOSLp9EAQ">百度云链接</a> 提取码：d5at </p>
</li>
<li><p>《STL源码剖析 + 源码》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/10THUVaHbI1Bxl2jC8yTihQ">百度云链接</a> 提取码：5j2e </p>
</li>
<li><p>《C++编程调试秘笈》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/14KoQ6rdGRI1uSO9xpFWqmg">百度云链接</a> 提取码：9nc3 </p>
</li>
<li><p>《侯捷STL课件》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1SHbg4JsZRQVQdGLrPxIG9A">百度云链接</a> 提取码：3sta </p>
</li>
<li><p>《深度探索C++对象模型》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1vLE-BjhYXRUWrZi9O-YPTQ">百度云链接</a> 提取码：b706 </p>
</li>
<li><p>《深入理解C++11》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1qcnizj9f3fwhaQikx7lMDg">百度云链接</a> 提取码：n7rz </p>
</li>
<li><p>《提高C++性能的编程技术.左飞》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1EhRbebB5VqVFcvv3QYiUhg">百度云链接</a>  提取码：d2wk </p>
</li>
<li><p>《Effective-C++-第二版》<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/17PHddLiLYJ0ZuJc64jxL3A">百度云链接</a>  提取码：4ha8 </p>
</li>
<li><p>《深入理解C++11新特性解析与应用》<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1vFPvSLDxJWivUmZj-ntmwQ">百度云链接</a>  提取码：b9hr </p>
</li>
<li><p>《Effective C++ 第三版 高清PDF》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1DgblW6ia5MY4YUd4w8hG4A">百度云链接</a> 提取码：drvd </p>
</li>
<li><p>《Effective STL中文版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Di-1-MMHTAMe5_1oksJCpA">百度云链接</a> 提取码：ifhx </p>
</li>
<li><p>《C++ 编程规范-101条规则准则与最佳实践》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/15yklDyd61mP9lzfWxTNhCg">百度云链接</a> 提取码：evgk </p>
</li>
<li><p>《C++编程思想（两卷合订本）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1vf0Lx5cNj9cGlvI1XVS8Kg">百度云链接</a> 提取码：8sba   </p>
</li>
<li><p>《C++并发编程实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1xvTgDicB7LqFrwMMJQEPZQ">百度云链接</a> 提取码：a6tw </p>
</li>
<li><p>《C++沉思录中文第二版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1YDYhVnwCW_23qXgMRu-t_Q">百度云链接</a> 提取码：a1lk </p>
</li>
<li><p>《C++程序设计语言》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Jp2FkuoJ0SCpwRTr6HSaEA">百度云链接</a> 提取码：ynhi </p>
</li>
<li><p>《C++ 大学教程》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1viWM-CXCUoXrVtye0Xu63Q">百度云链接</a> 提取码：pczs </p>
</li>
<li><p>《C++对象模型》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1DMhs3yMmqH9jK0iH3FC-Fw">百度云链接</a> 提取码：gaa7 </p>
</li>
<li><p>《C++工程实践经验课》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/10J3j5EHCQa4YSoOEMk9T_A">百度云链接</a> 提取码：bzxi </p>
</li>
<li><p>《C++设计新思维-泛型编程与设计之应用》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ARk_xhfYEtb82f8bysrBog">百度云链接</a> 提取码：5w6t </p>
</li>
<li><p>《Modern C++ Design》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1i2HxMhsrUGL9A4kENjfiMA">百度云链接</a> 提取码：7rcb </p>
</li>
<li><p>《C++实践工程学-陈硕》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1-xFH5CtM5kbUylSgdc_AIw">百度云链接</a> 提取码：3dwb </p>
</li>
<li><p>《跟我一起写makefile》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Rhcd4xnP0e7uqcnmLCKy_w">百度云链接</a> 提取码：ei8h </p>
</li>
<li><p>《C++语言的设计和演化》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1mL5auhf1tale3LLBRfOCxw">百度云链接</a>  提取码：rii6 </p>
</li>
<li><p>《C++标准程序库—自修教程与参考手册》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1r61wjBMyNeDzbM7mTzGy0Q">百度云链接</a>   提取码：x2g8 </p>
</li>
<li><p>《泛型编程与STL中文版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/18VMdxtwWOKZkh3_Dz1qE2w">百度云链接</a>   提取码：rbcd </p>
</li>
<li><p>《More Exceptional C++中文版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1JXQFYVMfgaF6WbmyfMDc2g">百度云链接</a>  提取码：tgcb</p>
</li>
</ul>
<h4 id="02、Java"><a href="#02、Java" class="headerlink" title="02、Java"></a>02、Java</h4><h5 id="2-1、Java基础到进阶"><a href="#2-1、Java基础到进阶" class="headerlink" title="2.1、Java基础到进阶"></a>2.1、Java基础到进阶</h5><ul>
<li>《深入分析JavaWeb技术内幕》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ALUZ-U0oqxxq-_5uGRZZhQ">百度云链接</a> 提取码：g1qz </li>
<li>《深入剖析Tomcat》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1l4amHIQzRdppXLr08BX9Zg">百度云链接</a>  提取码：o06x </li>
<li>《Effective Java 2nd Edition 英文版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1uoU2FicD7xRHRPcKL0lOZw">百度云链接</a>  提取码：czeq </li>
<li>《Effective Java 中文第二版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1u3G6IRSiEQPK-i766kx7Bg">百度云链接</a> 提取码：5p9e </li>
<li>《Java性能优化权威指南》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/18wbGLR2FKYjEtvwSLuO53g">百度云链接</a> 提取码：9g85 </li>
<li>《Java核心技术(卷1）第8版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1dLyU_Ngybat-sjTYUQIVGQ">百度云链接</a>  提取码：pmx2 </li>
<li>《Java核心技术(卷2）第8版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/13C_89pRjE3ccBmXr1GQVyA">百度云链接</a>  提取码：in8y </li>
<li>《Head First Java第二版涵盖java5.0》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1vKNf1gqquCh0x8gcsVgWnA">百度云链接</a> 提取码：qfz2 </li>
<li>《Java 8 实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1kxgntpEDq4kAzygasmJndQ">百度云链接</a> 提取码：3ej1 </li>
<li>《阿里巴巴Java开发手册、1.0.0公开版》   <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/16puKNw6Hl2FOibLxntAnrg">百度云链接</a>    提取码：pl9v </li>
<li>《阿里巴巴Java开发手册、1.1.0正式版》   <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1h89f6LXQVXjPBzo-QCbVeQ">百度云链接</a>   提取码：zrxy </li>
<li>《阿里巴巴Java开发手册、1.2.0升级版》   <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/13kkSmXVlLJoESqVYHxcBQw">百度云链接</a>   提取码: p350</li>
<li>《阿里巴巴Java开发手册、1.3.0终极版》   <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1iwVotVtFSDQgIo83gJARtw">百度云链接</a>   提取码：ycoc </li>
<li>《阿里巴巴Java开发手册、1.4.0详尽版》   <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1CHAlcaUpeHVaYhboCsx2fQ">百度云链接</a>   提取码：dya6 </li>
<li>《阿里巴巴Java开发手册、华山版》   <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1fmMyblrL2pZKxholhZrh3w">百度云链接</a>   提取码：z3fh </li>
<li>《阿里巴巴Java开发手册-嵩山版》   <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1zQNtk7WuHjxu-XpfLCbqGw">百度云链接</a>   提取码：z8mf </li>
<li>《阿里巴巴Java开发手册、泰山版》   <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1G40U8gnqKCTRC5N8jl6YKQ">百度云链接</a>  提取码：6cxz </li>
<li>《Java编程思想（第四版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1exH0byT5YogMOmo7J1dDSQ">百度云链接</a> 提取码：ogz5 </li>
<li>《Java并发编程的艺术》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1te0Uuz5bM1UURQzGBt1OxA">百度云链接</a> 提取码：v8pj </li>
<li>《JAVA并发编程实践》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ROwaQIPzhfkmSA-IjFAWgA">百度云链接</a> 提取码：se4k </li>
<li>《Java从小白到大牛精简版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1MzIRLTt8QwB5JNfuMZIXeA">百度云链接</a> 提取码：zmer </li>
<li>《Java核心技术卷1基础知识原书第10版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1QII6NBlHclyhbct5gESu1Q">百度云链接</a> 提取码：c6d5 </li>
<li>《Java核心技术卷2高级特性原书第10版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1MqJHgJIywE5HsIMhcZ3Nxw">百度云链接</a>  提取码：gjlh </li>
<li>《码出高效：Java开发手册》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1gKnYgHl9hT5R4BDyiPXnMg">百度云链接</a> 提取码：4i0f </li>
<li>《阿里巴巴Java开发手册v1.2.0》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/174XVbFQadas1YNsf5o91gQ">百度云链接</a> 提取码：129f </li>
<li>《深入理解Java虚拟机：JVM高级特性与最佳实践（最新第二版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1QlyCQQVelB20NcdV2DHcoA">百度云链接</a> 提取码：qbfq </li>
<li>《Camel in Action》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1iRDPaCKzTqyBJyntuYqHAg">百度云链接</a> 提取码：kcs0 </li>
<li>《Head First Servlet and JSP(高清中文版)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1YqABaGl4tzZy5U3yzm2N4g">百度云链接</a> 提取码：q55k </li>
<li>《Maven实战（高清完整带书签）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1rZjjNs5OjYoSMtQfqB_y0w">百度云链接</a> 提取码：4q4a </li>
<li>《Spring 5 Recipes, 4th Edition》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1xqPeJinO2Lpq9a4SmG-0bQ">百度云链接</a> 提取码：o3uk </li>
<li>《Spring in action 中文版（第4版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ZUm2XxWLjvZcyUqJfMGwAw">百度云链接</a> 提取码：daya </li>
<li>《轻量级JavaEE企业应用实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ZHicisOFzP9CoP-3tD1QKQ">百度云链接</a>   提取码：1rn2 </li>
<li>《ThinkInJava（JAVA编程思想）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1l-1rTjPakUxUZKWfE6kZeA">百度云链接</a>  提取码：e5rp </li>
<li>《Head First Java 中文高清版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/19oFYnyPcNLTXH-ZrJVFlHw">百度云链接</a>  提取码：yry8 </li>
<li>《Netty in Action第五版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1y2tbY28qTq3NF5cY3ZaiXQ">百度云链接</a>   提取码：ty0o </li>
<li>《Java核心知识点整理》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1XkMVhq7gUBdXWogNENT9LQ">百度云链接</a>  提取码：3s2p </li>
<li>《Java并发编程实践 英语版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/10IcIPmx20GiYewVqx2uq3g">百度云链接</a>  提取码：9mp0 </li>
<li>《Effective Java（中文版第3版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1-ufGk6AAMQ_Y1xWDZmryFw">百度云链接</a>  提取码：ruo1 </li>
<li>《Netty实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1a6Fb7x1CX9ol2pRaAScfcA">百度云链接</a>    提取码：rd2m </li>
<li>《Spring实战（第4版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1dtUTpLrnmz7G18ALF-pn2Q">百度云链接</a>   提取码：7kfk </li>
<li>《java从入门到精通（第4版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1VXIU5ZhhgM9yZbCTc-_53g">百度云链接</a>  提取码：movm </li>
<li>《Spring.in.Action.5th.Edition》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1LLMYTl4O-6VYE-pAXc_DjA">百度云链接</a>   提取码：le2h </li>
<li>《Spring 技术内幕》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1BIvCo6DIeO1L4krcfmc7gg">百度云链接</a>  提取码：gni3 </li>
<li>《Java EE框架整合开发入门到实战：Spring+Spring MVC+MyBatis（微课版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1WDYTZblZYcprboy99jWTcg">百度云链接</a>  提取码：asxu </li>
<li>《大型网站技术架构：核心原理与案例分析》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1rg4wy2MLFJ2QLFJ0ZUk3Tw">百度云链接</a>  提取码：q0ua </li>
<li>《大话java性能优化》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Th4KRYD7Zd4-k80is_p0Ow">百度云链接</a>  提取码：hfeg </li>
<li>《分布式Java应用基础与实践》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/13pE0UvCDRdsBRvryzhyDxQ">百度云链接</a>   提取码：dv70 </li>
<li>《深入理解Java虚拟机：JVM高级特性与最佳实践（第3版）+(华章原创精品)+-+周志明》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1nVSkeYvTW5BRF0VjV4SOOA">百度云链接</a>  提取码：rs4z </li>
<li>《Java核心技术(卷I)基础知识(原书第9版)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1APT2jNg_z_oT-9-Yuunfuw">百度云链接</a>   提取码：4d76 </li>
<li>《深入分析Java Web技术内幕 旧版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1SSs5GwTMFX-Oxo3_mijLyg">百度云链接</a>  提取码：8s2v </li>
<li>《SSM企业级框架实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1BQNBTyb7xvsp5xDl9X0wbg">百度云链接</a>   提取码：h5p2</li>
</ul>
<h5 id="2-2、Java-大数据"><a href="#2-2、Java-大数据" class="headerlink" title="2.2、Java 大数据"></a>2.2、Java 大数据</h5><ul>
<li>《大数据架构师指南》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1NtepEEqg6QlXW0mpgwJY4Q">百度云链接</a>  提取码：vi00 </li>
<li>《大数据之路：阿里巴巴大数据实践》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1L8-ytWwG458IQ0pcN89gkg">百度云链接</a>   提取码：xbco </li>
<li>《深入理解Spark：核心思想与源码分析》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1_wOyrysgbmXdFOrMZikm2Q">百度云链接</a> 提取码：rkov </li>
<li>《图解Spark 、 核心技术与案例实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/14qC88dEgX9zMwqRTvdSecA">百度云链接</a>  提取码：kfaj </li>
<li>《Apache+Kylin权威指南》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Y56PGhUkfKEDwoRRxV2nkQ">百度云链接</a>  提取码：y31o </li>
<li>《Hadoop The Definitive Guide》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1BX0N_y4nerRHdQmcn7zSVg">百度云链接</a>  提取码：ws9o </li>
<li>《Hadoop技术内幕：深入理解MapReduce架构设计与实现原理》<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1wRmSrFslfMYXw4tQ1ICG2w">百度云链接</a>  提取码：afhy </li>
<li>《Kafka &amp; Mafka技术分享及讨论》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1vH-K8nqiLcHvOfJ2upAHiw">百度云链接</a>  提取码：4u7i </li>
<li>《Scala编程中文版(33章全)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1AGg5tC34KiacOztfu7F5sQ">百度云链接</a>  提取码：6m1n </li>
<li>《Spark大数据处理：技术、应用与性能优化(全)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1fy94A8lf17DPzE5l5SyREw">百度云链接</a>  提取码：ghw3 </li>
<li>《Spark机器学习》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1-EBePGITd-xMR_u57b_roA">百度云链接</a>  提取码：3li7 </li>
<li>《Spark快速大数据分析》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1j1o_E6wEu7AWK-rS3PVJHQ">百度云链接</a>  提取码：jlqc </li>
<li>《Spark最佳实践》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1DswMXw66a6dqRcPfsDgB5w">百度云链接</a>  提取码：ziy5 </li>
<li>《ClickHouse中文文档》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/11FdgWUu4pm7pAGX007xuRQ">百度云链接</a>   提取码：vjb3 </li>
<li>《Flink基础教程》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1RrgY8KKEu4R9xFvum16kpg">百度云链接</a>  提取码：7ttp </li>
<li>《CDH集群运维手册》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Vs8qAAfct6SqCII-NEsAwg">百度云链接</a>  提取码：38qp </li>
<li>《Elasticsearch.权威指南（中文版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1QhZThm3O4yT2JhOaSDbptg">百度云链接</a>   提取码：fmo0 </li>
<li>《Hadoop应用架构》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/138cwS-hwADC-VfjXnpSOMQ">百度云链接</a>   提取码：ezgg </li>
<li>《Elasticsearch集成Hadoop最佳实践》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Hd_2n8OqcyM7ewcHzOgIYA">百度云链接</a>   提取码：eiro </li>
<li>《Apache Spark源码剖析》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1v2ocTrQUuL9YYMKhSruEWw">百度云链接</a>   提取码：pe9u </li>
<li>《Flume构建高可用、可扩展的海量日志采集系统》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1c297eE8UC4G2_9uNRHi79A">百度云链接</a>   提取码：qxc4 </li>
<li>《HBase_权威指南》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1hN6dJGxbW_4vZsjKxFqLlg">百度云链接</a>   提取码：y8bm </li>
<li>《HBase实战中文版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1aUDxws8QGqiVaL1rSNYBaQ">百度云链接</a>   提取码：6tek </li>
<li>《Hive编程指南》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1vxA0UYovVGPN9-QO27hOJA">百度云链接</a>  提取码：a88l </li>
<li>《HBase不睡觉书 带目录（高清）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1p8VGyUSRYHBf1NmyljV-zQ">百度云链接</a>  提取码：wpmv </li>
<li>《Apache Kafka实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1YeaRpLrjVoBg-bwCaFx9Cw">百度云链接</a>   提取码：1zdo </li>
<li>《Mahout算法解析与案例实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Ae39bzWSlUXdnSfeJ78IZA">百度云链接</a>   提取码：0vtf </li>
<li>《Kafka权威指南(2018中文版)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1YrlPRpaqa7tLziEX9ohgyQ">百度云链接</a>   提取码：nwrk </li>
<li>《Kafka源码解析与实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1CGfjE0BIVL9g9ri41X9kMA">百度云链接</a>  提取码：t83m </li>
<li>《MapReduce设计模式 [美.迈纳.舒克著]》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1upYNCxt7No0talDDGZxMqQ">百度云链接</a>  提取码：flxj </li>
<li>《Spark快速数据处理》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1d9TKEE-UZHndzg4KhbrVvg">百度云链接</a>   提取码：4m6s </li>
<li>《spark开发基础之Scala快餐》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1AA1m3en-DuaWdeGxwZiwKA">百度云链接</a>   提取码：hxz0 </li>
<li>《Lucene实战（第2版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1oLXp9q7GC4prxzsSUiPNJA">百度云链接</a>   提取码：uot4 </li>
<li>《Spark最佳实践陈欢，林世飞著》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1VJYOam6wh9_ZbMbb5DvEiw">百度云链接</a>   提取码：nmmq </li>
<li>《Spark大数据分析核心概念技术及实践OCR》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1m9eTHFolH_UUuZlGe8YefA">百度云链接</a>   提取码：zbvo </li>
<li>《Storm技术内幕与大数据实践》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1hdd7zomaAnuvdB0WPWj59g">百度云链接</a>   提取码：duju </li>
<li>《Spark内核设计的艺术架构设计与实现（耿嘉安）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1T7sigw6XmDx_1J1sb6WUZg">百度云链接</a>    提取码：xuww </li>
<li>《Presto技术内幕》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1J_t8S8jzK1H3yN6z13gyEA">百度云链接</a>   提取码：tsw5 </li>
<li>《决战大数据》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1aYWTMBO1wfwgAlvC1xxrcA">百度云链接</a>   提取码：eu4p </li>
<li>《Apache Kafka源码剖析》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/12DvTslL0zbCe84GTg2ribw">百度云链接</a>   提取码：qryy </li>
<li>《从Paxos到Zookeeper  分布式一致性原理与实践》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1yunwJmaCqpl4G4X_N6uTtQ">百度云链接</a>  提取码：6iyn </li>
<li>《可视化数据》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1cmrBDzrMP_J4OVEZ-6OKQQ">百度云链接</a>   提取码：f29x </li>
<li>《基于Apache Kylin 构建大数据分析平台》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1fSBhqGNzgoJG7rNc93AIXQ">百度云链接</a>   提取码：vn2b </li>
<li>《从零开始学Storm》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1fctekVikyzNGjXnlxlG3dw">百度云链接</a>   提取码：jfrn </li>
<li>《最全的大数据解决方案》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/120wArPLKMgezx-xlT6ejkg">百度云链接</a>   提取码：me79 </li>
<li>《深入学习MongoDB》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ILBAPa6z6ipWjaIWgKJF_Q">百度云链接</a>  提取码：4qzy </li>
<li>《大数据技术原理与应用概念、存储、处理、分析与应用(第2版)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ZacXfKqdR759h6q7at8dWQ">百度云链接</a>   提取码：h10h </li>
<li>《机器学习与数据挖掘方法和应用（经典）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/17ewpQWcP-UUbGYcVtiVLag">百度云链接</a>    提取码：ry6j </li>
<li>《大数据Spark企业级实战版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/12LMxppofExsFq_lt0hO4uw">百度云链接</a>   提取码：v6im </li>
<li>《实战Elasticsearch、Logstash、Kibana：分布式大数据搜索与日志挖掘及可视》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1mOjfp2GHmsuo0Cfn_DjLZw">百度云链接</a>   提取码：yrpe </li>
<li>《深入理解Spark 核心思想与源码分析 耿嘉安著》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1tBXiDkowwU5ep4R-wjrP4A">百度云链接</a>  提取码：z2eu  </li>
<li>《相关性搜索：利用Solr与Elasticsearch创建智能应用》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1HnLiTnH0yJAgfpMpKsNddA">百度云链接</a>   提取码：its4</li>
</ul>
<h5 id="2-3、Java工具"><a href="#2-3、Java工具" class="headerlink" title="2.3、Java工具"></a>2.3、Java工具</h5><ul>
<li>《Java常见工具》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1OAqk_Z3wa0sexuIE2HqVDg">百度云链接</a>  提取码：agnz</li>
</ul>
<h4 id="03、Python"><a href="#03、Python" class="headerlink" title="03、Python"></a>03、Python</h4><h5 id="3-1、Python书籍"><a href="#3-1、Python书籍" class="headerlink" title="3.1、Python书籍"></a>3.1、Python书籍</h5><ul>
<li>《编程小白的第一本Python入门书》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ZuwmzTlOGqmsSMSyxmfsog">百度云链接</a>  提取码：bjl4 </li>
<li>《笨办法学Python（第三版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ebex54bAnxr-8xrjAPWecw">百度云链接</a>  提取码：516m </li>
<li>《可爱的Python插图版_文字版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1zxL-3Wwea3CmRqDo41r8Mg">百度云链接</a>  提取码：4yln </li>
<li>《A Byte of Python3(中文版)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1yztl8hzdTpWpxpCorpzB5Q">百度云链接</a>  提取码：ic4e </li>
<li>《Python编程：从入门到实践》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Al63fjBymXsH-Eel4SgYrQ">百度云链接</a>  提取码：tvw0 </li>
<li>《Python3简明教程》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1anQzjh8Y_vhzLk0V9I_Q4A">百度云链接</a>  提取码：ue6k </li>
<li>《Python编程初学者指南》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1rWfRX7PdB8d4ZOMlbQavJg">百度云链接</a>  提取码：90t7 </li>
<li>《Python编程快速上手 让繁琐工作自动化》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/18GuxesQbHIH8eWAMXhgy0g">百度云链接</a>  提取码：tpri </li>
<li>《Python编程入门经典》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/10a5CLxFcWvwMPXletk-_kA">百度云链接</a>   提取码：xyv2 </li>
<li>《Python3.5.2-入门指南-高清》<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1wu6c6rN5g2oF_18lp3or3A">百度云链接</a>  提取码：ttgn </li>
<li>《Python3.5.1入门指南中文版-带书签目录》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1qSigiK5dxLRTKJxawXSqiw">百度云链接</a>  提取码：chaa </li>
<li>《Deep Learning  With Python》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1xZDTV4imCMlWt1vH_aFmUA">百度云链接</a>   提取码：gw8c </li>
<li>《NumPy Basics》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1qVJm3hNMSgKo9T29gD881Q">百度云链接</a>  提取码：3prf </li>
<li>《Pandas Basics》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1JBrdSLZeCoaP1H5zjNSL1Q">百度云链接</a>  提取码：oqwg </li>
<li>《笨办法学Python（第四版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1-G4H-6dPvS1LqcH5UjFMyA">百度云链接</a>  提取码：zr14 </li>
<li>《Python Cookbook（第3版）中文版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1nMxg7kck9fj86cn6SGWklg">百度云链接</a>  提取码：8gsx </li>
<li>《Python操作word,excel,pdf》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1izQZpqM5x3AkwsUlkSQiVA">百度云链接</a>  提取码：foas </li>
<li>《Python高级编程第2版 张亮 阿信（译）完整版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1EGb1dKaZMeAoioi4FJhuuQ">百度云链接</a>  提取码：ydku </li>
<li>《Python核心编程 第3版 中文版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1TvqZpEJtBi5bxg2htTjd5g">百度云链接</a>  提取码：umlb </li>
<li>《Python核心编程翻译版第二版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ceg53dJIziyZLu2kl-QT1Q">百度云链接</a>  提取码：5gg3 </li>
<li>《Python灰帽子—黑客与逆向工程师的Python编程之道》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Nvsrh_2qK2BahQ0_zhJNOw">百度云链接</a>  提取码：9vo0 </li>
<li>《Python基础教程（第二版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1nbFJI0pfWVtiTX7duab_iA">百度云链接</a>  提取码：r10m </li>
<li>《Python开发技术详解》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1D4DtRUHZG1z3XTQIP1U7rQ">百度云链接</a>  提取码：r6ca </li>
<li>《Python开发实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1T82h4i0ALu09LqbtP6_bpA">百度云链接</a>  提取码：9qce </li>
<li>《Python入门教材(中文)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1fazYRtZuPwe8oKaVSLWRhA">百度云链接</a>  提取码：d90e </li>
<li>《Python数据处理》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1SccYA_iWwagWwYJ5M1cuNQ">百度云链接</a>  提取码：yqvb </li>
<li>《Python网络编程基础》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1prcpoVAr74T0b6YEgh7Z8g">百度云链接</a>  提取码：neke </li>
<li>《Python学习手册(第4版)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1e9miZ4j3jIgaGRluWfJXnQ">百度云链接</a>  提取码：gsio </li>
<li>《Python正则表达式-深入浅出》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Xidv2uZWHTcIz3FYZZYW3g">百度云链接</a>  提取码：sw5p </li>
<li>《Python知识手册-V2.0.1》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1RvTAeCtOytVFAVfdmmJr6w">百度云链接</a>  提取码：98a6 </li>
<li>《Django.JavaScript.Integration.AJAX.and.jQuery》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1giS6ICt46pKXaQXTWU6tWg">百度云链接</a>   提取码：tiup </li>
<li>《mod_python手册》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1sd2uTJBFull0wUrOI39USg">百度云链接</a>   提取码：q42d </li>
<li>《python-basic》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1SQipRbStAc54vgxLN3GDSw">百度云链接</a>   提取码：1abg </li>
<li>《Python.Essential.Reference,3rd.Edition》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1RPga_Kj3CiNBe6IxkcEs9g">百度云链接</a>   提取码：hhkc </li>
<li>《Python.UNIX和Linux系统管理指南》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Zp0vBpoa_hzq9fsrJG0d0A">百度云链接</a>   提取码：lno0 </li>
<li>《Head_First_Python（中文版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1HXrdZv6wzVrpveNLb9TZ0Q">百度云链接</a>   提取码：45kr </li>
<li>《Python.Cookbook(第2版)中文版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1rBjLppqDeWjm4N8AS9bUpw">百度云链接</a>  提取码：zsw4 </li>
<li>《Python技术参考大全》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1hminDwWjEraoBeB9Ujun8w">百度云链接</a>   提取码：mugz </li>
<li>《Python入门指南 2.5b》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1w7M08ej77cl7i9cfFx4OVQ">百度云链接</a>  提取码：82s3 </li>
<li>《Python3程序开发指南.第二版(带书签)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/15LtRh6XacQYNXZxi5Q7u2Q">百度云链接</a>    提取码：gepi </li>
<li>《python标准库中文版PDF(带章节书签)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/14qaj1p07wnrLfvPXlZOo5A">百度云链接</a>    提取码：dnxu </li>
<li>《Python参考手册(第4版)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1alALXeSdsyBNBsEPaAPF9A">百度云链接</a>    提取码：azjk </li>
<li>《python程序员指南中文版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ubmuxQc8CcRAknZRQXr5SQ">百度云链接</a>    提取码：0ia6 </li>
<li>《Python学习手册(第3版)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1f197WOHN9c9mjkUQ7i3WTg">百度云链接</a>    提取码：2pla </li>
<li>《think-python》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1pdIn6cFKALuFZPbHQp4goA">百度云链接</a>    提取码：vt8r </li>
<li>《think python2》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1lePK-L11Vix9GStATx2rzw">百度云链接</a>    提取码: vaof</li>
<li>《Python技术手册(第2版)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1j3LP-AtRkh6_dNl25Qlxeg">百度云链接</a>     提取码：iovv </li>
<li>《Python进阶》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1djVxEMYDDGruBlZgzDjpYQ">百度云链接</a>     提取码：4f3r </li>
<li>《python编程金典》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1_nk1ANCwIx9OxxhQ7JK7Xg">百度云链接</a>     提取码：q3mu </li>
<li>《Python高级编程》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1_IjVqkINdbGxMT13ViA9RQ">百度云链接</a>      提取码：gi6z</li>
</ul>
<h5 id="3-2、Python爬虫"><a href="#3-2、Python爬虫" class="headerlink" title="3.2、Python爬虫"></a>3.2、Python爬虫</h5><ul>
<li>《Python3网络爬虫数据采集》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1OLmGm-IZOtwKrRRRpVu5xw">百度云链接</a>  提取码：jkk3 </li>
<li>《精通Scrapy网络爬虫、刘硕》  <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1wV51nhVt0dYMczMEJGjoww">百度云链接</a>  提取码：0f1v </li>
<li>《用Python写网络爬虫》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/160g7nG95o4qoI3ajaCrRbw">百度云链接</a>  提取码：657p </li>
<li>《Python和数据分析》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1RpRNDSWnpHDf4M2qxJ-RWQ">百度云链接</a>    提取码：wmlk </li>
<li>《Data Structures and Algorithms in Python [Goodrich, Tamassia &amp; Goldwasser 2013-03-18]》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1SM4peGzGMNR-JS3xoGOLVA">百度云链接</a>   提取码：41qe</li>
</ul>
<h5 id="3-3、Python数据分析"><a href="#3-3、Python数据分析" class="headerlink" title="3.3、Python数据分析"></a>3.3、Python数据分析</h5><ul>
<li>《B站-七周成为数据分析师》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1k6SC07XNCnaVtDgOOIUXdg">百度云链接</a>  提取码：iw7k </li>
<li>《B站-Python3数据分析与挖掘建模实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1iLj3p5IXWTsTPb_4tGJ70w">百度云链接</a>  提取码：q43k </li>
<li>《B站_用Tableau做数据分析》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1G0LthnGlfKCzGZ2dmQO-Bg">百度云链接</a>  提取码：v1l2 </li>
<li>《Python for Data Analysis》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1W3ONWyrEojbDJvMENN8JZg">百度云链接</a>  提取码：fdla </li>
<li>《Python金融大数据分析》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1be4PpHYhNI7ulWYEIf6REg">百度云链接</a>  提取码：8bb7 </li>
<li>《Python科学计算与数据分析》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1p_zmvXjMlcpLbNlYoYBK1g">百度云链接</a>  提取码：yu6t </li>
<li>《Python数据分析基础》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1yr7PeYPJE9xzNcjKnBeknQ">百度云链接</a>  提取码：n5et </li>
<li>《利用Python进行数据分析》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1HMfse3neYt2FWfIumR3T3Q">百度云链接</a>  提取码：o5jb </li>
<li>《Python数据分析基础教程：NumPy学习指南（第2版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1KTNQucI3t_g-llW5NX9kHw">百度云链接</a>   提取码：lq48 </li>
<li>《Python数据分析实战_2016版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1BdFVwiFbix-yveuItPn2Pw">百度云链接</a>  提取码：0yue </li>
<li>《Python数据分析与挖掘实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1MNC4LCxoXXrakLLBYs4YqA">百度云链接</a>  提取码：8qjq </li>
<li>《Tableau：数据可视化之极速BI》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/12lOA4AipHGaNph-SYesBCQ">百度云链接</a>  提取码：59ey </li>
<li>《Tableau：数据可视化之极速BI数据源》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1j9L2Oui6q1bSZ26ZdT1YvA">百度云链接</a>  提取码：kdrw </li>
<li>《Tableau商业智能与可视化应用实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/10n85f0LsKmIK5FV3lmlr3A">百度云链接</a>  提取码：ptkp </li>
<li>《Python数据分析14天入门训练营》课程资料 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1vDNlNNsz6GUVJaROkf2kRQ">百度云链接</a>  提取码：sr2z </li>
<li>《触手可及的大数据分析工具：Tableau案例集 数据源》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/17wKWXhmnGaKGAnWkj4evmQ">百度云链接</a>  提取码：ff3n </li>
<li>《触手可及的大数据分析工具 Tableau案例集》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1vvnlry-nc_tQ3sgpqzSZUQ">百度云链接</a>  提取码：pjym </li>
<li>《大数据分析精品资料》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/17TBwSey21_HsSq2N8cndqA">百度云链接</a>   提取码：fs3o </li>
<li>《利用Python进行数据分析-第二版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1rmnrrg3kQiOtOtzmnWN-Jw">百度云链接</a>  提取码：2hdl </li>
<li>《人人都是数据分析师：Tableau应用实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1pMR94zfb8kaPr_1HsOYe_A">百度云链接</a>  提取码：yfq7 </li>
<li>《数据分析实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1RsqfSfRyeeXTasz3VXAykA">百度云链接</a>  提取码：7sw2 </li>
<li>《数据分析修炼手册》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1cinQiucE4K7k4GISfll2JA">百度云链接</a>  提取码：qfs7 </li>
<li>《数据分析学习顺序》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1bnqCMfn74ATTb-Nt1l1yJQ">百度云链接</a>  提取码：9dy8 </li>
<li>《增长黑客_创业公司的用户与收入增长秘籍、范冰》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1M1ZZblb3RAM0HjlnKEBpkw">百度云链接</a>  提取码：llq2</li>
</ul>
<h5 id="3-4、Python数据可视化"><a href="#3-4、Python数据可视化" class="headerlink" title="3.4、Python数据可视化"></a>3.4、Python数据可视化</h5><ul>
<li><p>《Python数据可视化编程实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1sBuA63eBEuAJhhHOYJLUSw">百度云链接</a>  提取码：iglx </p>
</li>
<li><p>《数据可视化之美》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/10Xe1KJvFHYGUy4vnPQbGAQ">百度云链接</a>  提取码：snio</p>
</li>
</ul>
<h5 id="3-5、Python数据挖掘"><a href="#3-5、Python数据挖掘" class="headerlink" title="3.5、Python数据挖掘"></a>3.5、Python数据挖掘</h5><ul>
<li><p>《Python编程-数据挖掘入门与实践(中文完整版)-图灵程序》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Ynu2E8WJcLi5-F4hD7MqMQ">百度云链接</a>  提取码：22c2 </p>
</li>
<li><p>《Python数据挖掘入门与实践》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1n_P0BtKe-WBfbUMPy1dWvw">百度云链接</a>  提取码：1r46 </p>
</li>
<li><p>《数据挖掘导论、完整版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1BqtnKZZWH3an4nSQN7PScw">百度云链接</a> 提取码：c8dx  </p>
</li>
<li><p>《数据挖掘原理与算法》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1G2Uh0Om20IYJwNImA4fKFw">百度云链接</a>  提取码：yx67</p>
</li>
</ul>
<h4 id="04、Go语言"><a href="#04、Go语言" class="headerlink" title="04、Go语言"></a>04、Go语言</h4><ul>
<li><p>《Go Web 编程》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1XHGe8wFZ_x3UeGyzgyMARA">百度云链接</a>   提取码：h9qu </p>
</li>
<li><p>《Go并发编程实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/15m5sR-2S6xF57vDW9Qi0Fg">百度云链接</a>  提取码：7t2d </p>
</li>
<li><p>《Go语言编程》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ia7WPlnzOOOkKvytqfF6Gw">百度云链接</a>   提取码：o2fn </p>
</li>
<li><p>《Go语言标准库参考》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1_pVFevjGCDgPrDlVB-E7Ug">百度云链接</a>  提取码：ygbj </p>
</li>
<li><p>《Go语言程序设计》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1_MEFLoQvaHcKlOkHgFzrZw">百度云链接</a>  提取码：rbuo </p>
</li>
<li><p>《Go语言圣经》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1k1t5EFdvauob2uzu4gAizQ">百度云链接</a> 提取码：7qhr  </p>
</li>
<li><p>《Go语言实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/19jTChKmcy566H2yaUOUgiQ">百度云链接</a>  提取码：aqjp </p>
</li>
<li><p>《Go语言学习笔记》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1yrmiUv_3x7SGuYYiXAj3LA">百度云链接</a>  提取码：zj1d </p>
</li>
<li><p>《学习 Go 语言(Golang)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1eQrTmd7tAGQmwEl_sKWShg">百度云链接</a>  提取码：d98t</p>
</li>
</ul>
<h4 id="05、数据结构与算法"><a href="#05、数据结构与算法" class="headerlink" title="05、数据结构与算法"></a>05、数据结构与算法</h4><ul>
<li>《谷歌大佬总结的三本LeetCode刷题笔记，支持Java、C++、Go三种语言》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/14_G6dHVpi7KFJ2NH3SC7IQ">百度云链接</a>  提取码：ujuc  </li>
<li>《啊哈！算法 哈磊》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ShKCKjoTIeThwQf0oHc_8w">百度云链接</a>  提取码：5fop </li>
<li>《大话数据结构》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1qedzjHo_mFTrUvcFXm44tg">百度云链接</a> 提取码：ehu4  </li>
<li>《背包九讲》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1kg20UyREHVzuGZQANhTmfQ">百度云链接</a>  提取码：8ioa </li>
<li>《带你快速刷完67道剑指offer》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1s7Pxb12RtnfH48ps2BiCrA">百度云链接</a>   提取码：dxm0 </li>
<li>《编程之美-完整版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1_wwULGQtjwI_MR0_biZvUA">百度云链接</a>  提取码：yumy </li>
<li>《编程珠玑 第二版 人民邮电出版社》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1SYhLeAXyDWXEw-FPPFsGHQ">百度云链接</a>  提取码：gqg5 </li>
<li>《编程珠玑 英文第二版-Programming.Pearls》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/14L8E-vG9efQKr_f0EkqX-Q">百度云链接</a>  提取码：xsdt </li>
<li>《程序员代码面试指南 IT名企算法与数据结构题目最优解（左程云著）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1joDK8w23976nwVugfgYQHg">百度云链接</a> 提取码：p6r8 </li>
<li>《程序员的算法趣题》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/11R4BUkD24rIMDhQoxp1Odw">百度云链接</a>  提取码：1r8q </li>
<li>《程序员面试金典》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1BrwDEX6qJAcTRemwZpNm2g">百度云链接</a>  提取码：7k9q </li>
<li>《计算机程序设计艺术卷1：基本算法》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1WDSHk8N5sjzXna_he8LZ6w">百度云链接</a>  提取码：4ey6 </li>
<li>《计算机程序设计艺术卷2：半数值算法》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1EeiGyvuzyvloQkH7_b9zZA">百度云链接</a>  提取码：tmep </li>
<li>《计算机程序设计艺术卷3：排序与查找》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1secLsfX8_d2bnsR7b9EJFA">百度云链接</a> 提取码：ebud </li>
<li>《剑指Offer》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ZpLaXTtkX1MMuD9bu_3oHQ">百度云链接</a>  提取码：20z4</li>
<li>《漫画算法：小灰的算法之旅》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1FkP7Axl6s23p2jF56unqwg">百度云链接</a> 提取码：2fof  </li>
<li>《妙趣横生的算法（C语言实现 第2版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Wxyl6EFPOctNU0ZgpHA_ig">百度云链接</a> 提取码：uvm8 </li>
<li>《数据结构-C语言 严蔚敏 pdf》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1L3f5zLWRZN4-1kKD-CA5NA">百度云链接</a>  提取码：g0o5 </li>
<li>《严蔚敏：数据结构题集(C语言版)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1_jpX6NYUIqE2BQmYYdT4aA">百度云链接</a>  提取码：u7m0 </li>
<li>《数据结构与算法 Python语言描述_裘宗燕》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/11Z_Cs4_MQIxhJyhz_AJXQg">百度云链接</a>  提取码：1c9u </li>
<li>《数据结构与算法分析C++描述》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/186SUUTsuQzoqe4dbxUYWNg">百度云链接</a>   提取码：nhnz </li>
<li>《数据结构与算法分析—Java语言描述》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1kTbnQhh3XeXu8e_XRRU85Q">百度云链接</a>  提取码：cyn6 </li>
<li>《数据结构与算法分析：C语言描述原书第2版 高清版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1jSuFAqBmtKNqB84SjuWI9Q">百度云链接</a>   提取码：gy53 </li>
<li>《算法（第4版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1N6UcwKech2x_Ixde9vXFRw">百度云链接</a>   提取码：e65w </li>
<li>《算法导论原书第3版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1mX7CVpIyDcjkHuqy98orpA">百度云链接</a>  提取码：xl63 </li>
<li>《算法导论中文版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/11B72LuPWUAzsTn1c1TPSwA">百度云链接</a>  提取码：okm5 </li>
<li>《算法分析与设计》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1TnxVZkwfuQwWzK6kDAgA7w">百度云链接</a>  提取码：mmcx </li>
<li>《算法谜题》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1c2egFp2ME7ItqPLJPqyt1g">百度云链接</a>  提取码：tq0f </li>
<li>《算法图解》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1xTOT6otkrwY3Pw5JGqaiHA">百度云链接</a>  提取码：i2k7 </li>
<li>《挑战程序设计竞赛(第1版)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1oEfnV0xou7VLveCNsEv7Kw">百度云链接</a>    提取码：gm3c </li>
<li>《挑战程序设计竞赛(第2版)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1_Q9kpWu1tQC9lIIkSGx1zQ">百度云链接</a>    提取码：app8 </li>
<li>《Cookbook-LeetCode》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1lExDvtaqr-IWxvT1AHBE1g">百度云链接</a>  提取码：evzs </li>
<li>《Cormen-Introduction to Algorithms》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/17rtAshLD_kPrk3ohKbxbkg">百度云链接</a>  提取码：unt9 </li>
<li>《JavaScrit数据结构与算法（第2版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Eq-DcxfBqyMKP1zEyEQ6vg">百度云链接</a>  提取码：sbxc </li>
<li>《Java数据结构和算法.（第二版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1kQydNS6uqW7r7xDLDd8N1Q">百度云链接</a>  提取码：owjm </li>
<li>《labuladong的算法小抄官方完整版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1qLczv399rEbhXO_fP1yp0Q">百度云链接</a>   提取码：x3uv </li>
<li>《Sedgewick-Algorithms》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1HXbonThL98N-uGgIDPq0Og">百度云链接</a>  提取码：reyi </li>
<li>《Data-Structures-Problem-Solving-Using-Java》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1m2HQcZa4mr1POkCBm3JIYA">百度云链接</a>   提取码：mkvu </li>
<li>《leetcode-solution》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1iQHRdcPPkrqHTZJNgBWMkw">百度云链接</a>   提取码：zfdq </li>
<li>《算法竞赛入门经典训练指南》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1EGOZdzjHpLG-Gn7hiN5nDg">百度云链接</a>   提取码：ktkh </li>
<li>《算法竞赛入门经典及答案》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Jm4sjlHyrEI6-8SJNwfjwQ">百度云链接</a>   提取码：hw1u </li>
<li>《分布式算法导论》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Nbwrr8ukzDXgcwVAz7_x7w">百度云链接</a>   提取码：i8oy </li>
<li>《算法之道》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1bYsTGe5DoBfBonY3YcZVDw">百度云链接</a>   提取码：f2td </li>
<li>《C++数据结构与算法 （第4版）带书签目录 完整版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1t1bsfdO6MbrPE9MNurkHew">百度云链接</a>   提取码：6yyw </li>
<li>《趣学算法》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/16pUBD7NDO8190Q_9La5IRQ">百度云链接</a>  提取码：lkah</li>
</ul>
<h4 id="06、操作系统"><a href="#06、操作系统" class="headerlink" title="06、操作系统"></a>06、操作系统</h4><ul>
<li>《深入理解计算机系统 第3版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1_J-lMdgmx_Pjw0B-mB3cOA">百度云链接</a>   提取码：rqey </li>
<li>《现代操作系统、英文版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/11uvYULUEOm-Wu827PX1i-g">百度云链接</a>   提取码：9kvb </li>
<li>《现代操作系统（第三版）中文版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Wfzq1gWF9dEaXVgSXoLKgQ">百度云链接</a>   提取码：qmfc </li>
<li>《30天自制操作系统 (图灵程序设计丛书)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1oY_pKauVOso44BKKKU8pYQ">百度云链接</a>   提取码：vtbf </li>
<li>《操作系统设计与实现》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Rp7orpMgo1rjU59GGMo_mg">百度云链接</a>   提取码：fvo8 </li>
<li>《操作系统真象还原》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/11_ZXZ0415gKbuhwTKf66hw">百度云链接</a>    提取码：blrx </li>
<li>《操作系统精髓与设计原理 第6版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1NAUB37lqUwkGvHpi3O-1xQ">百度云链接</a>   提取码：y7pk </li>
<li>《操作系统精髓与设计原理 第8版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1TD_TFEcXwV8xxxA10hDBXg">百度云链接</a>   提取码：buzn </li>
<li>《自己动手写操作系统》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1rpTNR_f5VgTtVy-swSim9w">百度云链接</a>   提取码：zzvy </li>
<li>《CMU2017-Lab》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1YjrpbkoJ3QEbgduCGBV10A">百度云链接</a>    提取码：fabh </li>
<li>《Compilers_ Principles, Techniques, and Tools》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1bxyVbHGZv8TkFMe4pVGMUw">百度云链接</a>   提取码：o3h5 </li>
<li>《Computer Systems_ A Programmer’s Perspective》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1DfRNQzaDTVSTItkLPHTqbA">百度云链接</a>   提取码：p5kp </li>
<li>《Orange’s一个操作系统的实现》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1BucJk6YqXzGAIiBI6oAwyQ">百度云链接</a>   提取码：u6ic </li>
<li>《编译原理》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1xyRsZNjvt7ah3UbL3I8TMw">百度云链接</a>   提取码：8i54 </li>
<li>《操作系统概念、英文版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1TjgS3Juxo72hdGYJkKDjHA">百度云链接</a>   提取码：2rof </li>
<li>《操作系统概念》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1rjfR6Qvyo1jbr-LzcRQ9dg">百度云链接</a>    提取码：u3by </li>
<li>《操作系统概述、公众号资源》  <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Iy2BQCOIzYW_S1Tv6fVDZA">百度云链接</a>   提取码：apgg </li>
<li>《操作系统之哲学原理 第2版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1iOwocriRPY8UMZWbVmXTaA">百度云链接</a>   提取码：xzzn </li>
<li>《分布式系统概念与设计 原书第5版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1RFp3qAyfhoFd4u8fkKlxcQ">百度云链接</a>   提取码：r2wn </li>
<li>《计算机系统要素、从零开始构建现代计算机》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1FsEHp6bPkdZVaFEiK3pCIA">百度云链接</a>   提取码：hylp</li>
</ul>
<h4 id="07、Linux"><a href="#07、Linux" class="headerlink" title="07、Linux"></a>07、Linux</h4><ul>
<li><p>《Linux 内核设计与实现》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1TyDQo4sQNw4y-jf_2cvYsQ">百度云链接</a>   提取码：1f28 </p>
</li>
<li><p>《Linux UNIX系统编程手册、上》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1uj9cpVgr2gGAgYl-OKLdgg">百度云链接</a> 提取码：htnh </p>
</li>
<li><p>《Linux UNIX系统编程手册、下》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1y_4FTpsLev6lnfmX9pPSmA">百度云链接</a>  提取码：lxd4 </p>
</li>
<li><p>《UNIX网络编程卷1：套接字 API》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1neeJhRQlvYUkg3CjMXX1Sw">百度云链接</a>  提取码：3g7h </p>
</li>
<li><p>《UNIX网络编程卷2：进程间通信》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1y0NiccCKS7timEAff6stoA">百度云链接</a>  提取码：7anx </p>
</li>
<li><p>《UNIX环境高级编程 第三版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1e0UDP3zZqlw3f0F-Ob3QkA">百度云链接</a> 提取码：eb50 </p>
</li>
<li><p>《《UNIX系统编程手册 上》.((德)Michael Kerrisk ).[PDF]@ckook》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Z4DHMSvkSjmGv2cubm2HfA">百度云链接</a>  提取码：2gkj </p>
</li>
<li><p>《《UNIX系统编程手册 下》.((德)Michael Kerrisk ).[PDF]@ckook》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1-YB-H2I5Bxdek9YxD0jgGg">百度云链接</a>  提取码：wtyp </p>
</li>
<li><p>《Linux宝典》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1DItPt6A1P-id40zB0__5Pw">百度云链接</a>   提取码：225z </p>
</li>
<li><p>《Linux常用命令大全》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1uRT7xh_83LoM004lmB8NgA">百度云链接</a>   提取码：8b4u </p>
</li>
<li><p>《LINUX防火墙（原书第3版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1GM0iXFNca6Secz893tMc8g">百度云链接</a>    提取码：o9md </p>
</li>
<li><p>《Linux高级程序设计中文第三版杨宗德、人电出版社》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1iXnRNkGjURXvKoANWrq8UA">百度云链接</a>   提取码：4cms </p>
</li>
<li><p>《Linux环境编程：从应用到内核》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1gnseg9k8eFv73b0DWrETAQ">百度云链接</a>   提取码：8v8w </p>
</li>
<li><p>《Linux内核设计与实现 第3版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1G7JK6vYcHLUBLeGGlBkSjw">百度云链接</a>   提取码：vzmc </p>
</li>
<li><p>《Linux内核完全注释》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1JMZnMxOTxj99QYhvVTT0jA">百度云链接</a>   提取码：wr95 </p>
</li>
<li><p>《Linux系统命令及shell脚本实践指南Linux unix技术丛书》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1q8d4wVSkumyjhWphyTIZiw">百度云链接</a>   提取码：gygv </p>
</li>
<li><p>《Unix &amp; Linux 大学教程》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1NNbY2MaJ6qudamuaiEKzZA">百度云链接</a>   提取码：thfb </p>
</li>
<li><p>《汇编语言基于Linux环境第3版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1WseMMExVQ6_N6MQriTY22w">百度云链接</a>    提取码：0357 </p>
</li>
<li><p>《鸟哥的Linux私房菜基础篇和服务器篇》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1JXQX2kDGVuq_JRpwK9z8jw">百度云链接</a>   提取码：kbpi </p>
</li>
<li><p>《深入Linux内核架构 (图灵程序设计丛书·Linux UNIX系列)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1sld7OS999MC2rjXWjRslsA">百度云链接</a>   提取码：6int </p>
</li>
<li><p>《深入理解Linux内核》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1eJ8nXGOUW1cyIKyNEY4SPA">百度云链接</a>    提取码：sm3l </p>
</li>
<li><p>《[Linux命令详解词典].施威铭研究室.扫描版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1TS1idjijuZCXTgQfb6vTjQ">百度云链接</a>   提取码：oc3u </p>
</li>
<li><p>《Advanced Programming in the UNIX® Environment》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1kUpdpnbTavbRGzr42Pmbiw">百度云链接</a>   提取码：sm6b </p>
</li>
<li><p>《Harley Hahn’s Guide to UNIX and Linux》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1pZwME_usn6ieDsP0d2o9eg">百度云链接</a>   提取码：99c1 </p>
</li>
<li><p>《Linux Kernel Development》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1yaF6nMPQspvNNP4oA6uadQ">百度云链接</a>   提取码：rvnn </p>
</li>
<li><p>《Linux多线程服务端编程 书签高清非扫描、陈硕》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Mf3eAcwSqgUBUS73ly0Dmg">百度云链接</a>   提取码：5kq1 </p>
</li>
<li><p>《Linux网络编程》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1X5U4qb7mW1R0P2EMM9yJZA">百度云链接</a>    提取码：vdbg </p>
</li>
<li><p>《Linux高性能服务器编程》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1W24HUg4nHJWSkgBUEOcC0w">百度云链接</a>    提取码：jt32 </p>
</li>
<li><p>《Unix-Linux编程实践教程》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1loUsYlQpUaLRpLwCp9TFjA">百度云链接</a>   提取码：w5p1 </p>
</li>
<li><p>《UNIX编程艺术-中文版【The+Art+of+UNIX+Programming】》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1bjgIO8_lPMgv_4V8H6tAOw">百度云链接</a>    提取码：8hhc</p>
</li>
</ul>
<h4 id="08、后端架构"><a href="#08、后端架构" class="headerlink" title="08、后端架构"></a>08、后端架构</h4><ul>
<li>《Redis开发与运维(付磊)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1J3P3XLdvP9gr3umPe2Y3IA">百度云链接</a>    提取码：rtow </li>
<li>《后台开发》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1jfXLNkyByzprEtqiuC9R_A">百度云链接</a>    提取码：7k53 </li>
<li>《后台开发核心技术与应用实践高清PDF》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/14jK3cGT0yuAhVI5twVd6Ew">百度云链接</a>    提取码：syau </li>
<li>《深入理解Nginx模块开发与架构解析第2版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1tOn_25CKSY9ZtupqZKeNZw">百度云链接</a>    提取码：o14w </li>
<li>《Kafka权威指南》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1D-oNXE-OiOZ-nTzwOjc92w">百度云链接</a>   提取码：pn4r </li>
<li>《RabbitMQ实战指南》  <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1riCazeEYSNLJxGaI9QzZzA">百度云链接</a>  提取码：l0xj</li>
</ul>
<h4 id="09、计算机系统知识"><a href="#09、计算机系统知识" class="headerlink" title="09、计算机系统知识"></a>09、计算机系统知识</h4><ul>
<li><p>《大话计算机》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1DFvp8RlQLMN4_4iYiBo1YQ">百度云链接</a> 提取码：9jc8 </p>
</li>
<li><p>《编码：隐匿在计算机软硬件背后的语言》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/112j7NXaFxzAusaLkZau9uQ">百度云链接</a> 提取码：60p1 </p>
</li>
<li><p>《程序是怎样跑起来的》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/15BjPm4uFvJHNoedrOjCdIg">百度云链接</a> 提取码：u30m </p>
</li>
<li><p>《计算机是怎样跑起来的》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1drr-zVUYsAqvFFM_aVpEIg">百度云链接</a> 提取码：uwfk </p>
</li>
<li><p>《程序员的自我修养—链接、装载与库、书签目录版本》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1DwDoGT8eEoMTpVOKJkQ4wg">百度云链接</a> 提取码：ivmv </p>
</li>
<li><p>《计算机组成与设计：硬件_软件接口》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1q7Bp_4sEqhFUzhrTUrprRA">百度云链接</a> 提取码：dhda </p>
</li>
<li><p>《Patterson-Computer Organization and Design_The Hardware_Software Interface》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1_1wOcREbVyP-mY78ximbeQ">百度云链接</a> 提取码：zn24 </p>
</li>
<li><p>《Code、The Hidden Language of Computer Hardware and Software》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1UQJ7NEnPluPoUZ2iCs9_zA">百度云链接</a>  提取码：pytl  </p>
</li>
<li><p>《计算机组成  结构化方法  中文 第6版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1lhCYoQb3mkBtlsuOu16zTg">百度云链接</a>    提取码：c1qy</p>
</li>
</ul>
<h4 id="10、计算机网络"><a href="#10、计算机网络" class="headerlink" title="10、计算机网络"></a>10、计算机网络</h4><ul>
<li>《计算机网络-自顶向下方法-第6版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1iLzPlkAylfyKGso1rtwWzQ">百度云链接</a> 提取码：oj35 </li>
<li>《计算机网络：自顶向下方法课后习题参考答案》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1nsl7kc7bx4faRcwKXmYCvQ">百度云链接</a> 提取码：d25h </li>
<li>《HTTP核心总结》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/157of30-s21okWDgBz-FG6A">百度云链接</a> 提取码：2fk9 </li>
<li>《HTTP权威指南》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1_1GR-53UE6HHaHnzjdeq6Q">百度云链接</a> 提取码：1jhn </li>
<li>《TCPIP详解三部曲卷1：协议》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1uvlA8rgsdEw3PwWejZWKVg">百度云链接</a>  提取码：j2iq </li>
<li>《TCPIP详解三部曲卷2：实现》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1dU5VNXfN0V9MIFsxVXw93g">百度云链接</a>  提取码：r1cl </li>
<li>《TCPIP详解三部曲卷3》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/13BDPDFfnaZXHdiGV0SuYKw">百度云链接</a>  提取码：zee6 </li>
<li>《TCP源码分析》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1e9x58bRuntVMR-igdnnuIA">百度云链接</a> 提取码：dhlo </li>
<li>《Wireshark 数据包分析实战（第二版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/126-_exlgE1gwqDc7eBKl5w">百度云链接</a> 提取码：shyo </li>
<li>《Wireshark网络分析的艺术》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1eaCwGFXC5t_7sOaZyGSaIg">百度云链接</a> 提取码：lljf </li>
<li>《Wireshark网络分析就这么简单》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1S179DBl2xp1AfT3MQXKDwg">百度云链接</a> 提取码：9j5j </li>
<li>《计算机网络 第七版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1qcRML0XOAFWzo9OwJfVAwQ">百度云链接</a> 提取码：89yv </li>
<li>《计算机网络：系统方法》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1NP0JtrCcKz7KP03ivuf-nA">百度云链接</a> 提取码：uhke </li>
<li>《图解HTTP》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1F-xfG8fnSIu_bS_ehkZvdw">百度云链接</a> 提取码：faxi </li>
<li>《图解TCPIP(第5版)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1kvM_vINqRdgIe-SBnIDKjA">百度云链接</a> 提取码：j86n </li>
<li>《网络是怎样连接的 (图灵程序设计丛书)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1MXO3asDFShFC7C1tzT3vSg">百度云链接</a> 提取码：vhm1 </li>
<li>《Computer Networking_ A Top-down Approach》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1A5IxiuiuIb80vaW5OAvBTQ">百度云链接</a> 提取码：ewr3 </li>
<li>《Computer Networks, A Systems Approach》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/13f2pu5TKfYBK8oXEmvDPtg">百度云链接</a> 提取码：o98i</li>
</ul>
<h4 id="11、数据库"><a href="#11、数据库" class="headerlink" title="11、数据库"></a>11、数据库</h4><ul>
<li><p>《MySQL必知必会 PDF + 源码》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1zVp5YyqO1PrU_-kdm_CZog">百度云链接</a>   提取码：45id </p>
</li>
<li><p>《数据库系统实现（第二版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1QaYz2VnJVrAMW1V9qQM2ng">百度云链接</a>  提取码：hjds </p>
</li>
<li><p>《高性能MySQL（第3版）].Baron.Scbwartz等.扫描版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1EFj1KKQ61WNMlHT48mwYhw">百度云链接</a> 提取码：nszh </p>
</li>
<li><p>《深入浅出MySQL++数据库开发、优化与管理维护+第2版+唐汉明》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/18BeYVzM0FDk3DdSAfy-4yQ">百度云链接</a> 提取码：a0uo </p>
</li>
<li><p>《数据库系统概念》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1TI2TK1TbiHZiXfWZGaDKlA">百度云链接</a> 提取码：eugi </p>
</li>
<li><p>《Database System Concepts》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1MQ2fh9QjH6BxntQbuiQNgg">百度云链接</a> 提取码：1u2u </p>
</li>
<li><p>《MongoDB权威指南》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1trgNvpJyXt-T6VVbEUwFbw">百度云链接</a> 提取码：vcca </p>
</li>
<li><p>《MySQL技术内幕  InnoDB存储引擎  第2版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1qVtnm_HhPEQbPPQp0Lcf4g">百度云链接</a> 提取码：c9qa </p>
</li>
<li><p>《Redis设计与实现》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1pV6nTDFJTS7IuFG1LKUK6g">百度云链接</a> 提取码：r7r6 </p>
</li>
<li><p>《Redis实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1QyrBT_VYLvuI25KeorLMfQ">百度云链接</a> 提取码：eebx </p>
</li>
<li><p>《Redis开发与运维》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1KVNEBOTE3GyUhCN9IpxMHg">百度云链接</a>  提取码：ot6f </p>
</li>
<li><p>《SQLite 权威指南》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1OpzEYWcYzCnsUDgjJoujeg">百度云链接</a> 提取码：5bh2 </p>
</li>
<li><p>《SQL查询的艺术》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/13a9gJZ7zy69qGOresD5dTQ">百度云链接</a> 提取码：tsfm </p>
</li>
<li><p>《分布式数据库系统  大数据时代新型数据库技术》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1mHpGbyPqcR1RHHWYG6m4rg">百度云链接</a> 提取码：zsxl </p>
</li>
<li><p>《分布式数据库系统原理.第3版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/198SOMGm1U6ksiB5Dk2jiNw">百度云链接</a> 提取码：xkv4 </p>
</li>
<li><p>《数据库系统概念 中文第6版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1l3zRQukLpRjXEI6625jAZw">百度云链接</a> 提取码：fupf </p>
</li>
<li><p>《Nosql数据库入门》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1J6yqqz8DueNUue9FS763zQ">百度云链接</a>   提取码：ll6k </p>
</li>
<li><p>《MySQL5.5从零开始学》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1BVYoA56hlzm4Act-v_M_kA">百度云链接</a>   提取码：3u1c </p>
</li>
<li><p>《NoSQL精粹_中文完整版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ttAxk1p-Ha9_yfPDcNbMsg">百度云链接</a>   提取码：vwcg </p>
</li>
<li><p>《Redis入门指南》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1WF4rswmI7QUwWmkz0RUG7g">百度云链接</a>    提取码：wcga </p>
</li>
<li><p>《数据库原理、应用与实践（SQL Server）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1FV7E4CjzUk_ecYXNBGP2Bw">百度云链接</a>    提取码：mgw3</p>
</li>
</ul>
<h4 id="12、前端-全栈"><a href="#12、前端-全栈" class="headerlink" title="12、前端&amp;全栈"></a>12、前端&amp;全栈</h4><ul>
<li><p>《[HTML与CSS入门经典(第7版)].（美）奥利弗，（美）莫里森.扫描版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1E_hGtyCxxYFRa4-7gepsOg">百度云链接</a> 提取码：t8lj </p>
</li>
<li><p>《[JavaScript.DOM编程艺术（第2版）]》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1QyHkKNdVb9qhzaLmNxThHg">百度云链接</a> 提取码：gpaz </p>
</li>
<li><p>《Bootstrap实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1OAx72Wf9PsvWUmwkpHFs3g">百度云链接</a> 提取码：7xtf </p>
</li>
<li><p>《HTML5揭秘》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1r0JhCMPva0s8sC2HNjphLg">百度云链接</a> 提取码：v9qw </p>
</li>
<li><p>《HTML5与CSS3基础教程（第8版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ljIv5URpcxT056382D9JuA">百度云链接</a>提取码：9i5k </p>
</li>
<li><p>《Javascript 高效图形编程-中文版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1uenyHwrThfCUwZz4kfLbMg">百度云链接</a> 提取码：ksmm </p>
</li>
<li><p>《javascript高级程序设计》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1dDCy6XQoOfdUZn05FIfW8w">百度云链接</a>  提取码：zmz4 </p>
</li>
<li><p>《jQuery高级编程，中文完整扫描版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1azNEKU69AyGucl4ERNe-7Q">百度云链接</a>  提取码：x1wi </p>
</li>
<li><p>《jQuery技术内幕 深入解析jQuery架构设计与实现原理》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1hU3c9W9EYPc0PoeXanONBQ">百度云链接</a>  提取码：1e3e </p>
</li>
<li><p>《jQuery权威指南》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Ng_CFZa3uN4rsbpfWSwJBw">百度云链接</a> 提取码：tflj </p>
</li>
<li><p>《Node.js开发指南》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ZO8AVB8ECEcFLl8kGppBGg">百度云链接</a>  提取码：r1oj </p>
</li>
<li><p>《nodebook》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1pJ4sLnCMUPeceDrM7pz9mA">百度云链接</a> 提取码：himg </p>
</li>
<li><p>《JavaScript高级程序设计（第3版）中文 高清》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1yW9-ZzPkKyNRePdYEK7E3A">百度云链接</a> 提取码：uus7 </p>
</li>
<li><p>《疯狂AJAX讲义》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1-IJNk0xIKYRpfx2SAjPC2g">百度云链接</a> 提取码：w85h </p>
</li>
<li><p>《深入浅出Node.js》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1vZuoMxAwEbJl9wc6Vlmo7Q">百度云链接</a> 提取码：cmkj</p>
</li>
</ul>
<h4 id="13、安卓IOS逆向"><a href="#13、安卓IOS逆向" class="headerlink" title="13、安卓IOS逆向"></a>13、安卓IOS逆向</h4><ul>
<li><p>《Android软件安全与逆向分析》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1qFzWwIoAGxiyIz2aC1j8pQ">百度云链接</a>   提取码：wmnt</p>
</li>
<li><p>《IOS应有逆向工程：分析与实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1d6tvtINDP0sWroeG9NTC2Q">百度云链接</a>   提取码：q9co</p>
</li>
<li><p>《逆向工程核心原理》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1fIqsK3uutqPhIbXPSvXRoA">百度云链接</a>  提取码：j0qg</p>
</li>
</ul>
<h4 id="14、机器学习-深度学习-人工智能"><a href="#14、机器学习-深度学习-人工智能" class="headerlink" title="14、机器学习&amp;深度学习&amp;人工智能"></a>14、机器学习&amp;深度学习&amp;人工智能</h4><h5 id="14-1、机器学习"><a href="#14-1、机器学习" class="headerlink" title="14.1、机器学习"></a>14.1、机器学习</h5><ul>
<li>《Python机器学习及实践－从零开始通往KAGGLE竞赛之路》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1y4XL_fMcWNMAhzFpnHpcAw">百度云链接</a>   提取码：5tei</li>
<li>《Python机器学习经典实例》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1QPolrwtE3Qzm_QAHK_Cwdg">百度云链接</a>  提取码：clxi</li>
<li>《Python神经网络编程高清版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Ibyk_glLNnelApw4HVbMxA">百度云链接</a>   提取码：lw2j</li>
<li>《Python数据科学手册》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1qbK1HAOh3xKHs8gAXUNa9w">百度云链接</a>    提取码：pps1</li>
<li>《贝叶斯思维统计建模的Python学习法》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1m9lpaTfS7mTkCkqQf4uTeg">百度云链接</a>   提取码：h9tf</li>
<li>《机器学习7》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1MlWEUGxdigsmzmwOcoETxQ">百度云链接</a>    提取码：bbcs</li>
<li>《机器学习_周志华》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1QX0O_xZv3q-6j6zY20LVgg">百度云链接</a> 提取码：pgyb</li>
<li>《机器学习numpy和pandas基础》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1cSyqyq3v21moW4gkYDcM_Q">百度云链接</a> 提取码：1i2k</li>
<li>《机器学习导论》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1XEnqBe-bZ9sRRKK9C2HX5g">百度云链接</a> 提取码：dylv</li>
<li>《机器学习实战》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1cXJ-_Ab_DOGGnc5jnQOeCA">百度云链接</a> 提取码：94sv</li>
<li>《集体智慧编程》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1TwNvL2nJIptmsLxT1LTYTw">百度云链接</a>  提取码：xf8i</li>
<li>《数据科学入门》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Em1YfSmHhC_NCZsVY103IQ">百度云链接</a>   提取码：mo58</li>
<li>《数据科学与大数据(英文版)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1yGxt8TCdMcYcBFMC2KDHMg">百度云链接</a>   提取码：r0v6</li>
<li>《统计学个人笔记》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ALqzc-YbPEPJVdPnyJFRtQ">百度云链接</a>   提取码：luao</li>
<li>《统计学习方法-李航》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1y-VtISgOUWOT_JbZYHduqg">百度云链接</a> 提取码：digx</li>
<li>《图解机器学习》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/19iRXr96iIRuZ8rDES9U4PQ">百度云链接</a>  提取码：1r22</li>
<li>《推荐系统实践》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1PuD-qC-0_u7eiOOBjHqDoQ">百度云链接</a>  提取码：d7xu</li>
<li>《Scala机器学习》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1VB7oOgxZ9f_CnUnu-uqykA">百度云链接</a>  提取码：wy2c </li>
<li>《Spark+MLlib机器学习实践+_王晓华》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1mFs-AKpGGPa_K70cqG7YBQ">百度云链接</a>    提取码：z6ig </li>
<li>《机器学习(清晰)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1rIqqRtGUESS9_RBCPqbFSg">百度云链接</a>   提取码：6jab </li>
<li>《机器学习常见面试题》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1dqqlwYXf9hTlZJfSLx8JQQ">百度云链接</a>   提取码：wa3t </li>
<li>《Python+Spark 2.0+Hadoop机器学习与大数据实战_林大贵(著)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/14bBsgC-k68Tvg5XYMdxBCw">百度云链接</a>   提取码：1jkd </li>
<li>《Spark MLlib机器学习_黄美灵》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1xInTAnn7UjSw8rhl7A-nIQ">百度云链接</a>   提取码：gk6z </li>
<li>《百面_机器学习 算法工程师带你去面试。清晰版带书签》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1rnEWMpIU1MF1uOvpmNbvqg">百度云链接</a>  提取码：0q1f </li>
<li>《机器学习与R语言》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1eQWUAqLFKiyRkms-xmQ98g">百度云链接</a>    提取码：dj4g </li>
<li>《白话大数据与机器学习》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/16x5sUv1ohAnLBCROUzdcVQ">百度云链接</a>   提取码：ryqa</li>
</ul>
<h5 id="14-2、深度学习"><a href="#14-2、深度学习" class="headerlink" title="14.2、深度学习"></a>14.2、深度学习</h5><ul>
<li>《Deeplearning深度学习笔记最新版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1hwWQh-9hLcKicO9yZuvyEw">百度云链接</a>   提取码：xn7v</li>
<li>《Python深度学习》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1_rpiEWxLRcm769VPmB2K4w">百度云链接</a>  提取码：e2ia</li>
<li>《常用推荐算法（50页干货）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/11392gRCpmKH2oL3m9OKqvg">百度云链接</a>   提取码：o747</li>
<li>《动手学深度学习-李沐》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1zrWff1Rh0nepPIE7QGyfIQ">百度云链接</a>   提取码：xefc</li>
<li>《深度学习(最全的中文版)_2017年新书》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1kKjU_m0Vhv-Fqqn-hpB0CQ">百度云链接</a>   提取码：rjtr</li>
<li>《深度学习500问》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1yprRliW0juvoshwSWru86g">百度云链接</a>   提取码：emzm</li>
<li>《深度学习_中文版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1gGzT91J0tOjv0WyNg36nvQ">百度云链接</a>   提取码：ippy</li>
<li>《深度学习框架》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1DtbfkkbRou4QMbim24q9dA">百度云链接</a>  提取码：sko2</li>
<li>《深度学习入门：基于Python的理论与实现.pdf+代码》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1v_m7KtMMGn-sTkCIpJb8CA">百度云链接</a>  提取码：vub4</li>
<li>《神经网络与深度学习》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1D0Ec7_U97YKrcDWeO6JX3w">百度云链接</a>   提取码：ifjq</li>
<li>《【高扬】白话深度学习姊妹篇、白话大数据与ML》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1oLdFYseNHafAJ6jScmkD9w">百度云链接</a>  提取码：kra4</li>
<li>《Keras》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1-bI-1IZsq_SE4o-ukolPPw">百度云链接</a>    提取码：4d41 </li>
<li>《Keras中文手册》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1lAOWL71hH2pri9K5FjkaKg">百度云链接</a>   提取码：cncz </li>
<li>《Programming-PyTorch-for-Deep-Learning.Creating-》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1pysapPgaxDOl8KRRcqF-8A">百度云链接</a>   提取码：sss5 </li>
<li>《Tensorflow 实战Google深度学习框架（完整版pdf)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1VuvABzDxwGgT4IBHdWLbdg">百度云链接</a>   提取码：pvkt </li>
<li>《TensorFlow斯坦福大学-深度学习基础教程[aibbt.com]》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1L5DFy4qQZK1E5bsec0hRXQ">百度云链接</a>   提取码：5lgw </li>
<li>《TensorFlow 官方文档中文版、v1.2[aibbt.com]》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1e9GHUSghaNLJ3EpymjfJWA">百度云链接</a>   提取码：wkid </li>
<li>《TensorFlow技术解析与实战.李嘉璇》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1CInr-398G303GHqMVPNeOQ">百度云链接</a>   提取码：kw18 </li>
<li>《面向机器智的TensorFlow实践》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1XAF0ya6Ap62rBXuh4h9HOw">百度云链接</a>   提取码：jid6 </li>
<li>《TensorFlow面向机器智能的TensorFlow实践 (智能系统与技术丛书)_[aibbt.com]》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Ba2bEoBqKXLIRWlzTc050A">百度云链接</a>   提取码：a4oa </li>
<li>《TensorFlow实战_黄文坚（完整）[aibbt.com]》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1YMw9Yaik2nlFuWLMhITtmg">百度云链接</a>   提取码：eimo </li>
<li>《新版深度学习》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1jDaJRHeXhZQDeUzgQ_aQPw">百度云链接</a>     提取码：l60i</li>
</ul>
<h5 id="14-3、OpenCv"><a href="#14-3、OpenCv" class="headerlink" title="14.3、OpenCv"></a>14.3、OpenCv</h5><ul>
<li>《OpenCV-Python-Tutorial-中文版20160814》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1TxZM4vtZ5Zu3QzKwWgYMqA">百度云链接</a>   提取码：138m</li>
<li>《学习OpenCV 3 中文版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1SKHzdW7BpyD_RAEtFV-Xug">百度云链接</a>  提取码：1z20</li>
</ul>
<h5 id="14-4、计算机视觉-CV"><a href="#14-4、计算机视觉-CV" class="headerlink" title="14.4、计算机视觉(CV)"></a>14.4、计算机视觉(CV)</h5><ul>
<li>《Computer vision》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/12jPqt6_VMkuDwkV-hGj2uA">百度云链接</a>  提取码：p3la</li>
<li>《Python计算机视觉》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1KFQJGSNvNjVVh2R_7yh6Cw">百度云链接</a>   提取码：d4fk</li>
<li>《图像处理分析与机器视觉(最新版)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1c7qRU3A9K_SfQ_tzJLr8sQ">百度云链接</a>   提取码：ukvz</li>
</ul>
<h5 id="14-5、自然语言处理-NLP"><a href="#14-5、自然语言处理-NLP" class="headerlink" title="14.5、自然语言处理(NLP)"></a>14.5、自然语言处理(NLP)</h5><ul>
<li>《deep_learning_for_nlp》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1dUzKQVHtH-Ty8dJ1Y56G5A">百度云链接</a>   提取码：fhq3</li>
<li>《Embedding Methods for NLP emnlp tutorial》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Pt1zvQSo62EbEKTJ3NobiA">百度云链接</a>  提取码：0bcg</li>
<li>《Python自然语言处理中文翻译 NLTK 中文版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/17aQxPLPcfDk9Ethd4XwcAw">百度云链接</a>   提取码：cew3</li>
<li>《Writing Code for NLP Research-1》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1USq32Brkb9yBGDrHzsTSaw">百度云链接</a>   提取码：vexm</li>
<li>《斯坦福CS224n 自然语言处理与深度学习、笔记 hankcs》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1fHKDrdSGHr3Bh6gWDz7WgQ">百度云链接</a>   提取码：hihe</li>
<li>《语音与语言处理Speech+and+Language+Processing》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1OfGadsMwkKY0gWIUIJlmjQ">百度云链接</a>   提取码：hweq</li>
</ul>
<h4 id="15、设计模式"><a href="#15、设计模式" class="headerlink" title="15、设计模式"></a>15、设计模式</h4><ul>
<li>《大话设计模式》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1iJSWVgqspqviEgHUUqhqDw">百度云链接</a>   提取码：4o24</li>
<li>《HeadFirst设计模式（中文版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1lEz-hfm64QNJrrkx_skyrw">百度云链接</a>  提取码：5c3f</li>
<li>《图解设计模式》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1g8Xa3G4dKL2PZ61XorHGsA">百度云链接</a>   提取码：ih0f</li>
<li>《研磨设计模式》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1NsS6qCLukciKAUs3pmXNqA">百度云链接</a>   提取码：wafq</li>
<li>《常见设计模式解析与实现、C++版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1deQPnnlUzaLOgvTepl0j0A">百度云链接</a>  提取码：3q7d </li>
<li>《敏捷开发-设计模式》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1tLrlJy-XE8P6nIXSEXr7_Q">百度云链接</a>  提取码：h1xq </li>
<li>《head first design patterns》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1d8vBIBlNRve4i00sG7aLkg">百度云链接</a>   提取码：err5</li>
<li>《设计模式之禅（第2版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1h_kDML8qeWMkoVUsMrQ_iQ">百度云链接</a>     提取码：m68r</li>
</ul>
<h4 id="16、汇编语言"><a href="#16、汇编语言" class="headerlink" title="16、汇编语言"></a>16、汇编语言</h4><ul>
<li>《x86汇编语言：从实模式到保护模式_书籍及配套资料》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1d6grZC-PjCR7zGXx4ju6Qw">百度云链接</a> 提取码：ne7j</li>
<li>《汇编语言_王爽及相关资料》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1LVQ9JvZ-ZBAxt8nZL7xVIA">百度云链接</a>  提取码：cx9w</li>
<li>《老“码”识途 从机器码到框架的系统观逆向修炼之路》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1lVUEMXs0Au7CHmHk5zJPkg">百度云链接</a>   提取码：b773</li>
<li>《80x86汇编语言程序设计教程》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/19LBZuTluq6vx9BHXBM7Ehg">百度云链接</a>  提取码：eogv</li>
</ul>
<h4 id="17、Git"><a href="#17、Git" class="headerlink" title="17、Git"></a>17、Git</h4><ul>
<li><p>《Git参考手册-新》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1bIAdpZ41nvjGHuBxlieqZA">百度云链接</a>  提取码：amrb</p>
</li>
<li><p>《从0开始学习GitHub系列》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1bnOGOjwum0P32zijD-3NBA">百度云链接</a>   提取码：uhcw</p>
</li>
<li><p>《专业git中文》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/11K3Csq9O3LH-d7xzRiHHsw">百度云链接</a>    提取码：4q2z</p>
</li>
<li><p>《Git权威指南》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1TZGXb6j2lXOMNcR31FnWAg">百度云链接</a>   提取码：yj4c</p>
</li>
</ul>
<h4 id="18、数学相关"><a href="#18、数学相关" class="headerlink" title="18、数学相关"></a>18、数学相关</h4><ul>
<li>《程序员的数学卷1、清晰版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1I6hyoiiOtM52FTi9MzZMUw">百度云链接</a> 提取码：4ztn </li>
<li>《程序员的数学卷2、概率统计》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1QhvvJxyEiUook7xD4r1cZw">百度云链接</a> 提取码：7o4m </li>
<li>《程序员的数学卷3、线性统计》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1T8xNHZsnfcPgFByRKBUb7Q">百度云链接</a> 提取码：3kq6 </li>
<li>《计算复杂性：现代方法》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1TDVfB4RQKMDriq4dZfNuWg">百度云链接</a>   提取码：yu3m</li>
<li>《离散数学及其应用》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/17e1KX0j5RCNcd8JnWPrNrw">百度云链接</a>  提取码：gcbx</li>
<li>《数学之美》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1IBIViE2Sifx-ANFU12nmPQ">百度云链接</a>   提取码：vxqr</li>
<li>《Computational Complexity_ A Modern Approach》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1-XpRBBfJpv9F40R7wwG0_w">百度云链接</a>  提取码：vq08</li>
<li>《Discrete Mathematics and Its Applications》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Tp-DYhM6CfLflqPDB4BF_g">百度云链接</a>   提取码：fuox</li>
<li>《Operations Research Applications And Algorithms》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/18q6kf2pYT708E9pZoq0HQQ">百度云链接</a>   提取码：lrou</li>
<li>《概率论与数理统计、陈希孺》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1A7eB7YKLSGB-mJwlezPJ0w">百度云链接</a>   提取码：iks9</li>
</ul>
<h4 id="19、程序员软技能"><a href="#19、程序员软技能" class="headerlink" title="19、程序员软技能"></a>19、程序员软技能</h4><ul>
<li><p>《码农翻身：用故事给技术加点料_刘欣》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1dv8jHAhyoyGfpzXJA4747w">百度云链接</a>   提取码：t2di</p>
</li>
<li><p>《奔跑吧，程序员：从零开始打造产品、技术和团队》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1T3851MxuIrbrc4HOqdpuSA">百度云链接</a>  提取码：yx4j</p>
</li>
<li><p>《代码大全2中文版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/13Gajn1_aiBkjoGFcJI1zCA">百度云链接</a>  提取码：0lml</p>
</li>
<li><p>《代码整洁之道》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1CTPGRQkyFGUrwVVnv4d5xg">百度云链接</a>  提取码：3c81</p>
</li>
<li><p>《黑客与画家》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1BaB4TCWothorFJAbZhGLpQ">百度云链接</a>  提取码：1i8c</p>
</li>
<li><p>《浪潮之巅（完整版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1k0J1Fy9GoYieRdxKCU51AA">百度云链接</a>  提取码：ikcl</p>
</li>
<li><p>《敏捷软件开发：原则、模式与实践》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1o9ECMcIF0gML_9qk7c1cgQ">百度云链接</a> 提取码：sw72</p>
</li>
<li><p>《重构：改善既有代码的设计（第2版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1FnB3MeuYTZSfK6ITUc7pjg">百度云链接</a>   提取码：kbup</p>
</li>
<li><p>《how-to-be-a-programmer-cn》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Qm4cFNZBz0rs_qaLzXwmbA">百度云链接</a>    提取码：ns57 </p>
</li>
<li><p>《华为大数据应用开发指南》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/123YjmqnOvwF4nfPTbpFLIQ">百度云链接</a>   提取码：2snr </p>
</li>
<li><p>《华为金融大数据解决方案汇报V2.0》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1a55192jVn0WInbaBnD82bg">百度云链接</a>   提取码：s9zi </p>
</li>
<li><p>《人月神话-中文-目录-文字版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/12OGlEZJ31DTbX2Lk-NvnmQ">百度云链接</a>    提取码：vumo </p>
</li>
<li><p>《孙金城丨阿里巴巴-Blink SQL关键技术及实现原理》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1aJ7dprgQWSH7AXY00TdfvA">百度云链接</a>    提取码：6mjd </p>
</li>
<li><p>《程序员健康指南》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1aA2yIW75siSOtatLGGw4sQ">百度云链接</a>     提取码：0bxr </p>
</li>
<li><p>《概念与技术（第3版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/18GAz4RnQYfxrL6Aq2PtDUQ">百度云链接</a>   提取码：oolp </p>
</li>
<li><p>《技术之瞳+阿里巴巴技术笔试心得》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1z1OwnM4Kw4-0VUfZK8CyfQ">百度云链接</a>    提取码：978f </p>
</li>
<li><p>《阿里双十一技术》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1DGBivuWJUx-4PQrHVQOv0Q">百度云链接</a>    提取码：y5dd </p>
</li>
<li><p>《程序开发心理学》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1vrFohI0hY7707-oKW_SlIA">百度云链接</a>    提取码：1a20 </p>
</li>
<li><p>《大数据之路：阿里巴巴大数据实践》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1vnF2Wp4VsnN_JhccwXEqhw">百度云链接</a>   提取码：8uvo </p>
</li>
<li><p>《软件工程-实践者的研究方法.8th》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/18u_2S118ZPPDHOBiE__p_A">百度云链接</a>    提取码：qb99</p>
</li>
</ul>
<h4 id="20、其余资料"><a href="#20、其余资料" class="headerlink" title="20、其余资料"></a>20、其余资料</h4><ul>
<li><p>《精通正则表达式》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1pTI1QLL1dZ3vPpI8qJXwEw">百度云链接</a> 提取码：4xum</p>
</li>
<li><p>《深入浅出谈CUDA》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1O6K0diUw2QqDKbyF-XmfOA">百度云链接</a>  提取码：rnzq</p>
</li>
<li><p>《数字信号处理教程  第3版 by 程佩青 (z-lib.org)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1gZV5-KpENoByu_w2N1fBYA">百度云链接</a>  提取码：qn5b</p>
</li>
<li><p>《微服务设计中文完整版》<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/119YoewAQZF_ttx_vOI3CZg">百度云链接</a>  提取码：7qp6 </p>
</li>
<li><p>《kotlin-for-android-developers-zh》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1RdKFNdfuPTOAjB_2JnlrNw">百度云链接</a>    提取码：numu </p>
</li>
<li><p>《kotlin-in-chinese》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1NPzDqDetR1CQeXER-q56Vw">百度云链接</a>    提取码：cf9o </p>
</li>
<li><p>《Kubernetes权威指南第2版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/17JthYP4j6mXY3MMmgwT7CQ">百度云链接</a>    提取码：lke6 </p>
</li>
<li><p>《progit2》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1X9CkC47MkWRGIG71YVa1yg">百度云链接</a>     提取码：edtb </p>
</li>
<li><p>《区块链+将如何重新定义世界》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1qDF2wDsgG9y8ectMTZwXKw">百度云链接</a>    提取码：twnt </p>
</li>
<li><p>《数字图像处理第二版中文版（冈萨雷斯）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1QX8yDgtc8uYjJxPDqPYWJw">百度云链接</a>     提取码：40t2 </p>
</li>
<li><p>《图像工程(第二版)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1fZcLOzVx36PfRsp2-9xgIQ">百度云链接</a>   提取码：8iom </p>
</li>
<li><p>《时间序列分析及应用：R语言（原书第2版）》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1p-FBC2u5HBN8dmMjnXcVzg">百度云链接</a>    提取码：sc0q </p>
</li>
<li><p>《特征提取与图像处理(第二版)》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1i5GSIRl8vP_tPx-JDphx3A">百度云链接</a>     提取码：baid </p>
</li>
<li><p>《Unity3D／2D游戏开发从0到1》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Xr1i8f4Hgaog4Cqypv81vw">百度云链接</a>    提取码：5tih </p>
</li>
<li><p>《第一本Docker书》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1DAKip2_QjnGkp1yH5O0phQ">百度云链接</a>    提取码：v781 </p>
</li>
<li><p>《精通比特幣》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1-I-1ZUUTzNBeJAM8zlEUNw">百度云链接</a>    提取码：yn8l </p>
</li>
<li><p>《计算机图形学  第4版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1mZ4_exUMEcch06TlddhSAQ">百度云链接</a>   提取码：6qbr </p>
</li>
<li><p>《数据挖掘、推理与预测》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1HJuM_CXoTB3LsC83smeU3g">百度云链接</a>    提取码：5fv5</p>
</li>
</ul>
<h4 id="21、社招校招汇总"><a href="#21、社招校招汇总" class="headerlink" title="21、社招校招汇总"></a>21、社招校招汇总</h4><ul>
<li><p>《阿秀的学习笔记》-校招使用，<a target="_blank" rel="noopener" href="https://interviewguide.cn/">点此直达</a></p>
</li>
<li><p>《计算机校招直播视频、2021.02.25晚视频号录播》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1QLDmX1O7QZNWjb2Rr9Pxuw">百度云链接</a>  提取码：w0ez </p>
</li>
<li><p>《C++面经总结》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1XHPpDHZsRDanLnZGUuEHmQ">百度云链接</a>   提取码：esr8 </p>
</li>
<li><p>《牛客网Java校招题库PDF版》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/13vXyf6onhnvqBTyx3ocBNg">百度云链接</a>    ：提取码：kgl6  </p>
</li>
<li><p>《Java大厂面试总结》  <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/14xD_nZ2rb64LG1_ZZSOyQA">百度云链接</a>   提取码：4bn1 </p>
</li>
<li><p>《C++面经、牛客大佬总结的涉及C++ 操作系统 计算机网络 数据库等知识点》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1oT9oIgPvXDEG01LaNbOU_g">百度云链接</a>  提取码：czbh </p>
</li>
<li><p>《程序员面试宝典》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1pikO4SHPCMFlvd-xF_B_2A">百度云链接</a>  提取码：gm2t</p>
</li>
<li><p>《机器学习 算法工程师带你去面试》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Y9eDhh-B3qgKFeUTTKm23Q">百度云链接</a>  提取码：n7pm</p>
</li>
<li><p>《机器学习常见面试题》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1QzdmIUt8B_7GXR1WFN4aqw">百度云链接</a>  提取码：i9yw</p>
</li>
<li><p>《招聘笔记》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ZG3pUJP9s2LTouZIgabh4A">百度云链接</a>  提取码：q48f</p>
</li>
<li><p>《校招求职分享直播PPT、分享人：拱白菜的阿秀》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1j8KpU6tETcVrMWDYcfPIeQ">百度云链接</a>  提取码：wnh8 </p>
</li>
<li><p>《牛客网SQL练习题全解析》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1wiqqET6I9Nqu4yvGuGzv2w">百度云链接</a>  提取码：olgp </p>
</li>
<li><p>《2018最新BAT python面试题》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1nBrDlLuHhSTN5dQN_qwgjA">百度云链接</a>   提取码：96cx </p>
</li>
<li><p>《Java程序员面试宝典》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1TGTIYMTiT1Fx7J5AFVniUA">百度云链接</a>    提取码：ah1m </p>
</li>
<li><p>《Java面试突击-V3.0》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/15DFE4I7kH9U574-6sYyfYw">百度云链接</a>   提取码：0q4h </p>
</li>
<li><p>《阿里Java面试问题大全》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1O91SA7-OZTitu8aCUZuwWg">百度云链接</a>    提取码：amr8 </p>
</li>
<li><p>《牛客网IT名企2016笔试真题+答案》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1rgQJHdJIwxUe_5iJNl54Xw">百度云链接</a>    提取码：nm5z</p>
</li>
</ul>
<h4 id="22、我建议你下载，以后肯定用得上"><a href="#22、我建议你下载，以后肯定用得上" class="headerlink" title="22、我建议你下载，以后肯定用得上"></a>22、我建议你下载，以后肯定用得上</h4><ul>
<li>《城市新青年：美团外卖骑手就业报告》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1P2VV4CwKPKpxV6myjtJ_Hg">百度云链接</a>   提取码：i8y5 </li>
<li>《活着、余华》  <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Pk6yeTM2nUgHUM5ji2Gn4Q">百度云链接</a>  提取码：29s4 </li>
<li>《许三观卖血记、余华》 <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1xILsVtG29ByWpFcKYvdTsw">百度云链接</a>  提取码: ukmj </li>
<li>《平凡的世界、路遥》  <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1hNPgA3YlllyEuc-fBw2lhg">百度云链接</a>  提取码：vaa6</li>
</ul>
<hr>
<h4 id="免责声明"><a href="#免责声明" class="headerlink" title="免责声明"></a>免责声明</h4><p>本仓库书籍链接全部来源于网络其他人的整理的链接，个人只是搜录整理他人成果。</p>
<p>如有疑问请提交<strong>issue</strong>，有<strong>违规侵权</strong>，请联系本人 <strong><a href="mailto:&#x63;&#x6f;&#x64;&#x65;&#x72;&#97;&#120;&#x69;&#x75;&#x40;&#49;&#54;&#x33;&#x2e;&#99;&#111;&#x6d;">&#x63;&#x6f;&#x64;&#x65;&#x72;&#97;&#120;&#x69;&#x75;&#x40;&#49;&#54;&#x33;&#x2e;&#99;&#111;&#x6d;</a></strong> ，本人立马删除相应链接，感谢！</p>
<p>本仓库仅作学习交流分享使用，不作任何商用。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/10/29/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/cnn_captcha/">卷积神经网络实现图片验证码</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-10-30</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/">神经网络</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/">神经网络</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/cnn/">cnn</a></span><div class="content"><h1 id="cnn-captcha"><a href="#cnn-captcha" class="headerlink" title="cnn_captcha"></a>cnn_captcha</h1><p>use CNN recognize captcha by tensorflow.<br>本项目针对字符型图片验证码，使用tensorflow实现卷积神经网络，进行验证码识别。<br>项目封装了比较通用的<strong>校验、训练、验证、识别、API模块</strong>，极大的减少了识别字符型验证码花费的时间和精力。 </p>
<p>项目已经帮助很多同学高效完成了验证码识别任务。<br>如果你在使用过程中出现了bug和做了良好的改进，欢迎提出issue和PR，作者会尽快回复，希望能和你共同完善项目。 </p>
<p>如果你需要识别点选、拖拽类验证码，或者有目标检测需求，也可以参考这个项目<a target="_blank" rel="noopener" href="https://github.com/nickliqian/darknet_captcha">nickliqian&#x2F;darknet_captcha</a>。</p>
<h1 id="时间表"><a href="#时间表" class="headerlink" title="时间表"></a>时间表</h1><h4 id="2018-11-12"><a href="#2018-11-12" class="headerlink" title="2018.11.12"></a>2018.11.12</h4><p>初版Readme.md  </p>
<h4 id="2018-11-21"><a href="#2018-11-21" class="headerlink" title="2018.11.21"></a>2018.11.21</h4><p>加入关于验证码识别的一些说明  </p>
<h4 id="2018-11-24"><a href="#2018-11-24" class="headerlink" title="2018.11.24"></a>2018.11.24</h4><p>优化校验数据集图片的规则  </p>
<h4 id="2018-11-26"><a href="#2018-11-26" class="headerlink" title="2018.11.26"></a>2018.11.26</h4><p>新增<code>train_model_v2.py</code>文件，训练过程中同时输出训练集和验证集的准确率  </p>
<h4 id="2018-12-06"><a href="#2018-12-06" class="headerlink" title="2018.12.06"></a>2018.12.06</h4><p>新增多模型部署支持，修复若干bug  </p>
<h4 id="2018-12-08"><a href="#2018-12-08" class="headerlink" title="2018.12.08"></a>2018.12.08</h4><p>优化模型识别速度，支持api压力测试和统计耗时  </p>
<h4 id="2019-02-19"><a href="#2019-02-19" class="headerlink" title="2019.02.19"></a>2019.02.19</h4><ol>
<li>新增一种准确率计算方式    </li>
<li>TAG: v1.0</li>
</ol>
<h4 id="2019-04-12"><a href="#2019-04-12" class="headerlink" title="2019.04.12"></a>2019.04.12</h4><ol>
<li>只保留一种<code>train_model.py</code>文件</li>
<li>优化代码结构</li>
<li>把通用配置抽取到<code>sample_config.json</code>和<code>captcha_config.json</code></li>
<li>修复若干大家在issue提出的问题</li>
</ol>
<h4 id="2019-06-01"><a href="#2019-06-01" class="headerlink" title="2019.06.01"></a>2019.06.01</h4><ol>
<li>完善readme文档，文档不长，请大家一定要读完~</li>
<li>使用cnnlib目录存放神经网络结构代码</li>
<li>做了一版训练数据统计，大家可以参考我们的训练次数、时长和准确率</li>
<li>TAG: v2.0</li>
</ol>
<h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><p>[toc]</p>
<h1 id="1-项目介绍"><a href="#1-项目介绍" class="headerlink" title="1 项目介绍"></a>1 项目介绍</h1><h2 id="1-1-关于验证码识别"><a href="#1-1-关于验证码识别" class="headerlink" title="1.1 关于验证码识别"></a>1.1 关于验证码识别</h2><p>验证码识别大多是爬虫会遇到的问题，也可以作为图像识别的入门案例。目前通常使用如下几种方法：  </p>
<table>
<thead>
<tr>
<th>方法名称</th>
<th>相关要点</th>
</tr>
</thead>
<tbody><tr>
<td>tesseract</td>
<td>仅适合识别没有干扰和扭曲的图片，训练起来很麻烦</td>
</tr>
<tr>
<td>其他开源识别库</td>
<td>不够通用，识别率未知</td>
</tr>
<tr>
<td>付费OCR API</td>
<td>需求量大的情形成本很高</td>
</tr>
<tr>
<td>图像处理+机器学习分类算法</td>
<td>涉及多种技术，学习成本高，且不通用</td>
</tr>
<tr>
<td>卷积神经网络</td>
<td>一定的学习成本，算法适用于多类验证码</td>
</tr>
</tbody></table>
<p>这里说一下使用传统的<strong>图像处理和机器学习算法</strong>，涉及多种技术：  </p>
<ol>
<li>图像处理</li>
</ol>
<ul>
<li>前处理（灰度化、二值化）</li>
<li>图像分割</li>
<li>裁剪（去边框）</li>
<li>图像滤波、降噪</li>
<li>去背景</li>
<li>颜色分离</li>
<li>旋转</li>
</ul>
<ol start="2">
<li>机器学习</li>
</ol>
<ul>
<li>KNN</li>
<li>SVM</li>
</ul>
<p>使用这类方法对使用者的要求较高，且由于图片的变化类型较多，处理的方法不够通用，经常花费很多时间去调整处理步骤和相关算法。<br>而使用<strong>卷积神经网络</strong>，只需要通过简单的前处理，就可以实现大部分静态字符型验证码的端到端识别，效果很好，通用性很高。  </p>
<p>这里列出目前<strong>常用的验证码</strong>生成库：</p>
<blockquote>
<p>参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/cynchanpin/p/6912301.html">Java验证全家桶</a>  </p>
</blockquote>
<table>
<thead>
<tr>
<th>语言</th>
<th>验证码库名称</th>
<th>链接</th>
<th>样例</th>
</tr>
</thead>
<tbody><tr>
<td>Java</td>
<td>JCaptcha</td>
<td><a target="_blank" rel="noopener" href="https://jcaptcha.atlassian.net/wiki/spaces/general/pages/1212427/Samples+tests">示例</a></td>
<td><img src="/./readme_image/jcaptcha1.jpg" alt="效果1"> <img src="/./readme_image/jcaptcha2.jpg" alt="效果2"> <img src="/./readme_image/jcaptcha3.jpg" alt="效果3"></td>
</tr>
<tr>
<td>Java</td>
<td>JCaptcha4Struts2</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Java</td>
<td>SimpleCaptcha</td>
<td><a target="_blank" rel="noopener" href="https://www.oschina.net/p/simplecaptcha">例子</a></td>
<td><img src="/./readme_image/SimpleCaptcha_1.jpg" alt="效果1"> <img src="/./readme_image/SimpleCaptcha_2.jpg" alt="效果2"> <img src="/./readme_image/SimpleCaptcha_3.jpg" alt="效果3"></td>
</tr>
<tr>
<td>Java</td>
<td>kaptcha</td>
<td><a target="_blank" rel="noopener" href="https://github.com/linghushaoxia/kaptcha">例子</a></td>
<td><img src="/./readme_image/Kaptcha_5.png" alt="水纹效果"> <img src="/./readme_image/Kaptcha_2.png" alt="鱼眼效果"> <img src="/./readme_image/Kaptcha_3.png" alt="阴影效果"></td>
</tr>
<tr>
<td>Java</td>
<td>patchca</td>
<td></td>
<td><img src="/./readme_image/patchca_1.png" alt="效果1"></td>
</tr>
<tr>
<td>Java</td>
<td>imageRandom</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Java</td>
<td>iCaptcha</td>
<td></td>
<td><img src="/./readme_image/iCaptcha.jpg" alt="效果1"></td>
</tr>
<tr>
<td>Java</td>
<td>SkewPassImage</td>
<td></td>
<td><img src="/./readme_image/SkewPassImage.jpg" alt="效果1"></td>
</tr>
<tr>
<td>Java</td>
<td>Cage</td>
<td></td>
<td><img src="/./readme_image/Cage1.jpg" alt="效果1"> <img src="/./readme_image/Cage2.jpg" alt="效果2"></td>
</tr>
<tr>
<td>Python</td>
<td>captcha</td>
<td><a target="_blank" rel="noopener" href="https://github.com/nickliqian/cnn_captcha/blob/master/gen_image/gen_sample_by_captcha.py">例子</a></td>
<td><img src="/./readme_image/py_Captcha-1.jpg" alt="py_Captcha"></td>
</tr>
<tr>
<td>Python</td>
<td>pycapt</td>
<td><a target="_blank" rel="noopener" href="https://github.com/aboutmydreams/pycapt">例子</a></td>
<td><img src="https://github.com/aboutmydreams/pycapt/raw/master/img/do4.png" alt="pycapt"></td>
</tr>
<tr>
<td>PHP</td>
<td>Gregwar&#x2F;Captcha</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Gregwar/Captcha">文档</a></td>
<td></td>
</tr>
<tr>
<td>PHP</td>
<td>mewebstudio&#x2F;captcha</td>
<td><a target="_blank" rel="noopener" href="https://github.com/mewebstudio/captcha">文档</a></td>
<td></td>
</tr>
</tbody></table>
<h2 id="1-2-目录结构"><a href="#1-2-目录结构" class="headerlink" title="1.2 目录结构"></a>1.2 目录结构</h2><h3 id="1-2-1-基本配置"><a href="#1-2-1-基本配置" class="headerlink" title="1.2.1 基本配置"></a>1.2.1 基本配置</h3><table>
<thead>
<tr>
<th>序号</th>
<th>文件名称</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td><code>conf/</code></td>
<td>配置文件目录</td>
</tr>
<tr>
<td>2</td>
<td><code>sample/</code></td>
<td>数据集目录</td>
</tr>
<tr>
<td>3</td>
<td><code>model/</code></td>
<td>模型文件目录</td>
</tr>
<tr>
<td>4</td>
<td><code>cnnlib/</code></td>
<td>封装CNN的相关代码目录</td>
</tr>
</tbody></table>
<h3 id="1-2-2-训练模型"><a href="#1-2-2-训练模型" class="headerlink" title="1.2.2 训练模型"></a>1.2.2 训练模型</h3><table>
<thead>
<tr>
<th>序号</th>
<th>文件名称</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>verify_and_split_data.py</td>
<td>验证数据集、拆分数据为训练集和测试集</td>
</tr>
<tr>
<td>2</td>
<td>network.py</td>
<td>cnn网络基类</td>
</tr>
<tr>
<td>3</td>
<td>train_model.py</td>
<td>训练模型</td>
</tr>
<tr>
<td>4</td>
<td>test_batch.py</td>
<td>批量验证</td>
</tr>
<tr>
<td>5</td>
<td>gen_image&#x2F;gen_sample_by_captcha.py</td>
<td>生成验证码的脚本</td>
</tr>
<tr>
<td>6</td>
<td>gen_image&#x2F;collect_labels.py</td>
<td>用于统计验证码标签（常用于中文验证码）</td>
</tr>
</tbody></table>
<h3 id="1-2-3-web接口"><a href="#1-2-3-web接口" class="headerlink" title="1.2.3 web接口"></a>1.2.3 web接口</h3><table>
<thead>
<tr>
<th>序号</th>
<th>文件名称</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>webserver_captcha_image.py</td>
<td>获取验证码接口</td>
</tr>
<tr>
<td>2</td>
<td>webserver_recognize_api.py</td>
<td>提供在线识别验证码接口</td>
</tr>
<tr>
<td>3</td>
<td>recognize_online.py</td>
<td>使用接口识别的例子</td>
</tr>
<tr>
<td>4</td>
<td>recognize_local.py</td>
<td>测试本地图片的例子</td>
</tr>
<tr>
<td>5</td>
<td>recognize_time_test.py</td>
<td>压力测试识别耗时和请求响应耗时</td>
</tr>
</tbody></table>
<h2 id="1-3-依赖"><a href="#1-3-依赖" class="headerlink" title="1.3 依赖"></a>1.3 依赖</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure>
<p>注意：如果需要使用GPU进行训练，请把文件中的tenforflow修改为tensorflow-gpu</p>
<h2 id="1-4-模型结构"><a href="#1-4-模型结构" class="headerlink" title="1.4 模型结构"></a>1.4 模型结构</h2><table>
<thead>
<tr>
<th align="center">序号</th>
<th align="center">层级</th>
</tr>
</thead>
<tbody><tr>
<td align="center">输入</td>
<td align="center">input</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">卷积层 + 池化层 + 降采样层 + ReLU</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">卷积层 + 池化层 + 降采样层 + ReLU</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">卷积层 + 池化层 + 降采样层 + ReLU</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">全连接 + 降采样层 + Relu</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">全连接 + softmax</td>
</tr>
<tr>
<td align="center">输出</td>
<td align="center">output</td>
</tr>
</tbody></table>
<h1 id="2-如何使用"><a href="#2-如何使用" class="headerlink" title="2 如何使用"></a>2 如何使用</h1><h2 id="2-1-数据集"><a href="#2-1-数据集" class="headerlink" title="2.1 数据集"></a>2.1 数据集</h2><p>原始数据集可以存放在<code>./sample/origin</code>目录中。<br>为了便于处理，图片最好以<code>2e8j_17322d3d4226f0b5c5a71d797d2ba7f7.jpg</code>格式命名（标签_序列号.后缀）。 </p>
<p>如果你没有训练集，你可以使用<code>gen_sample_by_captcha.py</code>文件生成训练集文件。<br>生成之前你需要修改相关配置<code>conf/captcha_config.json</code>（路径、文件后缀、字符集等）。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;root_dir&quot;: &quot;sample/origin/&quot;,  # 验证码保存路径</span><br><span class="line">  &quot;image_suffix&quot;: &quot;png&quot;,         # 验证码图片后缀</span><br><span class="line">  &quot;characters&quot;: &quot;0123456789&quot;,    # 生成验证码的可选字符</span><br><span class="line">  &quot;count&quot;: 1000,                 # 生成验证码的图片数量</span><br><span class="line">  &quot;char_count&quot;: 4,               # 每张验证码图片上的字符数量</span><br><span class="line">  &quot;width&quot;: 100,                  # 图片宽度</span><br><span class="line">  &quot;height&quot;: 60                   # 图片高度</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-2-配置文件"><a href="#2-2-配置文件" class="headerlink" title="2.2 配置文件"></a>2.2 配置文件</h2><p>创建一个新项目前，需要自行<strong>修改相关配置文件</strong><code>conf/sample_config.json</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;origin_image_dir&quot;: &quot;sample/origin/&quot;,  # 原始文件</span><br><span class="line">  &quot;new_image_dir&quot;: &quot;sample/new_train/&quot;,  # 新的训练样本</span><br><span class="line">  &quot;train_image_dir&quot;: &quot;sample/train/&quot;,    # 训练集</span><br><span class="line">  &quot;test_image_dir&quot;: &quot;sample/test/&quot;,      # 测试集</span><br><span class="line">  &quot;api_image_dir&quot;: &quot;sample/api/&quot;,        # api接收的图片储存路径</span><br><span class="line">  &quot;online_image_dir&quot;: &quot;sample/online/&quot;,  # 从验证码url获取的图片的储存路径</span><br><span class="line">  &quot;local_image_dir&quot;: &quot;sample/local/&quot;,    # 本地保存图片的路径</span><br><span class="line">  &quot;model_save_dir&quot;: &quot;model/&quot;,            # 从验证码url获取的图片的储存路径</span><br><span class="line">  &quot;image_width&quot;: 100,                    # 图片宽度</span><br><span class="line">  &quot;image_height&quot;: 60,                    # 图片高度</span><br><span class="line">  &quot;max_captcha&quot;: 4,                      # 验证码字符个数</span><br><span class="line">  &quot;image_suffix&quot;: &quot;png&quot;,                 # 图片文件后缀</span><br><span class="line">  &quot;char_set&quot;: &quot;0123456789abcdefghijklmnopqrstuvwxyz&quot;,  # 验证码识别结果类别</span><br><span class="line">  &quot;use_labels_json_file&quot;: false,                       # 是否开启读取`labels.json`内容</span><br><span class="line">  &quot;remote_url&quot;: &quot;http://127.0.0.1:6100/captcha/&quot;,      # 验证码远程获取地址</span><br><span class="line">  &quot;cycle_stop&quot;: 3000,                                  # 启动任务后的训练指定次数后停止</span><br><span class="line">  &quot;acc_stop&quot;: 0.99,                                    # 训练到指定准确率后停止</span><br><span class="line">  &quot;cycle_save&quot;: 500,                                   # 训练指定次数后定时保存模型</span><br><span class="line">  &quot;enable_gpu&quot;: 0,                                     # 是否开启GUP训练</span><br><span class="line">  &quot;train_batch_size&quot;: 128,                             # 训练时每次使用的图片张数，如果CPU或者GPU内存太小可以减少这个参数</span><br><span class="line">  &quot;test_batch_size&quot;: 100                               # 每批次测试时验证的图片张数，不要超过验证码集的总数</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>关于<code>验证码识别结果类别</code>，假设你的样本是中文验证码，你可以使用<code>tools/collect_labels.py</code>脚本进行标签的统计。<br>会生成文件<code>gen_image/labels.json</code>存放所有标签，在配置文件中设置<code>use_labels_json_file = True</code>开启读取<code>labels.json</code>内容作为<code>结果类别</code>。</p>
<h2 id="2-3-验证和拆分数据集"><a href="#2-3-验证和拆分数据集" class="headerlink" title="2.3 验证和拆分数据集"></a>2.3 验证和拆分数据集</h2><p>此功能会校验原始图片集的尺寸和测试图片是否能打开，并按照19:1的比例拆分出训练集和测试集。<br>所以需要分别创建和指定三个文件夹：origin，train，test用于存放相关文件。</p>
<p>也可以修改为不同的目录，但是最好修改为绝对路径。<br>文件夹创建好之后，执行以下命令即可：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 verify_and_split_data.py</span><br></pre></td></tr></table></figure>
<p>一般会有类似下面的提示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; 开始校验目录：[sample/origin/]</span><br><span class="line">开始校验原始图片集</span><br><span class="line">原始集共有图片: 1001张</span><br><span class="line">====以下1张图片有异常====</span><br><span class="line">[第0张图片] [.DStore] [文件后缀不正确]</span><br><span class="line">========end</span><br><span class="line">开始分离原始图片集为：测试集（5%）和训练集（95%）</span><br><span class="line">共分配1000张图片到训练集和测试集，其中1张为异常留在原始目录</span><br><span class="line">测试集数量为：50</span><br><span class="line">训练集数量为：950</span><br><span class="line">&gt;&gt;&gt; 开始校验目录：[sample/new_train/]</span><br><span class="line">【警告】找不到目录sample/new_train/，即将创建</span><br><span class="line">开始校验原始图片集</span><br><span class="line">原始集共有图片: 0张</span><br><span class="line">====以下0张图片有异常====</span><br><span class="line">未发现异常（共 0 张图片）</span><br><span class="line">========end</span><br><span class="line">开始分离原始图片集为：测试集（5%）和训练集（95%）</span><br><span class="line">共分配0张图片到训练集和测试集，其中0张为异常留在原始目录</span><br><span class="line">测试集数量为：0</span><br><span class="line">训练集数量为：0</span><br></pre></td></tr></table></figure>
<p>程序会同时校验和分割<code>origin_image_dir</code>和<code>new_image_dir</code>两个目录中的图片；后续有了更多的样本，可以把样本放在<code>new_image_dir</code>目录中再次执行<code>verify_and_split_data</code>。<br>程序会把无效的文件留在原文件夹。  </p>
<p>此外，当你有新的样本需要一起训练，可以放在<code>sample/new</code>目录下，再次运行<code>python3 verify_and_split_data.py</code>即可。<br>需要注意的是，如果新的样本中有新增的标签，你需要把新的标签增加到<code>char_set</code>配置中或者<code>labels.json</code>文件中。 </p>
<h2 id="2-4-训练模型"><a href="#2-4-训练模型" class="headerlink" title="2.4 训练模型"></a>2.4 训练模型</h2><p>创建好训练集和测试集之后，就可以开始训练模型了。<br>训练的过程中会输出日志，日志展示当前的训练轮数、准确率和loss。<br><strong>此时的准确率是训练集图片的准确率，代表训练集的图片识别情况</strong><br>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">第10次训练 &gt;&gt;&gt; </span><br><span class="line">[训练集] 字符准确率为 0.03000 图片准确率为 0.00000 &gt;&gt;&gt; loss 0.1698757857</span><br><span class="line">[验证集] 字符准确率为 0.04000 图片准确率为 0.00000 &gt;&gt;&gt; loss 0.1698757857</span><br></pre></td></tr></table></figure>
<p>字符准确率和图片准确率的解释：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">假设：有100张图片，每张图片四个字符，共400个字符。我们这里把任务拆分为为需要识别400个字符</span><br><span class="line">字符准确率：识别400的字符中，正确字符的占比。</span><br><span class="line">图片准确率：100张图片中，4个字符完全识别准确的图片占比。</span><br></pre></td></tr></table></figure>
<p>这里不具体介绍tensorflow安装相关问题，直奔主题。<br>确保图片相关参数和目录设置正确后，执行以下命令开始训练：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 train_model.py</span><br></pre></td></tr></table></figure>
<p>也可以根据<code>train_model.py</code>的<code>main</code>函数中的代码调用类开始训练或执行一次简单的识别演示。  </p>
<p>由于训练集中常常不包含所有的样本特征，所以会出现训练集准确率是100%而测试集准确率不足100%的情况，此时提升准确率的一个解决方案是增加正确标记后的负样本。</p>
<h2 id="2-5-批量验证"><a href="#2-5-批量验证" class="headerlink" title="2.5 批量验证"></a>2.5 批量验证</h2><p>使用测试集的图片进行验证，输出准确率。  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 test_batch.py</span><br></pre></td></tr></table></figure>
<p>同样可以根据<code>main</code>函数中的代码调用类开始验证。</p>
<h2 id="2-6-启动WebServer"><a href="#2-6-启动WebServer" class="headerlink" title="2.6 启动WebServer"></a>2.6 启动WebServer</h2><p>项目已经封装好加载模型和识别图片的类，启动<code>web server</code>后调用接口就可以使用识别服务。<br>启动<code>web server</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 webserver_recognize_api.py</span><br></pre></td></tr></table></figure>
<p>接口url为<code>http://127.0.0.1:6000/b</code></p>
<h2 id="2-7-调用接口识别"><a href="#2-7-调用接口识别" class="headerlink" title="2.7 调用接口识别"></a>2.7 调用接口识别</h2><p>使用requests调用接口:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">url = &quot;http://127.0.0.1:6000/b&quot;</span><br><span class="line">files = &#123;&#x27;image_file&#x27;: (image_file_name, open(&#x27;captcha.jpg&#x27;, &#x27;rb&#x27;), &#x27;application&#x27;)&#125;</span><br><span class="line">r = requests.post(url=url, files=files)</span><br></pre></td></tr></table></figure>
<p>返回的结果是一个json：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &#x27;time&#x27;: &#x27;1542017705.9152594&#x27;,</span><br><span class="line">    &#x27;value&#x27;: &#x27;jsp1&#x27;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>文件<code>recognize_local.py</code>是使用接口识别本地的例子，这个例子运行成功，那么识别验证码的一套流程基本上是走了一遍了。<br>在线识别验证码是显示中常用场景，文件<code>recognize_online.py</code>是使用接口在线识别的例子，参见：<code>## 2.11 在线识别</code>。</p>
<h2 id="2-8-部署"><a href="#2-8-部署" class="headerlink" title="2.8 部署"></a>2.8 部署</h2><p>部署的时候，把<code>webserver_recognize_api.py</code>文件的最后一行修改为如下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.run(host=&#x27;0.0.0.0&#x27;,port=5000,debug=False)</span><br></pre></td></tr></table></figure>
<p>然后开启端口访问权限，就可以通过外网访问了。<br>另外为了开启多进程处理请求，可以使用uwsgi+nginx组合进行部署。<br>这部分可以参考：<a target="_blank" rel="noopener" href="http://docs.jinkan.org/docs/flask/deploying/index.html">Flask部署选择</a></p>
<h2 id="2-9-部署多个模型"><a href="#2-9-部署多个模型" class="headerlink" title="2.9 部署多个模型"></a>2.9 部署多个模型</h2><p>部署多个模型:<br>在<code>webserver_recognize_api.py</code>文件汇总，新建一个Recognizer对象；<br>并参照原有<code>up_image</code>函数编写的路由和识别逻辑。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Q = Recognizer(image_height, image_width, max_captcha, char_set, model_save_dir)</span><br></pre></td></tr></table></figure>
<p>注意修改这一行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">value = Q.rec_image(img)</span><br></pre></td></tr></table></figure>

<h2 id="2-10-在线识别"><a href="#2-10-在线识别" class="headerlink" title="2.10 在线识别"></a>2.10 在线识别</h2><p>在线识别验证码是显示中常用场景，即实时获取目标验证码来调用接口进行识别。<br>为了测试的完整性，这里搭建了一个验证码获取接口，通过执行下面的命令启动：  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python webserver_captcha_image.py</span><br></pre></td></tr></table></figure>
<p>启动后通过访问此地址：<code>http://127.0.0.1:6100/captcha/</code>可以接收到验证码图片的二进制流文件。<br>具体进行在线识别任务的demo参见：<code>recognize_online.py</code>。  </p>
<h1 id="3-数据统计"><a href="#3-数据统计" class="headerlink" title="3 数据统计"></a>3 数据统计</h1><h2 id="3-1-训练数据统计"><a href="#3-1-训练数据统计" class="headerlink" title="3.1 训练数据统计"></a>3.1 训练数据统计</h2><p>由于很多同学提出，“需要训练多久呀？”、“准确率可以达到多少？”、“为什么我的准确率一直是0？”类似的疑问。<br>这一小节，使用默认配置（2019.06.02），把训练过程中的数据做了统计，给大家做一个展示。<br>本次测试条件如下：</p>
<ul>
<li>验证码：本项目自带生成验证码程序，数字+小写英文</li>
<li>数量：20000张</li>
<li>计算引擎：GPU</li>
<li>GPU型号：笔记本，GTX 950X 2G显卡</li>
</ul>
<p>经过测试：<br>5000次，25分钟，<strong>训练集</strong>字符准确率84%，图片准确率51%；<br>9190次，46分钟，<strong>训练集</strong>字符准确率100%，图片准确率100%；<br>12000，60分钟，<strong>测试集</strong>的准确率基本上已经跑不动了。  </p>
<p>使用<code>test_batch.py</code>测试，日志如下：  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">100个样本识别耗时6.513171672821045秒，准确率37.0%</span><br></pre></td></tr></table></figure>
<p>有37%的准确率，可以说是识别成功的第一步了。  </p>
<p>曲线图如下：<br>训练集-<br><img src="/readme_image/train_acc.png" alt="train_acc"> </p>
<p>测试集-<br><img src="/readme_image/test_acc.png" alt="test_acc">  </p>
<h2 id="3-2-压力测试和统计数据"><a href="#3-2-压力测试和统计数据" class="headerlink" title="3.2 压力测试和统计数据"></a>3.2 压力测试和统计数据</h2><p>提供了一个简易的压力测试脚本，可以统计api运行过程中识别耗时和请求耗时的相关数据，不过图需要自己用Excel拉出来。<br>打开文件<code>recognize_time_test.py</code>，修改<code>main</code>函数下的<code>test_file</code>路径，这里会重复使用一张图片来访问是被接口。<br>最后数据会储存在test.csv文件中。<br>使用如下命令运行：  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python3 recognize_time_test.py</span><br><span class="line">----输出如下</span><br><span class="line">2938,5150,13:30:25,总耗时：29ms,识别：15ms,请求：14ms</span><br><span class="line">2939,5150,13:30:25,总耗时：41ms,识别：21ms,请求：20ms</span><br><span class="line">2940,5150,13:30:25,总耗时：47ms,识别：16ms,请求：31ms</span><br></pre></td></tr></table></figure>
<p>这里对一个模型进行了两万次测试后，一组数据test.csv。<br>把test.csv使用箱线图进行分析后可以看到：<br><img src="/readme_image/%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C.png" alt="压力测试结果">  </p>
<ul>
<li>单次请求API总耗时（平均值）：27ms  </li>
<li>单次识别耗时（平均值）：12ms  </li>
<li>每次请求耗时（平均值）：15ms<br>其中有：请求API总耗时 &#x3D; 识别耗时 + 请求耗时</li>
</ul>
<h1 id="4-开发说明"><a href="#4-开发说明" class="headerlink" title="4 开发说明"></a>4 开发说明</h1><ul>
<li>20190209</li>
</ul>
<ol>
<li>目前tensorboard展示支持的不是很好。</li>
</ol>
<ul>
<li>20190601</li>
</ul>
<ol>
<li>最近比较忙，issue回的有点慢，请大家见谅</li>
<li>dev分支开发到一半一直没时间弄，今天儿童节花了一下午时间更新了一下:)</li>
<li>感谢看到这里的你，谢谢你的支持</li>
</ol>
<h1 id="4-已知BUG"><a href="#4-已知BUG" class="headerlink" title="4 已知BUG"></a>4 已知BUG</h1><ol>
<li><p>使用pycharm启动recognize_api.py文件报错</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">2018-12-01 00:35:15.106333: W T:\src\github\tensorflow\tensorflow\core\framework\op_kernel.cc:1273] OP_REQUIRES failed at save_restore_tensor.cc:170 : Invalid argument: Unsuccessful TensorSliceReader constructor: Failed to get matching files on ./model/: Not found: FindFirstFile failed for: ./model : ϵͳ�Ҳ���ָ����·����</span><br><span class="line">; No such process</span><br><span class="line">......</span><br><span class="line">tensorflow.python.framework.errors_impl.InvalidArgumentError: Unsuccessful TensorSliceReader constructor: Failed to get matching files on ./model/: Not found: FindFirstFile failed for: ./model : ϵͳ\udcd5Ҳ\udcbb\udcb5\udcbdָ\udcb6\udca8\udcb5\udcc4·\udcbe\udcb6\udca1\udca3</span><br><span class="line">; No such process</span><br><span class="line">	 [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device=&quot;/job:localhost/replica:0/task:0/device:CPU:0&quot;](_arg_save/Const_0_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]</span><br></pre></td></tr></table></figure>
<p>由pycharm默认设置了工作空间，导致读取相对路径的model文件夹出错。<br>解决办法：编辑运行配置，设置工作空间为项目目录即可。<br><img src="/readme_image/bug_api%E5%90%AF%E5%8A%A8%E5%A4%B1%E8%B4%A5.png" alt="bug_api启动失败"></p>
</li>
<li><p>FileNotFoundError: [Errno 2] No such file or directory: ‘xxxxxx’<br>目录下有文件夹不存在，在指定目录创建好文件夹即可。</p>
</li>
<li><p>api程序在运行过程中内存越占越大<br>结果查阅资料：<a target="_blank" rel="noopener" href="https://blog.csdn.net/The_lastest/article/details/81130500">链接</a><br>在迭代循环时，不能再包含任何张量的计算表达式，否在会内存溢出。<br>将张量的计算表达式放到init初始化执行后，识别速度得到极大的提升。</p>
</li>
<li><p>加载多个模型报错<br>原因是两个Recognizer对象都使用了默认的Graph。<br>解决办法是在创建对象的时候不使用默认Graph，新建graph，这样每个Recognizer都使用不同的graph，就不会冲突了。</p>
</li>
<li><p>Flask程序用于生产<br>可以参考官方文档：<a target="_blank" rel="noopener" href="http://docs.jinkan.org/docs/flask/config.html">Flask的生产配置</a></p>
</li>
<li><p>OOM happens</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hint: If you want to see a list of allocated tensors when OOM happens,</span><br><span class="line">add report_tensor_allocations_upon_oom to RunOptions for current allocation info.</span><br></pre></td></tr></table></figure>
<p>尽可能关闭其他占用GPU或者CPU的任务，或者减小<code>sample_config.json</code>中的<code>train_batch_size</code>参数。</p>
</li>
</ol>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/09/16/%E8%84%9A%E6%9C%AC/BeiSen-Automatic-Clock-in/BeiSen-Automatic-Clock-in/">北森全自动打卡</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-09-17</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%84%9A%E6%9C%AC/">脚本</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/autojs/">autojs</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E5%8C%97%E6%A3%AE/">北森</a></span><div class="content"><ul>
<li><a href="#%E5%A3%B0%E6%98%8E">声明</a><ul>
<li><a href="#-%E5%AE%9A%E6%97%B6%E8%84%9A%E6%9C%AC">⏰ 定时脚本</a></li>
</ul>
</li>
<li><a href="#autojs-vscodeext-readme">Auto.js-VSCodeExt README</a><ul>
<li><a href="#install">Install</a></li>
<li><a href="#features">Features</a></li>
<li><a href="#usage">Usage</a><ul>
<li><a href="#step-1">Step 1</a></li>
<li><a href="#step-2">Step 2</a></li>
<li><a href="#step-3">Step 3</a></li>
</ul>
</li>
<li><a href="#commands">Commands</a></li>
<li><a href="#log">Log</a></li>
</ul>
</li>
<li><a href="#%E9%92%89%E9%92%89%E6%89%93%E5%8D%A1%E8%84%9A%E6%9C%AC%E5%8E%9F%E6%96%87">钉钉打卡脚本原文</a><ul>
<li><a href="#-dingding-automatic-clock-in">⏰ DingDing-Automatic-Clock-in</a></li>
<li><a href="#-%E7%AE%80%E4%BB%8B">📖 简介</a></li>
<li><a href="#-%E5%8A%9F%E8%83%BD">💥 功能</a></li>
<li><a href="#%EF%B8%8F-%E5%B7%A5%E5%85%B7">⚙️ 工具</a></li>
<li><a href="#-%E5%8E%9F%E7%90%86">💡 原理</a></li>
<li><a href="#-%E8%84%9A%E6%9C%AC">📝 脚本</a></li>
<li><a href="#-%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D">📐 工具介绍</a><ul>
<li><a href="#autojs">Auto.js</a></li>
<li><a href="#tasker">Tasker</a></li>
</ul>
</li>
<li><a href="#%EF%B8%8F-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95">🕹️ 使用方法</a><ul>
<li><a href="#%E8%BF%9C%E7%A8%8B%E6%89%93%E5%8D%A1">远程打卡</a></li>
<li><a href="#%E6%9A%82%E5%81%9C%E6%81%A2%E5%A4%8D%E5%AE%9A%E6%97%B6%E6%89%93%E5%8D%A1">暂停&#x2F;恢复定时打卡</a></li>
</ul>
</li>
<li><a href="#%EF%B8%8F-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-%E5%BF%85%E8%AF%BB">⚠️ 注意事项 (必读!!!)</a></li>
<li><a href="#-%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97">📜 更新日志</a><ul>
<li><a href="#2022-03-26">2022-03-26</a></li>
<li><a href="#2022-03-01">2022-03-01</a></li>
<li><a href="#2021-10-23">2021-10-23</a></li>
<li><a href="#2021-09-02">2021-09-02</a></li>
<li><a href="#2021-07-07">2021-07-07</a></li>
<li><a href="#2021-05-27">2021-05-27</a></li>
<li><a href="#2021-05-06">2021-05-06</a></li>
<li><a href="#2021-03-15">2021-03-15</a></li>
<li><a href="#2021-03-09">2021-03-09</a></li>
<li><a href="#2021-02-07">2021-02-07</a></li>
<li><a href="#2021-01-15">2021-01-15</a></li>
<li><a href="#2021-01-08">2021-01-08</a></li>
<li><a href="#2020-12-30">2020-12-30</a></li>
<li><a href="#2020-12-04">2020-12-04</a></li>
<li><a href="#2020-10-27">2020-10-27</a></li>
<li><a href="#2020-09-24">2020-09-24</a><ul>
<li><a href="#%E8%8E%B7%E5%8F%96url%E7%9A%84%E6%96%B9%E5%BC%8F%E5%A6%82%E4%B8%8B">获取URL的方式如下：</a></li>
</ul>
</li>
<li><a href="#2020-09-11">2020-09-11</a></li>
<li><a href="#2020-09-04">2020-09-04</a></li>
<li><a href="#2020-09-02">2020-09-02</a></li>
</ul>
</li>
<li><a href="#-%E5%A3%B0%E6%98%8E">📢 声明</a></li>
</ul>
</li>
</ul>
<h1 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h1><p>本篇文章为摘录自GitHub，自己修改了部分代码，仅作为参考，详见原文</p>
<h2 id="⏰-定时脚本"><a href="#⏰-定时脚本" class="headerlink" title="⏰ 定时脚本"></a>⏰ 定时脚本</h2><p>同时兼容定时和通知两种功能</p>
<ul>
<li>发送 “开启循环” 开启定时功能</li>
<li>发送 “关闭循环” 关闭定时功能</li>
<li>修正 “日志” 功能BUG，发送日志文件到邮箱中</li>
<li>添加 “连接” 功能，实现远程连接电脑 AutoJs Server</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * @Author: George Huan</span></span><br><span class="line"><span class="comment"> * @Date: 2020-08-03 09:30:30</span></span><br><span class="line"><span class="comment"> * @LastEditTime: 2022-03-26 10:56:25</span></span><br><span class="line"><span class="comment"> * @Description: DingDing-Automatic-Clock-in (Run on AutoJs)</span></span><br><span class="line"><span class="comment"> * @URL: https://github.com/georgehuan1994/DingDing-Automatic-Clock-in</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">ACCOUNT</span> = <span class="string">&quot;15868141080&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PASSWORD</span> = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">QQ</span> =              <span class="string">&quot;2757412961&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">EMAILL_ADDRESS</span> =  <span class="string">&quot;2757412961@qq.com&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SERVER_CHAN</span> =     <span class="string">&quot;SCT171904TfSMLDvHz2oGuB8NU9NdMg1W0&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PUSH_DEER</span> =       <span class="string">&quot;PushDeer发送密钥&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PUSH_METHOD</span> = &#123;<span class="attr">QQ</span>: <span class="number">1</span>, <span class="title class_">Email</span>: <span class="number">2</span>, <span class="title class_">ServerChan</span>: <span class="number">3</span>, <span class="title class_">PushDeer</span>: <span class="number">4</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认通信方式：</span></span><br><span class="line"><span class="comment">// PUSH_METHOD.QQ -- QQ</span></span><br><span class="line"><span class="comment">// PUSH_METHOD.Email -- Email </span></span><br><span class="line"><span class="comment">// PUSH_METHOD.ServerChan -- Server酱</span></span><br><span class="line"><span class="comment">// PUSH_METHOD.PushDeer -- Push Deer</span></span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span> = <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_QQ</span> = <span class="string">&quot;com.tencent.mobileqq&quot;</span>                <span class="comment">// QQ</span></span><br><span class="line"><span class="comment">// const PACKAGE_ID_DD = &quot;com.alibaba.android.rimet&quot;           // 钉钉</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_DD</span> = <span class="string">&quot;com.alibaba.android.rimet.zju&quot;</span>       <span class="comment">// 浙大钉</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_XMSF</span> = <span class="string">&quot;com.xiaomi.xmsf&quot;</span>                   <span class="comment">// 小米推送服务</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_TASKER</span> = <span class="string">&quot;net.dinglisch.android.taskerm&quot;</span>   <span class="comment">// Tasker</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_MAIL_163</span> = <span class="string">&quot;com.netease.mail&quot;</span>              <span class="comment">// 网易邮箱大师</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_MAIL_ANDROID</span> = <span class="string">&quot;com.android.email&quot;</span>         <span class="comment">// 系统内置邮箱</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_PUSHDEER</span> = <span class="string">&quot;com.pushdeer.os&quot;</span>               <span class="comment">// Push Deer</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">LOWER_BOUND</span> = <span class="number">1</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 最小等待时间：1min</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">UPPER_BOUND</span> = <span class="number">5</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 最大等待时间：5min</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">ONE_MIN</span> = <span class="number">1</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 等待时间：1min</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">FIF_MIN</span> = <span class="number">15</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 等待时间：0.5h</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">HALF_AN_HOUR</span> = <span class="number">30</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 等待时间：0.5h</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">AN_HOUR</span> = <span class="number">1</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 等待时间：1h</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行时的屏幕亮度（0-255）, 需要&quot;修改系统设置&quot;权限</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SCREEN_BRIGHTNESS</span> = <span class="number">20</span>    </span><br><span class="line"></span><br><span class="line"><span class="comment">// 是否过滤通知</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">NOTIFICATIONS_FILTER</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// PackageId白名单</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_WHITE_LIST</span> = [<span class="variable constant_">PACKAGE_ID_QQ</span>,<span class="variable constant_">PACKAGE_ID_DD</span>,<span class="variable constant_">PACKAGE_ID_XMSF</span>,<span class="variable constant_">PACKAGE_ID_MAIL_163</span>,<span class="variable constant_">PACKAGE_ID_TASKER</span>,<span class="variable constant_">PACKAGE_ID_PUSHDEER</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 公司的钉钉CorpId, 获取方法见 2020-09-24 更新日志。如果只加入了一家公司, 可以不填</span></span><br><span class="line"><span class="comment">// dingtalk://dingtalkclient/page/link?url=&#x27;https://attend.dingtalk.com/attend/index.html?corpId=dingca07f56daee3def1bc961a6cb783455b&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CORP_ID</span> = <span class="string">&quot;dingca07f56daee3def1bc961a6cb783455b&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">// 锁屏意图, 配合 Tasker 完成锁屏动作, 具体配置方法见 2021-03-09 更新日志</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">ACTION_LOCK_SCREEN</span> = <span class="string">&quot;autojs.intent.action.LOCK_SCREEN&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听音量+键, 开启后无法通过音量+键调整音量, 按下音量+键：结束所有子线程</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">OBSERVE_VOLUME_KEY</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">WEEK_DAY</span> = [<span class="string">&quot;Sunday&quot;</span>,<span class="string">&quot;Monday&quot;</span>,<span class="string">&quot;Tuesday&quot;</span>,<span class="string">&quot;Wednesday&quot;</span>,<span class="string">&quot;Thursday&quot;</span>,<span class="string">&quot;Friday&quot;</span>,<span class="string">&quot;Saturday&quot;</span>,]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// =================== ↓↓↓ 主线程：监听通知 ↓↓↓ ====================</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> currentDate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 是否暂停循环打卡</span></span><br><span class="line"><span class="keyword">var</span> recursiveCard = <span class="literal">false</span></span><br><span class="line"><span class="keyword">var</span> timeAnchorPoints = [<span class="number">8</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">22</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 是否暂停定时打卡</span></span><br><span class="line"><span class="keyword">var</span> suspend = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 本次打开钉钉前是否需要等待</span></span><br><span class="line"><span class="keyword">var</span> needWaiting = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 运行日志路径</span></span><br><span class="line"><span class="keyword">var</span> globalLogFilePath = <span class="string">&quot;/sdcard/脚本/Archive/&quot;</span> + <span class="title function_">getCurrentDate</span>() + <span class="string">&quot;-log.txt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查无障碍权限</span></span><br><span class="line">auto.<span class="title function_">waitFor</span>(<span class="string">&quot;normal&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查Autojs版本</span></span><br><span class="line"><span class="title function_">requiresAutojsVersion</span>(<span class="string">&quot;4.1.0&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建运行日志</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">setGlobalLogConfig</span>(&#123;</span><br><span class="line">    <span class="attr">file</span>: <span class="string">&quot;/sdcard/脚本/Archive/&quot;</span> + <span class="title function_">getCurrentDate</span>() + <span class="string">&quot;-log.txt&quot;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听本机通知</span></span><br><span class="line">events.<span class="title function_">observeNotification</span>()    </span><br><span class="line">events.<span class="title function_">on</span>(<span class="string">&quot;notification&quot;</span>, <span class="keyword">function</span>(<span class="params">n</span>) &#123;</span><br><span class="line">    <span class="title function_">notificationHandler</span>(n)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">events.<span class="title function_">setKeyInterceptionEnabled</span>(<span class="string">&quot;volume_up&quot;</span>, <span class="variable constant_">OBSERVE_VOLUME_KEY</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable constant_">OBSERVE_VOLUME_KEY</span>) &#123;</span><br><span class="line">    events.<span class="title function_">observeKey</span>()</span><br><span class="line">&#125;;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 监听音量+键</span></span><br><span class="line">events.<span class="title function_">onKeyDown</span>(<span class="string">&quot;volume_up&quot;</span>, <span class="keyword">function</span>(<span class="params">event</span>)&#123;</span><br><span class="line">    threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">    device.<span class="title function_">setBrightnessMode</span>(<span class="number">1</span>)</span><br><span class="line">    device.<span class="title function_">cancelKeepingAwake</span>()</span><br><span class="line">    <span class="title function_">toast</span>(<span class="string">&quot;已中断所有子线程!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 可以在此调试各个方法</span></span><br><span class="line">    <span class="comment">// doClock()</span></span><br><span class="line">    <span class="comment">// sendQQMsg(&quot;测试文本&quot;)</span></span><br><span class="line">    <span class="comment">// sendEmail(&quot;测试主题&quot;, &quot;测试文本&quot;, null)</span></span><br><span class="line">    <span class="comment">// sendServerChan(测试主题, 测试文本)</span></span><br><span class="line">    <span class="comment">// sendPushDeer(测试主题, 测试文本)</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">toastLog</span>(<span class="string">&quot;监听中, 请在日志中查看记录的通知及其内容&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// =================== ↑↑↑ 主线程：监听通知 ↑↑↑ =====================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// =================== ↑↑↑ 副线程：循环打卡 ↑↑↑ =====================</span></span><br><span class="line"><span class="title function_">startRecursiveCard</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">startRecursiveCard</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">while</span>(recursiveCard)&#123;</span><br><span class="line">        <span class="keyword">var</span> hour = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getHours</span>()</span><br><span class="line">        <span class="comment">// 直到打卡时间点 启动钉钉</span></span><br><span class="line">        <span class="keyword">while</span>(recursiveCard &amp;&amp; !<span class="title function_">existsInArray</span>(timeAnchorPoints, hour))&#123;</span><br><span class="line">            <span class="keyword">var</span> randomTime = <span class="title function_">random</span>(<span class="variable constant_">ONE_MIN</span>, <span class="variable constant_">FIF_MIN</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;【循环打卡】未到时间点，进行&quot;</span> + <span class="title class_">Math</span>.<span class="title function_">floor</span>(randomTime / <span class="number">1000</span>) + <span class="string">&quot;秒随机睡眠...&quot;</span>)</span><br><span class="line">            <span class="title function_">sleep</span>(randomTime)</span><br><span class="line">            hour = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getHours</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="title function_">doClock</span>(); <span class="comment">// 打卡</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title class_">Date</span>() + <span class="string">&quot; 【循环打卡】打卡成功&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span> == <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>)&#123;</span><br><span class="line">            <span class="title function_">sleep</span>(<span class="number">10000</span>) <span class="comment">// 等待默认消息通知程序发送</span></span><br><span class="line">            <span class="title function_">sendQQMsg</span>(<span class="keyword">new</span> <span class="title class_">Date</span>() + <span class="string">&quot; 【循环打卡】打卡成功&quot;</span>)</span><br><span class="line">            <span class="title function_">sendServerChan</span>(<span class="string">&quot;【循环打卡】打卡结果&quot;</span>, <span class="keyword">new</span> <span class="title class_">Date</span>() + <span class="string">&quot; 打卡成功&quot;</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;【循环打卡】QQ&amp;ServerChan 消息发送成功...&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// 直到打卡时间点 启动钉钉</span></span><br><span class="line">        <span class="keyword">while</span>(recursiveCard &amp;&amp; <span class="title function_">existsInArray</span>(timeAnchorPoints, hour))&#123;</span><br><span class="line">            <span class="keyword">var</span> randomTime = <span class="title function_">random</span>(<span class="variable constant_">ONE_MIN</span>, <span class="variable constant_">FIF_MIN</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;【循环打卡】已打卡，进行&quot;</span> + <span class="title class_">Math</span>.<span class="title function_">floor</span>(randomTime / <span class="number">1000</span>) + <span class="string">&quot;秒随机睡眠...&quot;</span>)</span><br><span class="line">            <span class="title function_">sleep</span>(randomTime)</span><br><span class="line">            hour = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getHours</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// =================== ↑↑↑ 副线程：循环打卡 ↑↑↑ =====================</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 处理通知</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">notificationHandler</span>(<span class="params">n</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> packageId = n.<span class="title function_">getPackageName</span>()  <span class="comment">// 获取通知包名</span></span><br><span class="line">    <span class="keyword">var</span> abstract = n.<span class="property">tickerText</span>         <span class="comment">// 获取通知摘要</span></span><br><span class="line">    <span class="keyword">var</span> text = n.<span class="title function_">getText</span>()              <span class="comment">// 获取通知文本</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 过滤 PackageId 白名单之外的应用所发出的通知</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_">filterNotification</span>(packageId, abstract, text)) &#123; </span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 监听摘要为 &quot;定时打卡&quot; 的通知, 不一定要从 Tasker 中发出通知, 日历、定时器等App均可实现</span></span><br><span class="line">    <span class="keyword">if</span> (abstract == <span class="string">&quot;定时打卡&quot;</span> &amp;&amp; !suspend) &#123; </span><br><span class="line">        needWaiting = <span class="literal">true</span></span><br><span class="line">        threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">        threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">doClock</span>()</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(text) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;打卡&quot;</span>: <span class="comment">// 监听文本为 &quot;打卡&quot; 的通知</span></span><br><span class="line">            needWaiting = <span class="literal">false</span></span><br><span class="line">            <span class="comment">// threads.shutDownAll()</span></span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">doClock</span>()</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;查询&quot;</span>: <span class="comment">// 监听文本为 &quot;查询&quot; 的通知</span></span><br><span class="line">            <span class="comment">// threads.shutDownAll()</span></span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                        <span class="title function_">sendQQMsg</span>(<span class="title function_">getStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>))</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                        <span class="title function_">sendEmail</span>(<span class="string">&quot;考勤结果&quot;</span>, <span class="title function_">getStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>), <span class="literal">null</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                        <span class="title function_">sendServerChan</span>(<span class="string">&quot;考勤结果&quot;</span>, <span class="title function_">getStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>))</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                        <span class="title function_">sendPushDeer</span>(<span class="string">&quot;考勤结果&quot;</span>, <span class="title function_">getStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>))</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;暂停&quot;</span>: <span class="comment">// 监听文本为 &quot;暂停&quot; 的通知</span></span><br><span class="line">            suspend = <span class="literal">true</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;暂停定时打卡&quot;</span>)</span><br><span class="line">            threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                        <span class="title function_">sendQQMsg</span>(<span class="string">&quot;修改成功, 已暂停定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                        <span class="title function_">sendEmail</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已暂停定时打卡功能&quot;</span>, <span class="literal">null</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                        <span class="title function_">sendServerChan</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已暂停定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                        <span class="title function_">sendPushDeer</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已暂停定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;恢复&quot;</span>: <span class="comment">// 监听文本为 &quot;恢复&quot; 的通知</span></span><br><span class="line">            suspend = <span class="literal">false</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;恢复定时打卡&quot;</span>)</span><br><span class="line">            threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                        <span class="title function_">sendQQMsg</span>(<span class="string">&quot;修改成功, 已恢复定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                        <span class="title function_">sendEmail</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已恢复定时打卡功能&quot;</span>, <span class="literal">null</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                        <span class="title function_">sendServerChan</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已恢复定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                        <span class="title function_">sendPushDeer</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已恢复定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;日志&quot;</span>: <span class="comment">// 监听文本为 &quot;日志&quot; 的通知</span></span><br><span class="line">            <span class="comment">// threads.shutDownAll()</span></span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">sendEmail</span>(<span class="string">&quot;获取日志&quot;</span>, globalLogFilePath, globalLogFilePath)</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;连接&quot;</span>: <span class="comment">// 连接到 Autojs Server</span></span><br><span class="line">            <span class="comment">// threads.shutDownAll()</span></span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">connectServer</span>()</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;开启循环&quot;</span>: <span class="comment">// 每天循环打卡 早八晚十</span></span><br><span class="line">            recursiveCard = <span class="literal">true</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;每天循环打卡&quot;</span>)</span><br><span class="line">            threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                        <span class="title function_">sendQQMsg</span>(<span class="string">&quot;开启每天循环打卡功能（早八晚十），时间点：&quot;</span> + timeAnchorPoints)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                        <span class="title function_">sendEmail</span>(<span class="string">&quot;开启每天循环打卡功能（早八晚十），时间点：&quot;</span> + timeAnchorPoints, <span class="literal">null</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                        <span class="title function_">sendServerChan</span>(<span class="string">&quot;开启循环打卡成功&quot;</span>, <span class="string">&quot;开启每天循环打卡功能（早八晚十），时间点：&quot;</span> + timeAnchorPoints)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                        <span class="title function_">sendPushDeer</span>(<span class="string">&quot;开启循环打卡成功&quot;</span>, <span class="string">&quot;开启每天循环打卡功能（早八晚十），时间点：&quot;</span> + timeAnchorPoints)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="title function_">startRecursiveCard</span>();</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;关闭循环&quot;</span>: <span class="comment">// 每天循环打卡 早八晚十</span></span><br><span class="line">            recursiveCard = <span class="literal">false</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;关闭每天循环打卡&quot;</span>)</span><br><span class="line">            threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                        <span class="title function_">sendQQMsg</span>(<span class="string">&quot;关闭每天循环打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                        <span class="title function_">sendEmail</span>(<span class="string">&quot;关闭每天循环打卡功能&quot;</span>, <span class="literal">null</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                        <span class="title function_">sendServerChan</span>(<span class="string">&quot;关闭循环打卡成功&quot;</span>, <span class="string">&quot;关闭每天循环打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                        <span class="title function_">sendPushDeer</span>(<span class="string">&quot;关闭循环打卡成功&quot;</span>, <span class="string">&quot;关闭每天循环打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (text == <span class="literal">null</span>) </span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听钉钉返回的考勤结果</span></span><br><span class="line">    <span class="comment">// if (packageId == PACKAGE_ID_DD &amp;&amp; text.indexOf(&quot;考勤打卡&quot;) &gt;= 0) &#123; </span></span><br><span class="line">    <span class="keyword">if</span> (packageId == <span class="variable constant_">PACKAGE_ID_DD</span>) &#123; </span><br><span class="line">        <span class="title function_">setStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>, text)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;监听钉钉返回的消息...&quot;</span>)</span><br><span class="line">        <span class="comment">// threads.shutDownAll()</span></span><br><span class="line">        threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                    <span class="title function_">sendQQMsg</span>(text)</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                    <span class="title function_">sendEmail</span>(<span class="string">&quot;考勤结果&quot;</span>, text, cameraFilePath)</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                    <span class="title function_">sendServerChan</span>(<span class="string">&quot;考勤结果&quot;</span>, text)</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                    <span class="title function_">sendPushDeer</span>(<span class="string">&quot;考勤结果&quot;</span>, text)</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 打卡流程</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">doClock</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    currentDate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;本地时间: &quot;</span> + <span class="title function_">getCurrentDate</span>() + <span class="string">&quot; &quot;</span> + <span class="title function_">getCurrentTime</span>())</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;开始打卡流程!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">brightScreen</span>()      <span class="comment">// 唤醒屏幕</span></span><br><span class="line">    <span class="title function_">unlockScreen</span>()      <span class="comment">// 解锁屏幕</span></span><br><span class="line">    <span class="title function_">holdOn</span>()            <span class="comment">// 随机等待</span></span><br><span class="line">    <span class="title function_">signIn</span>()            <span class="comment">// 自动登录</span></span><br><span class="line">    <span class="title function_">handleLate</span>()        <span class="comment">// 处理迟到</span></span><br><span class="line">    <span class="title function_">attendKaoqin</span>()      <span class="comment">// 考勤打卡</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textContains</span>(<span class="string">&quot;上班打卡&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) </span><br><span class="line">    <span class="title function_">clockIn</span>()           <span class="comment">// 上班打卡</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textContains</span>(<span class="string">&quot;下班打卡&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) </span><br><span class="line">    <span class="title function_">clockOut</span>()          <span class="comment">// 下班打卡</span></span><br><span class="line">    </span><br><span class="line">    <span class="title function_">lockScreen</span>()        <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 发送邮件流程</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; title 邮件主题</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; message 邮件正文</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; attachFilePath 要发送的附件路径</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sendEmail</span>(<span class="params">title, message, attachFilePath</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;开始发送邮件流程!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">brightScreen</span>()      <span class="comment">// 唤醒屏幕</span></span><br><span class="line">    <span class="title function_">unlockScreen</span>()      <span class="comment">// 解锁屏幕</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 内置电子邮件</span></span><br><span class="line">    app.<span class="title function_">launch</span>(<span class="string">&quot;com.android.email&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;等待邮箱启动...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">3000</span>) <span class="comment">// 等待邮箱启动</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(attachFilePath != <span class="literal">null</span> &amp;&amp; files.<span class="title function_">exists</span>(attachFilePath)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(attachFilePath)</span><br><span class="line">        app.<span class="title function_">sendEmail</span>(&#123;</span><br><span class="line">            <span class="attr">email</span>: [<span class="variable constant_">EMAILL_ADDRESS</span>], <span class="attr">subject</span>: title, <span class="attr">text</span>: message, <span class="attr">attachment</span>: <span class="string">&quot;file://&quot;</span> + attachFilePath</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(attachFilePath)</span><br><span class="line">        app.<span class="title function_">sendEmail</span>(&#123;</span><br><span class="line">            <span class="attr">email</span>: [<span class="variable constant_">EMAILL_ADDRESS</span>], <span class="attr">subject</span>: title, <span class="attr">text</span>: message</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 选择邮箱应用，系统默认应用即可</span></span><br><span class="line">    <span class="keyword">var</span> emailText = <span class="title function_">text</span>(<span class="string">&quot;电子邮件&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">null</span> == emailText)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;邮箱应用选择失败...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    emailText.<span class="title function_">parent</span>().<span class="title function_">click</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;邮箱应用选择成功...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 点击发送按钮</span></span><br><span class="line">    <span class="keyword">var</span> sendBtn = <span class="title function_">desc</span>(<span class="string">&quot;发送&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">null</span> == sendBtn)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;邮箱发送失败...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sendBtn.<span class="title function_">click</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在发送邮件...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// =============================================================================================================</span></span><br><span class="line">    <span class="comment">// console.log(&quot;选择邮件应用&quot;)</span></span><br><span class="line">    <span class="comment">// waitForActivity(&quot;com.android.internal.app.ChooserActivity&quot;) // 等待选择应用界面弹窗出现, 如果设置了默认应用就注释掉</span></span><br><span class="line">    <span class="comment">// id(&quot;compose_send_btn&quot;).findOne().click()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// var emailAppName = app.getAppName(PACKAGE_ID_MAIL_163)</span></span><br><span class="line">    <span class="comment">// if (null != emailAppName) &#123;</span></span><br><span class="line">    <span class="comment">//     if (null != textMatches(emailAppName).findOne(1000)) &#123;</span></span><br><span class="line">    <span class="comment">//         btn_email = textMatches(emailAppName).findOnce().parent()</span></span><br><span class="line">    <span class="comment">//         btn_email.click()</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// else &#123;</span></span><br><span class="line">    <span class="comment">//     console.error(&quot;不存在应用: &quot; + PACKAGE_ID_MAIL_163)</span></span><br><span class="line">    <span class="comment">//     lockScreen()</span></span><br><span class="line">    <span class="comment">//     return;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// // 网易邮箱大师</span></span><br><span class="line">    <span class="comment">// var versoin = getPackageVersion(PACKAGE_ID_MAIL_163)</span></span><br><span class="line">    <span class="comment">// console.log(&quot;应用版本: &quot; + versoin)</span></span><br><span class="line">    <span class="comment">// var sp = versoin.split(&quot;.&quot;)</span></span><br><span class="line">    <span class="comment">// if (sp[0] == 6) &#123;</span></span><br><span class="line">    <span class="comment">//     // 网易邮箱大师 6</span></span><br><span class="line">    <span class="comment">//     waitForActivity(&quot;com.netease.mobimail.activity.MailComposeActivity&quot;)</span></span><br><span class="line">    <span class="comment">//     id(&quot;send&quot;).findOne().click()</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// else &#123;</span></span><br><span class="line">    <span class="comment">//     // 网易邮箱大师 7</span></span><br><span class="line">    <span class="comment">//     waitForActivity(&quot;com.netease.mobimail.module.mailcompose.MailComposeActivity&quot;)</span></span><br><span class="line">    <span class="comment">//     var input_address = id(&quot;input&quot;).findOne()</span></span><br><span class="line">    <span class="comment">//     if (null == input_address.getText()) &#123;</span></span><br><span class="line">    <span class="comment">//         input_address.setText(EMAILL_ADDRESS)</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line">    <span class="comment">//     id(&quot;iv_arrow&quot;).findOne().click()</span></span><br><span class="line">    <span class="comment">//     sleep(1000)</span></span><br><span class="line">    <span class="comment">//     id(&quot;img_send_bg&quot;).findOne().click()</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="title function_">home</span>()</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">    <span class="title function_">lockScreen</span>()    <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 发送QQ消息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; message 消息内容</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sendQQMsg</span>(<span class="params">message</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;发送QQ消息&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">brightScreen</span>()      <span class="comment">// 唤醒屏幕</span></span><br><span class="line">    <span class="title function_">unlockScreen</span>()      <span class="comment">// 解锁屏幕</span></span><br><span class="line"></span><br><span class="line">    app.<span class="title function_">startActivity</span>(&#123; </span><br><span class="line">        <span class="attr">action</span>: <span class="string">&quot;android.intent.action.VIEW&quot;</span>, </span><br><span class="line">        <span class="attr">data</span>:<span class="string">&quot;mqq://im/chat?chat_type=wpa&amp;version=1&amp;src_type=web&amp;uin=&quot;</span> + <span class="variable constant_">QQ</span>, </span><br><span class="line">        <span class="attr">packageName</span>: <span class="string">&quot;com.tencent.mobileqq&quot;</span>, </span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// waitForActivity(&quot;com.tencent.mobileqq.activity.SplashActivity&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">id</span>(<span class="string">&quot;input&quot;</span>).<span class="title function_">findOne</span>().<span class="title function_">setText</span>(message)</span><br><span class="line">    <span class="title function_">id</span>(<span class="string">&quot;fun_btn&quot;</span>).<span class="title function_">findOne</span>().<span class="title function_">click</span>()</span><br><span class="line"></span><br><span class="line">    <span class="title function_">home</span>()</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    <span class="title function_">lockScreen</span>()    <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ServerChan推送</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; title 标题</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; message 消息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">sendServerChan</span>(<span class="params">title, message</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;向 ServerChan 发起推送请求&quot;</span>)</span><br><span class="line"></span><br><span class="line">    url = <span class="string">&quot;https://sctapi.ftqq.com/&quot;</span> + <span class="variable constant_">SERVER_CHAN</span> + <span class="string">&quot;.send&quot;</span>;</span><br><span class="line"></span><br><span class="line">    res = http.<span class="title function_">post</span>(<span class="built_in">encodeURI</span>(url), &#123;</span><br><span class="line">        <span class="string">&quot;title&quot;</span>: title,</span><br><span class="line">        <span class="string">&quot;desp&quot;</span>: message</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    <span class="title function_">lockScreen</span>()    <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> PushDeer推送</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; title 标题</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; message 消息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">sendPushDeer</span>(<span class="params">title, message</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;向 PushDeer 发起推送请求&quot;</span>)</span><br><span class="line"></span><br><span class="line">    url = <span class="string">&quot;https://api2.pushdeer.com/message/push&quot;</span></span><br><span class="line"></span><br><span class="line">    res = http.<span class="title function_">post</span>(<span class="built_in">encodeURI</span>(url), &#123;</span><br><span class="line">        <span class="string">&quot;pushkey&quot;</span>: <span class="variable constant_">PUSH_DEER</span>,</span><br><span class="line">        <span class="string">&quot;text&quot;</span>: title,</span><br><span class="line">        <span class="string">&quot;desp&quot;</span>: message,</span><br><span class="line">        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;markdown&quot;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    <span class="title function_">lockScreen</span>()    <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 唤醒设备</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">brightScreen</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;唤醒设备&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    device.<span class="title function_">setBrightnessMode</span>(<span class="number">0</span>) <span class="comment">// 手动亮度模式</span></span><br><span class="line">    device.<span class="title function_">setBrightness</span>(<span class="variable constant_">SCREEN_BRIGHTNESS</span>)</span><br><span class="line">    device.<span class="title function_">wakeUpIfNeeded</span>() <span class="comment">// 唤醒设备</span></span><br><span class="line">    device.<span class="title function_">keepScreenOn</span>()   <span class="comment">// 保持亮屏</span></span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>) <span class="comment">// 等待屏幕亮起</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!device.<span class="title function_">isScreenOn</span>()) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;设备未唤醒, 重试&quot;</span>)</span><br><span class="line">        device.<span class="title function_">wakeUpIfNeeded</span>()</span><br><span class="line">        <span class="title function_">brightScreen</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;设备已唤醒&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 解锁屏幕</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">unlockScreen</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;解锁屏幕&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isDeviceLocked</span>()) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">gesture</span>(</span><br><span class="line">            <span class="number">320</span>, <span class="comment">// 滑动时间：毫秒</span></span><br><span class="line">            [</span><br><span class="line">                device.<span class="property">width</span>  * <span class="number">0.5</span>,    <span class="comment">// 滑动起点 x 坐标：屏幕宽度的一半</span></span><br><span class="line">                device.<span class="property">height</span> * <span class="number">0.9</span>     <span class="comment">// 滑动起点 y 坐标：距离屏幕底部 10% 的位置, 华为系统需要往上一些</span></span><br><span class="line">            ],</span><br><span class="line">            [</span><br><span class="line">                device.<span class="property">width</span> / <span class="number">2</span>,       <span class="comment">// 滑动终点 x 坐标：屏幕宽度的一半</span></span><br><span class="line">                device.<span class="property">height</span> * <span class="number">0.1</span>     <span class="comment">// 滑动终点 y 坐标：距离屏幕顶部 10% 的位置</span></span><br><span class="line">            ]</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>) <span class="comment">// 等待解锁动画完成</span></span><br><span class="line">        <span class="title function_">home</span>()</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>) <span class="comment">// 等待返回动画完成</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isDeviceLocked</span>()) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;上滑解锁失败, 请按脚本中的注释调整 gesture(time, [x1,y1], [x2,y2]) 方法的参数!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;屏幕已解锁&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 随机等待</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">holdOn</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!needWaiting) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> randomTime = <span class="title function_">random</span>(<span class="variable constant_">LOWER_BOUND</span>, <span class="variable constant_">UPPER_BOUND</span>)</span><br><span class="line">    <span class="title function_">toastLog</span>(<span class="title class_">Math</span>.<span class="title function_">floor</span>(randomTime / <span class="number">1000</span>) + <span class="string">&quot;秒后启动&quot;</span> + app.<span class="title function_">getAppName</span>(<span class="variable constant_">PACKAGE_ID_DD</span>) + <span class="string">&quot;...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(randomTime)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 启动并登陆钉钉</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">signIn</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    app.<span class="title function_">launchPackage</span>(<span class="variable constant_">PACKAGE_ID_DD</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在启动&quot;</span> + app.<span class="title function_">getAppName</span>(<span class="variable constant_">PACKAGE_ID_DD</span>) + <span class="string">&quot;...&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">setVolume</span>(<span class="number">0</span>) <span class="comment">// 设备静音</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">10000</span>) <span class="comment">// 等待钉钉启动</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">currentPackage</span>() == <span class="variable constant_">PACKAGE_ID_DD</span> &amp;&amp;</span><br><span class="line">        <span class="title function_">currentActivity</span>() == <span class="string">&quot;com.alibaba.android.user.login.SignUpWithPwdActivity&quot;</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;账号未登录&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> account = <span class="title function_">id</span>(<span class="string">&quot;et_phone_input&quot;</span>).<span class="title function_">findOne</span>()</span><br><span class="line">        account.<span class="title function_">setText</span>(<span class="variable constant_">ACCOUNT</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;输入账号&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> password = <span class="title function_">id</span>(<span class="string">&quot;et_pwd_login&quot;</span>).<span class="title function_">findOne</span>()</span><br><span class="line">        password.<span class="title function_">setText</span>(<span class="variable constant_">PASSWORD</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;输入密码&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> privacy = <span class="title function_">id</span>(<span class="string">&quot;cb_privacy&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="literal">null</span> != privacy)&#123;</span><br><span class="line">            privacy.<span class="title function_">click</span>()</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;同意隐私协议&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> btn_login = <span class="title function_">id</span>(<span class="string">&quot;btn_next&quot;</span>).<span class="title function_">findOne</span>()</span><br><span class="line">        btn_login.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在登陆...&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">3000</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">currentPackage</span>() == <span class="variable constant_">PACKAGE_ID_DD</span> &amp;&amp;</span><br><span class="line">        <span class="title function_">currentActivity</span>() != <span class="string">&quot;com.alibaba.android.user.login.SignUpWithPwdActivity&quot;</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;账号已登录&quot;</span>)</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 处理迟到打卡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleLate</span>(<span class="params"></span>)&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textMatches</span>(<span class="string">&quot;迟到打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        btn_late = <span class="title function_">textMatches</span>(<span class="string">&quot;迟到打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>() </span><br><span class="line">        btn_late.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;迟到打卡&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">descMatches</span>(<span class="string">&quot;迟到打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        btn_late = <span class="title function_">descMatches</span>(<span class="string">&quot;迟到打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>() </span><br><span class="line">        btn_late.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;迟到打卡&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 使用 URL Scheme 进入考勤界面</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">attendKaoqin</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> url_scheme = <span class="string">&quot;dingtalk://dingtalkclient/page/link?url=https://attend.dingtalk.com/attend/index.html&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable constant_">CORP_ID</span> != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">        url_scheme = url_scheme + <span class="string">&quot;?corpId=&quot;</span> + <span class="variable constant_">CORP_ID</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> a = app.<span class="title function_">intent</span>(&#123;</span><br><span class="line">        <span class="comment">// action: &quot;VIEW&quot;,</span></span><br><span class="line">        <span class="attr">action</span>: <span class="string">&quot;android.intent.action.VIEW&quot;</span>, </span><br><span class="line">        <span class="attr">data</span>: url_scheme,</span><br><span class="line">        <span class="comment">//flags: [Intent.FLAG_ACTIVITY_NEW_TASK]</span></span><br><span class="line">    &#125;);</span><br><span class="line">    app.<span class="title function_">startActivity</span>(a);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在进入考勤界面...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">textContains</span>(<span class="string">&quot;申请&quot;</span>).<span class="title function_">waitFor</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;已进入考勤界面&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">8000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 上班打卡 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clockIn</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;上班打卡...&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// if (null != textContains(&quot;已打卡&quot;).findOne(1000)) &#123;</span></span><br><span class="line">    <span class="comment">//     console.info(&quot;已打卡&quot;)</span></span><br><span class="line">    <span class="comment">//     toast(&quot;已打卡&quot;)</span></span><br><span class="line">    <span class="comment">//     home()</span></span><br><span class="line">    <span class="comment">//     sleep(1000)</span></span><br><span class="line">    <span class="comment">//     return;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;等待连接到考勤机...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textContains</span>(<span class="string">&quot;未连接&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;未连接考勤机, 重新进入考勤界面!&quot;</span>)</span><br><span class="line">        <span class="title function_">back</span>()</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">        <span class="title function_">attendKaoqin</span>()</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">textContains</span>(<span class="string">&quot;已连接&quot;</span>).<span class="title function_">waitFor</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;已连接考勤机&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textMatches</span>(<span class="string">&quot;上班打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        btn_clockin = <span class="title function_">textMatches</span>(<span class="string">&quot;上班打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>()</span><br><span class="line">        btn_clockin.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;按下打卡按钮&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">click</span>(device.<span class="property">width</span> / <span class="number">2</span>, device.<span class="property">height</span> * <span class="number">0.560</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;点击打卡按钮坐标&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    <span class="title function_">handleLate</span>() <span class="comment">// 处理迟到打卡</span></span><br><span class="line">    </span><br><span class="line">    <span class="title function_">home</span>()</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 下班打卡 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clockOut</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;下班打卡...&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;等待连接到考勤机...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textContains</span>(<span class="string">&quot;未连接&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;未连接考勤机, 重新进入考勤界面!&quot;</span>)</span><br><span class="line">        <span class="title function_">back</span>()</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">        <span class="title function_">attendKaoqin</span>()</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">textContains</span>(<span class="string">&quot;已连接&quot;</span>).<span class="title function_">waitFor</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;已连接考勤机&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textMatches</span>(<span class="string">&quot;下班打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        btn_clockout = <span class="title function_">textMatches</span>(<span class="string">&quot;下班打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>()</span><br><span class="line">        btn_clockout.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;按下打卡按钮&quot;</span>)</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">click</span>(device.<span class="property">width</span> / <span class="number">2</span>, device.<span class="property">height</span> * <span class="number">0.560</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;点击打卡按钮坐标&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textContains</span>(<span class="string">&quot;早退打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        <span class="title function_">className</span>(<span class="string">&quot;android.widget.Button&quot;</span>).<span class="title function_">text</span>(<span class="string">&quot;早退打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>().<span class="title function_">parent</span>().<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;早退打卡&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">home</span>()</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 锁屏</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">lockScreen</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;关闭屏幕&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 锁屏方案1：Root</span></span><br><span class="line">    <span class="comment">// Power()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 锁屏方案2：No Root</span></span><br><span class="line">    <span class="comment">// press(Math.floor(device.width / 2), Math.floor(device.height * 0.973), 1000) // 小米的快捷手势：长按Home键锁屏</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 万能锁屏方案：向Tasker发送广播, 触发系统锁屏动作。配置方法见 2021-03-09 更新日志</span></span><br><span class="line">    app.<span class="title function_">sendBroadcast</span>(&#123;<span class="attr">action</span>: <span class="variable constant_">ACTION_LOCK_SCREEN</span>&#125;);</span><br><span class="line"></span><br><span class="line">    device.<span class="title function_">setBrightnessMode</span>(<span class="number">1</span>) <span class="comment">// 自动亮度模式</span></span><br><span class="line">    device.<span class="title function_">cancelKeepingAwake</span>() <span class="comment">// 取消设备常亮</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isDeviceLocked</span>()) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;屏幕已关闭&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;屏幕未关闭, 请尝试其他锁屏方案, 或等待屏幕自动关闭&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 连接 AutoJs Server</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">connectServer</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;开始连接 AutoJs Server!&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;本地时间: &quot;</span> + <span class="title function_">getCurrentDate</span>() + <span class="string">&quot; &quot;</span> + <span class="title function_">getCurrentTime</span>())</span><br><span class="line"></span><br><span class="line">    <span class="title function_">brightScreen</span>()      <span class="comment">// 唤醒屏幕</span></span><br><span class="line">    <span class="title function_">unlockScreen</span>()      <span class="comment">// 解锁屏幕</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">connectAutoJsServer</span>() <span class="comment">// 连接 AutoJs Server</span></span><br><span class="line">    </span><br><span class="line">    <span class="title function_">lockScreen</span>()        <span class="comment">// 关闭屏幕</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 启动 AutoJs Server 整体流程</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">connectAutoJsServer</span>(<span class="params"></span>)&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">launchApp</span>(<span class="string">&quot;Auto.js&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在启动 Auto.js...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">10000</span>) <span class="comment">// 等待 Auto.js 启动</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打开侧拉菜单</span></span><br><span class="line">    <span class="keyword">var</span> menuBtn = <span class="title function_">className</span>(<span class="string">&quot;android.widget.ImageButton&quot;</span>).<span class="title function_">desc</span>(<span class="string">&quot;打开侧拉菜单&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">null</span> != menuBtn)&#123;</span><br><span class="line">        menuBtn.<span class="title function_">click</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;打开侧拉菜单...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 滚动屏幕找到连接电脑按钮</span></span><br><span class="line">    <span class="keyword">var</span> menu = <span class="title function_">id</span>(<span class="string">&quot;drawer_menu&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">null</span> == menu)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;滚动屏幕未找到连接电脑按钮...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    menu.<span class="title function_">scrollForward</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;滚动屏幕找到连接电脑按钮...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 连接电脑</span></span><br><span class="line">    <span class="keyword">var</span> textCon = <span class="title function_">className</span>(<span class="string">&quot;android.widget.TextView&quot;</span>).<span class="title function_">text</span>(<span class="string">&quot;连接电脑&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">null</span> != textCon)&#123;</span><br><span class="line">        <span class="comment">// 寻找按钮（Switch）</span></span><br><span class="line">        <span class="keyword">var</span> layerCon = textCon.<span class="title function_">parent</span>();</span><br><span class="line">        <span class="keyword">var</span> switchBtn = layerCon.<span class="title function_">children</span>().<span class="title function_">findOne</span>(<span class="title function_">className</span>(<span class="string">&quot;android.widget.Switch&quot;</span>));</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;找到连接电脑按钮，按钮状态为：&quot;</span> + switchBtn.<span class="title function_">text</span>() + <span class="string">&quot; &quot;</span> + switchBtn.<span class="title function_">checked</span>() +  <span class="string">&quot;...&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(switchBtn.<span class="title function_">checked</span>() == <span class="literal">false</span>)&#123;</span><br><span class="line">            <span class="comment">// 按下按钮</span></span><br><span class="line">            switchBtn.<span class="title function_">click</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;开始连接电脑...&quot;</span>)</span><br><span class="line">            <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 点击确定</span></span><br><span class="line">            <span class="keyword">var</span> okBtn = <span class="title function_">text</span>(<span class="string">&quot;确定&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>);</span><br><span class="line">            okBtn.<span class="title function_">click</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;连接电脑成功...&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>) <span class="comment">// 等待解锁动画完成</span></span><br><span class="line">    <span class="title function_">home</span>()</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>) <span class="comment">// 等待返回动画完成</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// console.log(&quot;==========================================================&quot;);</span></span><br><span class="line">    <span class="comment">// id(&quot;drawer_menu&quot;).findOne().children().forEach(child =&gt; &#123;</span></span><br><span class="line">    <span class="comment">//     var target = child.findOne(id(&quot;sw&quot;));</span></span><br><span class="line">    <span class="comment">//     console.log(target);</span></span><br><span class="line">    <span class="comment">//     &#125;);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ===================== ↓↓↓ 功能函数 ↓↓↓ =======================</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">dateDigitToString</span>(<span class="params">num</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> num &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + num : num</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getCurrentTime</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> currentDate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">    <span class="keyword">var</span> hours = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getHours</span>())</span><br><span class="line">    <span class="keyword">var</span> minute = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getMinutes</span>())</span><br><span class="line">    <span class="keyword">var</span> second = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getSeconds</span>())</span><br><span class="line">    <span class="keyword">var</span> formattedTimeString = hours + <span class="string">&#x27;:&#x27;</span> + minute + <span class="string">&#x27;:&#x27;</span> + second</span><br><span class="line">    <span class="keyword">return</span> formattedTimeString</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getCurrentDate</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> currentDate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">    <span class="keyword">var</span> year = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getFullYear</span>())</span><br><span class="line">    <span class="keyword">var</span> month = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getMonth</span>() + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">var</span> date = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getDate</span>())</span><br><span class="line">    <span class="keyword">var</span> week = currentDate.<span class="title function_">getDay</span>()</span><br><span class="line">    <span class="keyword">var</span> formattedDateString = year + <span class="string">&#x27;-&#x27;</span> + month + <span class="string">&#x27;-&#x27;</span> + date + <span class="string">&#x27;-&#x27;</span> + <span class="variable constant_">WEEK_DAY</span>[week]</span><br><span class="line">    <span class="keyword">return</span> formattedDateString</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">existsInArray</span>(<span class="params">arr, element</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;arr.<span class="property">length</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(arr[i] == element) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通知过滤器</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">filterNotification</span>(<span class="params">bundleId, abstract, text</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> check = <span class="variable constant_">PACKAGE_ID_WHITE_LIST</span>.<span class="title function_">some</span>(<span class="keyword">function</span>(<span class="params">item</span>) &#123;<span class="keyword">return</span> bundleId == item&#125;) </span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable constant_">NOTIFICATIONS_FILTER</span> || check) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">verbose</span>(bundleId)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">verbose</span>(abstract)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">verbose</span>(text)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">verbose</span>(<span class="string">&quot;---------------------------&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 保存本地数据</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setStorageData</span>(<span class="params">name, key, value</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> storage = storages.<span class="title function_">create</span>(name)  <span class="comment">// 创建storage对象</span></span><br><span class="line">    storage.<span class="title function_">put</span>(key, value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取本地数据</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getStorageData</span>(<span class="params">name, key</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> storage = storages.<span class="title function_">create</span>(name)</span><br><span class="line">    <span class="keyword">if</span> (storage.<span class="title function_">contains</span>(key)) &#123;</span><br><span class="line">        <span class="keyword">return</span> storage.<span class="title function_">get</span>(key, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 默认返回undefined</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除本地数据</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">delStorageData</span>(<span class="params">name, key</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> storage = storages.<span class="title function_">create</span>(name)</span><br><span class="line">    <span class="keyword">if</span> (storage.<span class="title function_">contains</span>(key)) &#123;</span><br><span class="line">        storage.<span class="title function_">remove</span>(key)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取应用版本号</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getPackageVersion</span>(<span class="params">bundleId</span>) &#123;</span><br><span class="line">    <span class="title function_">importPackage</span>(android.<span class="property">content</span>)</span><br><span class="line">    <span class="keyword">var</span> pckMan = context.<span class="title function_">getPackageManager</span>()</span><br><span class="line">    <span class="keyword">var</span> packageInfo = pckMan.<span class="title function_">getPackageInfo</span>(bundleId, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> packageInfo.<span class="property">versionName</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 屏幕是否为锁定状态</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isDeviceLocked</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">importClass</span>(android.<span class="property">app</span>.<span class="property">KeyguardManager</span>)</span><br><span class="line">    <span class="title function_">importClass</span>(android.<span class="property">content</span>.<span class="property">Context</span>)</span><br><span class="line">    <span class="keyword">var</span> km = context.<span class="title function_">getSystemService</span>(<span class="title class_">Context</span>.<span class="property">KEYGUARD_SERVICE</span>)</span><br><span class="line">    <span class="keyword">return</span> km.<span class="title function_">isKeyguardLocked</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置媒体和通知音量</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setVolume</span>(<span class="params">volume</span>) &#123;</span><br><span class="line">    device.<span class="title function_">setMusicVolume</span>(volume)</span><br><span class="line">    device.<span class="title function_">setNotificationVolume</span>(volume)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">verbose</span>(<span class="string">&quot;媒体音量:&quot;</span> + device.<span class="title function_">getMusicVolume</span>())</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">verbose</span>(<span class="string">&quot;通知音量:&quot;</span> + device.<span class="title function_">getNotificationVolume</span>())</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Auto-js-VSCodeExt-README"><a href="#Auto-js-VSCodeExt-README" class="headerlink" title="Auto.js-VSCodeExt README"></a>Auto.js-VSCodeExt README</h1><p>桌面编辑器Visual Studio Code的插件。可以让Visual Studio Code支持<a target="_blank" rel="noopener" href="https://github.com/hyb1996/NoRootScriptDroid">Auto.js</a>开发。</p>
<h2 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h2><p>在VS Code中菜单”查看”-&gt;”扩展”-&gt;输入”Auto.js”或”hyb1996”搜索，即可看到”Auto.js-VSCodeExt”插件，安装即可。插件的更新也可以在这里更新。</p>
<h2 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h2><p>目前功能比较基础，仅支持：</p>
<ul>
<li>在VS Code的开发者工具实时显示Auto.js的日志与输出</li>
<li>在VS Code命令中增加Run, Stop, Rerun, Stop all等选项。可以在手机与电脑连接后把Sublime编辑器中的脚本推送到AutoJs中执行，或者停止AutoJs中运行的脚本。</li>
</ul>
<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><h3 id="Step-1"><a href="#Step-1" class="headerlink" title="Step 1"></a>Step 1</h3><p>按 <code>Ctrl+Shift+P</code> 或点击”查看”-&gt;”命令面板”可调出命令面板，输入 <code>Auto.js</code> 可以看到几个命令，移动光标到命令<code>Auto.js: Start Server</code>，按回车键执行该命令。</p>
<p>此时VS Code会在右上角显示”Auto.js server running”，即开启服务成功。</p>
<h3 id="Step-2"><a href="#Step-2" class="headerlink" title="Step 2"></a>Step 2</h3><p>将手机连接到电脑启用的Wifi或者同一局域网中。通过命令行ipconfig(或者其他操作系统的相同功能命令)查看电脑的IP地址。在<a target="_blank" rel="noopener" href="https://github.com/hyb1996/Auto.js">Auto.js</a>的侧拉菜单中启用调试服务，并输入IP地址，等待连接成功。</p>
<h3 id="Step-3"><a href="#Step-3" class="headerlink" title="Step 3"></a>Step 3</h3><p>之后就可以在电脑上编辑JavaScript文件并通过命令<code>Run</code>或者按键<code>F5</code>在手机上运行了。</p>
<h2 id="Commands"><a href="#Commands" class="headerlink" title="Commands"></a>Commands</h2><p>按 <code>Ctrl+Shift+P</code> 或点击”查看”-&gt;”命令面板”可调出命令面板，输入 <code>Auto.js</code> 可以看到几个命令：</p>
<ul>
<li>Start Server: 启动插件服务。之后在确保手机和电脑在同一区域网的情况下，在Auto.js的侧拉菜单中使用连接电脑功能连接。</li>
<li>Stop Server: 停止插件服务。</li>
<li>Run 运行当前编辑器的脚本。如果有多个设备连接，则在所有设备运行。</li>
<li>Rerun 停止当前文件对应的脚本并重新运行。如果有多个设备连接，则在所有设备重新运行。</li>
<li>Stop 停止当前文件对应的脚本。如果有多个设备连接，则在所有设备停止。</li>
<li>StopAll 停止所有正在运行的脚本。如果有多个设备连接，则在所有设备运行所有脚本。</li>
<li>Save 保存当前文件到手机的脚本默认目录（文件名会加上前缀remote)。如果有多个设备连接，则在所有设备保存。</li>
<li>RunOnDevice: 弹出设备菜单并在指定设备运行脚本。</li>
<li>SaveToDevice: 弹出设备菜单并在指定设备保存脚本。</li>
<li>New Project（新建项目）：选择一个空文件夹（或者在文件管理器中新建一个空文件夹），将会自动创建一个项目</li>
<li>Run Project（运行项目）：运行一个项目，需要Auto.js 4.0.4Alpha5以上支持</li>
<li>Save Project（保存项目）：保存一个项目，需要Auto.js 4.0.4Alpha5以上支持</li>
</ul>
<p>以上命令一些有对应的快捷键，参照命令后面的说明即可。</p>
<h2 id="Log"><a href="#Log" class="headerlink" title="Log"></a>Log</h2><p>要显示来自Auto.js的日志，打开 VS Code上面菜单的”帮助”-&gt;”切换开发人员工具”-&gt;”Console”即可。</p>
<h1 id="钉钉打卡脚本原文"><a href="#钉钉打卡脚本原文" class="headerlink" title="钉钉打卡脚本原文"></a>钉钉打卡脚本原文</h1><h2 id="⏰-DingDing-Automatic-Clock-in"><a href="#⏰-DingDing-Automatic-Clock-in" class="headerlink" title="⏰ DingDing-Automatic-Clock-in"></a>⏰ DingDing-Automatic-Clock-in</h2><img width="796" src="https://user-images.githubusercontent.com/49583943/138620009-32d16b4a-d38b-4cb7-9650-db7f45f14520.png"/>

<h2 id="📖-简介"><a href="#📖-简介" class="headerlink" title="📖 简介"></a>📖 简介</h2><p>钉钉全自动打卡 + 远程打卡脚本，无需 root，基于 auto.js，适用于蓝牙考勤机。</p>
<h2 id="💥-功能"><a href="#💥-功能" class="headerlink" title="💥 功能"></a>💥 功能</h2><ul>
<li>定时打卡</li>
<li>远程打卡</li>
<li>发送考勤结果</li>
</ul>
<h2 id="⚙️-工具"><a href="#⚙️-工具" class="headerlink" title="⚙️ 工具"></a>⚙️ 工具</h2><ul>
<li>auto.js</li>
<li>Tasker</li>
<li>一款通讯应用（示例脚本中使用的是 QQ &#x2F; 网易邮箱大师 &#x2F; ServerChan &#x2F; PushDeer，彼此互为备用方案）</li>
</ul>
<h2 id="💡-原理"><a href="#💡-原理" class="headerlink" title="💡 原理"></a>💡 原理</h2><p>通过 auto.js 脚本监听本机通知，在 Tasker 中创建定时任务，发出通知，或在另一设备上发送消息到本机，即可触发脚本中的打卡进程，实现定时打卡和远程打卡。</p>
<p><img src="https://user-images.githubusercontent.com/49583943/163506300-7ef7693b-a273-442f-8449-dcef31063069.png" alt="image"></p>
<p>同理，监听到钉钉发出的打卡成功通知后，将通知文本通过 QQ消息 或 邮件正文 发送，实现发送考勤结果的功能。</p>
<h2 id="📝-脚本"><a href="#📝-脚本" class="headerlink" title="📝 脚本"></a>📝 脚本</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * @Author: George Huan</span></span><br><span class="line"><span class="comment"> * @Date: 2020-08-03 09:30:30</span></span><br><span class="line"><span class="comment"> * @LastEditTime: 2022-03-26 10:56:25</span></span><br><span class="line"><span class="comment"> * @Description: DingDing-Automatic-Clock-in (Run on AutoJs)</span></span><br><span class="line"><span class="comment"> * @URL: https://github.com/georgehuan1994/DingDing-Automatic-Clock-in</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">ACCOUNT</span> = <span class="string">&quot;钉钉账号&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PASSWORD</span> = <span class="string">&quot;钉钉密码&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">QQ</span> =              <span class="string">&quot;用于接收打卡结果的QQ号&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">EMAILL_ADDRESS</span> =  <span class="string">&quot;用于接收打卡结果的邮箱地址&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SERVER_CHAN</span> =     <span class="string">&quot;Server酱发送密钥&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PUSH_DEER</span> =       <span class="string">&quot;PushDeer发送密钥&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PUSH_METHOD</span> = &#123;<span class="attr">QQ</span>: <span class="number">1</span>, <span class="title class_">Email</span>: <span class="number">2</span>, <span class="title class_">ServerChan</span>: <span class="number">3</span>, <span class="title class_">PushDeer</span>: <span class="number">4</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认通信方式：</span></span><br><span class="line"><span class="comment">// PUSH_METHOD.QQ -- QQ</span></span><br><span class="line"><span class="comment">// PUSH_METHOD.Email -- Email </span></span><br><span class="line"><span class="comment">// PUSH_METHOD.ServerChan -- Server酱</span></span><br><span class="line"><span class="comment">// PUSH_METHOD.PushDeer -- Push Deer</span></span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span> = <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_QQ</span> = <span class="string">&quot;com.tencent.mobileqq&quot;</span>                <span class="comment">// QQ</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_DD</span> = <span class="string">&quot;com.alibaba.android.rimet&quot;</span>           <span class="comment">// 钉钉</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_XMSF</span> = <span class="string">&quot;com.xiaomi.xmsf&quot;</span>                   <span class="comment">// 小米推送服务</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_TASKER</span> = <span class="string">&quot;net.dinglisch.android.taskerm&quot;</span>   <span class="comment">// Tasker</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_MAIL_163</span> = <span class="string">&quot;com.netease.mail&quot;</span>              <span class="comment">// 网易邮箱大师</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_MAIL_ANDROID</span> = <span class="string">&quot;com.android.email&quot;</span>         <span class="comment">// 系统内置邮箱</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_PUSHDEER</span> = <span class="string">&quot;com.pushdeer.os&quot;</span>               <span class="comment">// Push Deer</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">LOWER_BOUND</span> = <span class="number">1</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 最小等待时间：1min</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">UPPER_BOUND</span> = <span class="number">5</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 最大等待时间：5min</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行时的屏幕亮度（0-255）, 需要&quot;修改系统设置&quot;权限</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SCREEN_BRIGHTNESS</span> = <span class="number">20</span>    </span><br><span class="line"></span><br><span class="line"><span class="comment">// 是否过滤通知</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">NOTIFICATIONS_FILTER</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// PackageId白名单</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_WHITE_LIST</span> = [<span class="variable constant_">PACKAGE_ID_QQ</span>,<span class="variable constant_">PACKAGE_ID_DD</span>,<span class="variable constant_">PACKAGE_ID_XMSF</span>,<span class="variable constant_">PACKAGE_ID_MAIL_163</span>,<span class="variable constant_">PACKAGE_ID_TASKER</span>,<span class="variable constant_">PACKAGE_ID_PUSHDEER</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 公司的钉钉CorpId, 获取方法见 2020-09-24 更新日志。如果只加入了一家公司, 可以不填</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CORP_ID</span> = <span class="string">&quot;&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">// 锁屏意图, 配合 Tasker 完成锁屏动作, 具体配置方法见 2021-03-09 更新日志</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">ACTION_LOCK_SCREEN</span> = <span class="string">&quot;autojs.intent.action.LOCK_SCREEN&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听音量+键, 开启后无法通过音量+键调整音量, 按下音量+键：结束所有子线程</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">OBSERVE_VOLUME_KEY</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">WEEK_DAY</span> = [<span class="string">&quot;Sunday&quot;</span>,<span class="string">&quot;Monday&quot;</span>,<span class="string">&quot;Tuesday&quot;</span>,<span class="string">&quot;Wednesday&quot;</span>,<span class="string">&quot;Thursday&quot;</span>,<span class="string">&quot;Friday&quot;</span>,<span class="string">&quot;Saturday&quot;</span>,]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// =================== ↓↓↓ 主线程：监听通知 ↓↓↓ ====================</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> currentDate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 是否暂停定时打卡</span></span><br><span class="line"><span class="keyword">var</span> suspend = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 本次打开钉钉前是否需要等待</span></span><br><span class="line"><span class="keyword">var</span> needWaiting = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 运行日志路径</span></span><br><span class="line"><span class="keyword">var</span> globalLogFilePath = <span class="string">&quot;/sdcard/脚本/Archive/&quot;</span> + <span class="title function_">getCurrentDate</span>() + <span class="string">&quot;-log.txt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查无障碍权限</span></span><br><span class="line">auto.<span class="title function_">waitFor</span>(<span class="string">&quot;normal&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查Autojs版本</span></span><br><span class="line"><span class="title function_">requiresAutojsVersion</span>(<span class="string">&quot;4.1.0&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建运行日志</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">setGlobalLogConfig</span>(&#123;</span><br><span class="line">    <span class="attr">file</span>: <span class="string">&quot;/sdcard/脚本/Archive/&quot;</span> + <span class="title function_">getCurrentDate</span>() + <span class="string">&quot;-log.txt&quot;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听本机通知</span></span><br><span class="line">events.<span class="title function_">observeNotification</span>()    </span><br><span class="line">events.<span class="title function_">on</span>(<span class="string">&quot;notification&quot;</span>, <span class="keyword">function</span>(<span class="params">n</span>) &#123;</span><br><span class="line">    <span class="title function_">notificationHandler</span>(n)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">events.<span class="title function_">setKeyInterceptionEnabled</span>(<span class="string">&quot;volume_up&quot;</span>, <span class="variable constant_">OBSERVE_VOLUME_KEY</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable constant_">OBSERVE_VOLUME_KEY</span>) &#123;</span><br><span class="line">    events.<span class="title function_">observeKey</span>()</span><br><span class="line">&#125;;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 监听音量+键</span></span><br><span class="line">events.<span class="title function_">onKeyDown</span>(<span class="string">&quot;volume_up&quot;</span>, <span class="keyword">function</span>(<span class="params">event</span>)&#123;</span><br><span class="line">    threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">    device.<span class="title function_">setBrightnessMode</span>(<span class="number">1</span>)</span><br><span class="line">    device.<span class="title function_">cancelKeepingAwake</span>()</span><br><span class="line">    <span class="title function_">toast</span>(<span class="string">&quot;已中断所有子线程!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 可以在此调试各个方法</span></span><br><span class="line">    <span class="comment">// doClock()</span></span><br><span class="line">    <span class="comment">// sendQQMsg(&quot;测试文本&quot;)</span></span><br><span class="line">    <span class="comment">// sendEmail(&quot;测试主题&quot;, &quot;测试文本&quot;, null)</span></span><br><span class="line">    <span class="comment">// sendServerChan(测试主题, 测试文本)</span></span><br><span class="line">    <span class="comment">// sendPushDeer(测试主题, 测试文本)</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">toastLog</span>(<span class="string">&quot;监听中, 请在日志中查看记录的通知及其内容&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// =================== ↑↑↑ 主线程：监听通知 ↑↑↑ =====================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 处理通知</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">notificationHandler</span>(<span class="params">n</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> packageId = n.<span class="title function_">getPackageName</span>()  <span class="comment">// 获取通知包名</span></span><br><span class="line">    <span class="keyword">var</span> abstract = n.<span class="property">tickerText</span>         <span class="comment">// 获取通知摘要</span></span><br><span class="line">    <span class="keyword">var</span> text = n.<span class="title function_">getText</span>()              <span class="comment">// 获取通知文本</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 过滤 PackageId 白名单之外的应用所发出的通知</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_">filterNotification</span>(packageId, abstract, text)) &#123; </span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 监听摘要为 &quot;定时打卡&quot; 的通知, 不一定要从 Tasker 中发出通知, 日历、定时器等App均可实现</span></span><br><span class="line">    <span class="keyword">if</span> (abstract == <span class="string">&quot;定时打卡&quot;</span> &amp;&amp; !suspend) &#123; </span><br><span class="line">        needWaiting = <span class="literal">true</span></span><br><span class="line">        threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">        threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">doClock</span>()</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(text) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;打卡&quot;</span>: <span class="comment">// 监听文本为 &quot;打卡&quot; 的通知</span></span><br><span class="line">            needWaiting = <span class="literal">false</span></span><br><span class="line">            threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">doClock</span>()</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;查询&quot;</span>: <span class="comment">// 监听文本为 &quot;查询&quot; 的通知</span></span><br><span class="line">            threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                        <span class="title function_">sendQQMsg</span>(<span class="title function_">getStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>))</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                        <span class="title function_">sendEmail</span>(<span class="string">&quot;考勤结果&quot;</span>, <span class="title function_">getStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>), <span class="literal">null</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                        <span class="title function_">sendServerChan</span>(<span class="string">&quot;考勤结果&quot;</span>, <span class="title function_">getStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>))</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                        <span class="title function_">sendPushDeer</span>(<span class="string">&quot;考勤结果&quot;</span>, <span class="title function_">getStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>))</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;暂停&quot;</span>: <span class="comment">// 监听文本为 &quot;暂停&quot; 的通知</span></span><br><span class="line">            suspend = <span class="literal">true</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;暂停定时打卡&quot;</span>)</span><br><span class="line">            threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                        <span class="title function_">sendQQMsg</span>(<span class="string">&quot;修改成功, 已暂停定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                        <span class="title function_">sendEmail</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已暂停定时打卡功能&quot;</span>, <span class="literal">null</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                        <span class="title function_">sendServerChan</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已暂停定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                        <span class="title function_">sendPushDeer</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已暂停定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;恢复&quot;</span>: <span class="comment">// 监听文本为 &quot;恢复&quot; 的通知</span></span><br><span class="line">            suspend = <span class="literal">false</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;恢复定时打卡&quot;</span>)</span><br><span class="line">            threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                        <span class="title function_">sendQQMsg</span>(<span class="string">&quot;修改成功, 已恢复定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                        <span class="title function_">sendEmail</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已恢复定时打卡功能&quot;</span>, <span class="literal">null</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                        <span class="title function_">sendServerChan</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已恢复定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                        <span class="title function_">sendPushDeer</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已恢复定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;日志&quot;</span>: <span class="comment">// 监听文本为 &quot;日志&quot; 的通知</span></span><br><span class="line">            threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">sendEmail</span>(<span class="string">&quot;获取日志&quot;</span>, globalLogFilePath, globalLogFilePath)</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (text == <span class="literal">null</span>) </span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听钉钉返回的考勤结果</span></span><br><span class="line">    <span class="keyword">if</span> (packageId == <span class="variable constant_">PACKAGE_ID_DD</span> &amp;&amp; text.<span class="title function_">indexOf</span>(<span class="string">&quot;考勤打卡&quot;</span>) &gt;= <span class="number">0</span>) &#123; </span><br><span class="line">        <span class="title function_">setStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>, text)</span><br><span class="line">        threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">        threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                    <span class="title function_">sendQQMsg</span>(text)</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                    <span class="title function_">sendEmail</span>(<span class="string">&quot;考勤结果&quot;</span>, text, cameraFilePath)</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                    <span class="title function_">sendServerChan</span>(<span class="string">&quot;考勤结果&quot;</span>, text)</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                    <span class="title function_">sendPushDeer</span>(<span class="string">&quot;考勤结果&quot;</span>, text)</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 打卡流程</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">doClock</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    currentDate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;本地时间: &quot;</span> + <span class="title function_">getCurrentDate</span>() + <span class="string">&quot; &quot;</span> + <span class="title function_">getCurrentTime</span>())</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;开始打卡流程!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">brightScreen</span>()      <span class="comment">// 唤醒屏幕</span></span><br><span class="line">    <span class="title function_">unlockScreen</span>()      <span class="comment">// 解锁屏幕</span></span><br><span class="line">    <span class="title function_">holdOn</span>()            <span class="comment">// 随机等待</span></span><br><span class="line">    <span class="title function_">signIn</span>()            <span class="comment">// 自动登录</span></span><br><span class="line">    <span class="title function_">handleLate</span>()        <span class="comment">// 处理迟到</span></span><br><span class="line">    <span class="title function_">attendKaoqin</span>()      <span class="comment">// 考勤打卡</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (currentDate.<span class="title function_">getHours</span>() &lt;= <span class="number">12</span>) </span><br><span class="line">    <span class="title function_">clockIn</span>()           <span class="comment">// 上班打卡</span></span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    <span class="title function_">clockOut</span>()          <span class="comment">// 下班打卡</span></span><br><span class="line">    </span><br><span class="line">    <span class="title function_">lockScreen</span>()        <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 发送邮件流程</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; title 邮件主题</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; message 邮件正文</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; attachFilePath 要发送的附件路径</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sendEmail</span>(<span class="params">title, message, attachFilePath</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;开始发送邮件流程!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">brightScreen</span>()      <span class="comment">// 唤醒屏幕</span></span><br><span class="line">    <span class="title function_">unlockScreen</span>()      <span class="comment">// 解锁屏幕</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(attachFilePath != <span class="literal">null</span> &amp;&amp; files.<span class="title function_">exists</span>(attachFilePath)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(attachFilePath)</span><br><span class="line">        app.<span class="title function_">sendEmail</span>(&#123;</span><br><span class="line">            <span class="attr">email</span>: [<span class="variable constant_">EMAILL_ADDRESS</span>], <span class="attr">subject</span>: title, <span class="attr">text</span>: message, <span class="attr">attachment</span>: attachFilePath</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(attachFilePath)</span><br><span class="line">        app.<span class="title function_">sendEmail</span>(&#123;</span><br><span class="line">            <span class="attr">email</span>: [<span class="variable constant_">EMAILL_ADDRESS</span>], <span class="attr">subject</span>: title, <span class="attr">text</span>: message</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;选择邮件应用&quot;</span>)</span><br><span class="line">    <span class="title function_">waitForActivity</span>(<span class="string">&quot;com.android.internal.app.ChooserActivity&quot;</span>) <span class="comment">// 等待选择应用界面弹窗出现, 如果设置了默认应用就注释掉</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> emailAppName = app.<span class="title function_">getAppName</span>(<span class="variable constant_">PACKAGE_ID_MAIL_163</span>)</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != emailAppName) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textMatches</span>(emailAppName).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">            btn_email = <span class="title function_">textMatches</span>(emailAppName).<span class="title function_">findOnce</span>().<span class="title function_">parent</span>()</span><br><span class="line">            btn_email.<span class="title function_">click</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;不存在应用: &quot;</span> + <span class="variable constant_">PACKAGE_ID_MAIL_163</span>)</span><br><span class="line">        <span class="title function_">lockScreen</span>()</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 网易邮箱大师</span></span><br><span class="line">    <span class="keyword">var</span> versoin = <span class="title function_">getPackageVersion</span>(<span class="variable constant_">PACKAGE_ID_MAIL_163</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;应用版本: &quot;</span> + versoin)</span><br><span class="line">    <span class="keyword">var</span> sp = versoin.<span class="title function_">split</span>(<span class="string">&quot;.&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> (sp[<span class="number">0</span>] == <span class="number">6</span>) &#123;</span><br><span class="line">        <span class="comment">// 网易邮箱大师 6</span></span><br><span class="line">        <span class="title function_">waitForActivity</span>(<span class="string">&quot;com.netease.mobimail.activity.MailComposeActivity&quot;</span>)</span><br><span class="line">        <span class="title function_">id</span>(<span class="string">&quot;send&quot;</span>).<span class="title function_">findOne</span>().<span class="title function_">click</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 网易邮箱大师 7</span></span><br><span class="line">        <span class="title function_">waitForActivity</span>(<span class="string">&quot;com.netease.mobimail.module.mailcompose.MailComposeActivity&quot;</span>)</span><br><span class="line">        <span class="keyword">var</span> input_address = <span class="title function_">id</span>(<span class="string">&quot;input&quot;</span>).<span class="title function_">findOne</span>()</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == input_address.<span class="title function_">getText</span>()) &#123;</span><br><span class="line">            input_address.<span class="title function_">setText</span>(<span class="variable constant_">EMAILL_ADDRESS</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">id</span>(<span class="string">&quot;iv_arrow&quot;</span>).<span class="title function_">findOne</span>().<span class="title function_">click</span>()</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">        <span class="title function_">id</span>(<span class="string">&quot;img_send_bg&quot;</span>).<span class="title function_">findOne</span>().<span class="title function_">click</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 内置电子邮件</span></span><br><span class="line">    <span class="comment">// waitForActivity(&quot;com.kingsoft.mail.compose.ComposeActivity&quot;)</span></span><br><span class="line">    <span class="comment">// id(&quot;compose_send_btn&quot;).findOne().click()</span></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在发送邮件...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">home</span>()</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">    <span class="title function_">lockScreen</span>()    <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 发送QQ消息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; message 消息内容</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sendQQMsg</span>(<span class="params">message</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;发送QQ消息&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">brightScreen</span>()      <span class="comment">// 唤醒屏幕</span></span><br><span class="line">    <span class="title function_">unlockScreen</span>()      <span class="comment">// 解锁屏幕</span></span><br><span class="line"></span><br><span class="line">    app.<span class="title function_">startActivity</span>(&#123; </span><br><span class="line">        <span class="attr">action</span>: <span class="string">&quot;android.intent.action.VIEW&quot;</span>, </span><br><span class="line">        <span class="attr">data</span>:<span class="string">&quot;mqq://im/chat?chat_type=wpa&amp;version=1&amp;src_type=web&amp;uin=&quot;</span> + <span class="variable constant_">QQ</span>, </span><br><span class="line">        <span class="attr">packageName</span>: <span class="string">&quot;com.tencent.mobileqq&quot;</span>, </span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// waitForActivity(&quot;com.tencent.mobileqq.activity.SplashActivity&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">id</span>(<span class="string">&quot;input&quot;</span>).<span class="title function_">findOne</span>().<span class="title function_">setText</span>(message)</span><br><span class="line">    <span class="title function_">id</span>(<span class="string">&quot;fun_btn&quot;</span>).<span class="title function_">findOne</span>().<span class="title function_">click</span>()</span><br><span class="line"></span><br><span class="line">    <span class="title function_">home</span>()</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    <span class="title function_">lockScreen</span>()    <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ServerChan推送</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; title 标题</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; message 消息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">sendServerChan</span>(<span class="params">title, message</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;向 ServerChan 发起推送请求&quot;</span>)</span><br><span class="line"></span><br><span class="line">    url = <span class="string">&quot;https://sctapi.ftqq.com/&quot;</span> + <span class="variable constant_">SERVER_CHAN</span> + <span class="string">&quot;.send&quot;</span>;</span><br><span class="line"></span><br><span class="line">    res = http.<span class="title function_">post</span>(<span class="built_in">encodeURI</span>(url), &#123;</span><br><span class="line">        <span class="string">&quot;title&quot;</span>: title,</span><br><span class="line">        <span class="string">&quot;desp&quot;</span>: message</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    <span class="title function_">lockScreen</span>()    <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> PushDeer推送</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; title 标题</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; message 消息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">sendPushDeer</span>(<span class="params">title, message</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;向 PushDeer 发起推送请求&quot;</span>)</span><br><span class="line"></span><br><span class="line">    url = <span class="string">&quot;https://api2.pushdeer.com/message/push&quot;</span></span><br><span class="line"></span><br><span class="line">    res = http.<span class="title function_">post</span>(<span class="built_in">encodeURI</span>(url), &#123;</span><br><span class="line">        <span class="string">&quot;pushkey&quot;</span>: <span class="variable constant_">PUSH_DEER</span>,</span><br><span class="line">        <span class="string">&quot;text&quot;</span>: title,</span><br><span class="line">        <span class="string">&quot;desp&quot;</span>: message,</span><br><span class="line">        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;markdown&quot;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    <span class="title function_">lockScreen</span>()    <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 唤醒设备</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">brightScreen</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;唤醒设备&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    device.<span class="title function_">setBrightnessMode</span>(<span class="number">0</span>) <span class="comment">// 手动亮度模式</span></span><br><span class="line">    device.<span class="title function_">setBrightness</span>(<span class="variable constant_">SCREEN_BRIGHTNESS</span>)</span><br><span class="line">    device.<span class="title function_">wakeUpIfNeeded</span>() <span class="comment">// 唤醒设备</span></span><br><span class="line">    device.<span class="title function_">keepScreenOn</span>()   <span class="comment">// 保持亮屏</span></span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>) <span class="comment">// 等待屏幕亮起</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!device.<span class="title function_">isScreenOn</span>()) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;设备未唤醒, 重试&quot;</span>)</span><br><span class="line">        device.<span class="title function_">wakeUpIfNeeded</span>()</span><br><span class="line">        <span class="title function_">brightScreen</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;设备已唤醒&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 解锁屏幕</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">unlockScreen</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;解锁屏幕&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isDeviceLocked</span>()) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">gesture</span>(</span><br><span class="line">            <span class="number">320</span>, <span class="comment">// 滑动时间：毫秒</span></span><br><span class="line">            [</span><br><span class="line">                device.<span class="property">width</span>  * <span class="number">0.5</span>,    <span class="comment">// 滑动起点 x 坐标：屏幕宽度的一半</span></span><br><span class="line">                device.<span class="property">height</span> * <span class="number">0.9</span>     <span class="comment">// 滑动起点 y 坐标：距离屏幕底部 10% 的位置, 华为系统需要往上一些</span></span><br><span class="line">            ],</span><br><span class="line">            [</span><br><span class="line">                device.<span class="property">width</span> / <span class="number">2</span>,       <span class="comment">// 滑动终点 x 坐标：屏幕宽度的一半</span></span><br><span class="line">                device.<span class="property">height</span> * <span class="number">0.1</span>     <span class="comment">// 滑动终点 y 坐标：距离屏幕顶部 10% 的位置</span></span><br><span class="line">            ]</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>) <span class="comment">// 等待解锁动画完成</span></span><br><span class="line">        <span class="title function_">home</span>()</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>) <span class="comment">// 等待返回动画完成</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isDeviceLocked</span>()) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;上滑解锁失败, 请按脚本中的注释调整 gesture(time, [x1,y1], [x2,y2]) 方法的参数!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;屏幕已解锁&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 随机等待</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">holdOn</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!needWaiting) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> randomTime = <span class="title function_">random</span>(<span class="variable constant_">LOWER_BOUND</span>, <span class="variable constant_">UPPER_BOUND</span>)</span><br><span class="line">    <span class="title function_">toastLog</span>(<span class="title class_">Math</span>.<span class="title function_">floor</span>(randomTime / <span class="number">1000</span>) + <span class="string">&quot;秒后启动&quot;</span> + app.<span class="title function_">getAppName</span>(<span class="variable constant_">PACKAGE_ID_DD</span>) + <span class="string">&quot;...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(randomTime)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 启动并登陆钉钉</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">signIn</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    app.<span class="title function_">launchPackage</span>(<span class="variable constant_">PACKAGE_ID_DD</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在启动&quot;</span> + app.<span class="title function_">getAppName</span>(<span class="variable constant_">PACKAGE_ID_DD</span>) + <span class="string">&quot;...&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">setVolume</span>(<span class="number">0</span>) <span class="comment">// 设备静音</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">10000</span>) <span class="comment">// 等待钉钉启动</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">currentPackage</span>() == <span class="variable constant_">PACKAGE_ID_DD</span> &amp;&amp;</span><br><span class="line">        <span class="title function_">currentActivity</span>() == <span class="string">&quot;com.alibaba.android.user.login.SignUpWithPwdActivity&quot;</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;账号未登录&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> account = <span class="title function_">id</span>(<span class="string">&quot;et_phone_input&quot;</span>).<span class="title function_">findOne</span>()</span><br><span class="line">        account.<span class="title function_">setText</span>(<span class="variable constant_">ACCOUNT</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;输入账号&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> password = <span class="title function_">id</span>(<span class="string">&quot;et_pwd_login&quot;</span>).<span class="title function_">findOne</span>()</span><br><span class="line">        password.<span class="title function_">setText</span>(<span class="variable constant_">PASSWORD</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;输入密码&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> privacy = <span class="title function_">id</span>(<span class="string">&quot;cb_privacy&quot;</span>).<span class="title function_">findOne</span>()</span><br><span class="line">        privacy.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;同意隐私协议&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> btn_login = <span class="title function_">id</span>(<span class="string">&quot;btn_next&quot;</span>).<span class="title function_">findOne</span>()</span><br><span class="line">        btn_login.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在登陆...&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">3000</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">currentPackage</span>() == <span class="variable constant_">PACKAGE_ID_DD</span> &amp;&amp;</span><br><span class="line">        <span class="title function_">currentActivity</span>() != <span class="string">&quot;com.alibaba.android.user.login.SignUpWithPwdActivity&quot;</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;账号已登录&quot;</span>)</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 处理迟到打卡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleLate</span>(<span class="params"></span>)&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textMatches</span>(<span class="string">&quot;迟到打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        btn_late = <span class="title function_">textMatches</span>(<span class="string">&quot;迟到打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>() </span><br><span class="line">        btn_late.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;迟到打卡&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">descMatches</span>(<span class="string">&quot;迟到打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        btn_late = <span class="title function_">descMatches</span>(<span class="string">&quot;迟到打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>() </span><br><span class="line">        btn_late.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;迟到打卡&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 使用 URL Scheme 进入考勤界面</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">attendKaoqin</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> url_scheme = <span class="string">&quot;dingtalk://dingtalkclient/page/link?url=https://attend.dingtalk.com/attend/index.html&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable constant_">CORP_ID</span> != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">        url_scheme = url_scheme + <span class="string">&quot;?corpId=&quot;</span> + <span class="variable constant_">CORP_ID</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> a = app.<span class="title function_">intent</span>(&#123;</span><br><span class="line">        <span class="attr">action</span>: <span class="string">&quot;VIEW&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: url_scheme,</span><br><span class="line">        <span class="comment">//flags: [Intent.FLAG_ACTIVITY_NEW_TASK]</span></span><br><span class="line">    &#125;);</span><br><span class="line">    app.<span class="title function_">startActivity</span>(a);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在进入考勤界面...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">textContains</span>(<span class="string">&quot;申请&quot;</span>).<span class="title function_">waitFor</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;已进入考勤界面&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 上班打卡 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clockIn</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;上班打卡...&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textContains</span>(<span class="string">&quot;已打卡&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;已打卡&quot;</span>)</span><br><span class="line">        <span class="title function_">toast</span>(<span class="string">&quot;已打卡&quot;</span>)</span><br><span class="line">        <span class="title function_">home</span>()</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;等待连接到考勤机...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textContains</span>(<span class="string">&quot;未连接&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;未连接考勤机, 重新进入考勤界面!&quot;</span>)</span><br><span class="line">        <span class="title function_">back</span>()</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">        <span class="title function_">attendKaoqin</span>()</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">textContains</span>(<span class="string">&quot;已连接&quot;</span>).<span class="title function_">waitFor</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;已连接考勤机&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textMatches</span>(<span class="string">&quot;上班打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        btn_clockin = <span class="title function_">textMatches</span>(<span class="string">&quot;上班打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>()</span><br><span class="line">        btn_clockin.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;按下打卡按钮&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">click</span>(device.<span class="property">width</span> / <span class="number">2</span>, device.<span class="property">height</span> * <span class="number">0.560</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;点击打卡按钮坐标&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    <span class="title function_">handleLate</span>() <span class="comment">// 处理迟到打卡</span></span><br><span class="line">    </span><br><span class="line">    <span class="title function_">home</span>()</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 下班打卡 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clockOut</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;下班打卡...&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;等待连接到考勤机...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textContains</span>(<span class="string">&quot;未连接&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;未连接考勤机, 重新进入考勤界面!&quot;</span>)</span><br><span class="line">        <span class="title function_">back</span>()</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">        <span class="title function_">attendKaoqin</span>()</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">textContains</span>(<span class="string">&quot;已连接&quot;</span>).<span class="title function_">waitFor</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;已连接考勤机&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textMatches</span>(<span class="string">&quot;下班打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        btn_clockout = <span class="title function_">textMatches</span>(<span class="string">&quot;下班打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>()</span><br><span class="line">        btn_clockout.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;按下打卡按钮&quot;</span>)</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">click</span>(device.<span class="property">width</span> / <span class="number">2</span>, device.<span class="property">height</span> * <span class="number">0.560</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;点击打卡按钮坐标&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textContains</span>(<span class="string">&quot;早退打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        <span class="title function_">className</span>(<span class="string">&quot;android.widget.Button&quot;</span>).<span class="title function_">text</span>(<span class="string">&quot;早退打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>().<span class="title function_">parent</span>().<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;早退打卡&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">home</span>()</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 锁屏</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">lockScreen</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;关闭屏幕&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 锁屏方案1：Root</span></span><br><span class="line">    <span class="comment">// Power()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 锁屏方案2：No Root</span></span><br><span class="line">    <span class="comment">// press(Math.floor(device.width / 2), Math.floor(device.height * 0.973), 1000) // 小米的快捷手势：长按Home键锁屏</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 万能锁屏方案：向Tasker发送广播, 触发系统锁屏动作。配置方法见 2021-03-09 更新日志</span></span><br><span class="line">    app.<span class="title function_">sendBroadcast</span>(&#123;<span class="attr">action</span>: <span class="variable constant_">ACTION_LOCK_SCREEN</span>&#125;);</span><br><span class="line"></span><br><span class="line">    device.<span class="title function_">setBrightnessMode</span>(<span class="number">1</span>) <span class="comment">// 自动亮度模式</span></span><br><span class="line">    device.<span class="title function_">cancelKeepingAwake</span>() <span class="comment">// 取消设备常亮</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isDeviceLocked</span>()) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;屏幕已关闭&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;屏幕未关闭, 请尝试其他锁屏方案, 或等待屏幕自动关闭&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ===================== ↓↓↓ 功能函数 ↓↓↓ =======================</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">dateDigitToString</span>(<span class="params">num</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> num &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + num : num</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getCurrentTime</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> currentDate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">    <span class="keyword">var</span> hours = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getHours</span>())</span><br><span class="line">    <span class="keyword">var</span> minute = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getMinutes</span>())</span><br><span class="line">    <span class="keyword">var</span> second = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getSeconds</span>())</span><br><span class="line">    <span class="keyword">var</span> formattedTimeString = hours + <span class="string">&#x27;:&#x27;</span> + minute + <span class="string">&#x27;:&#x27;</span> + second</span><br><span class="line">    <span class="keyword">return</span> formattedTimeString</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getCurrentDate</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> currentDate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">    <span class="keyword">var</span> year = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getFullYear</span>())</span><br><span class="line">    <span class="keyword">var</span> month = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getMonth</span>() + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">var</span> date = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getDate</span>())</span><br><span class="line">    <span class="keyword">var</span> week = currentDate.<span class="title function_">getDay</span>()</span><br><span class="line">    <span class="keyword">var</span> formattedDateString = year + <span class="string">&#x27;-&#x27;</span> + month + <span class="string">&#x27;-&#x27;</span> + date + <span class="string">&#x27;-&#x27;</span> + <span class="variable constant_">WEEK_DAY</span>[week]</span><br><span class="line">    <span class="keyword">return</span> formattedDateString</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通知过滤器</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">filterNotification</span>(<span class="params">bundleId, abstract, text</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> check = <span class="variable constant_">PACKAGE_ID_WHITE_LIST</span>.<span class="title function_">some</span>(<span class="keyword">function</span>(<span class="params">item</span>) &#123;<span class="keyword">return</span> bundleId == item&#125;) </span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable constant_">NOTIFICATIONS_FILTER</span> || check) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">verbose</span>(bundleId)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">verbose</span>(abstract)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">verbose</span>(text)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">verbose</span>(<span class="string">&quot;---------------------------&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 保存本地数据</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setStorageData</span>(<span class="params">name, key, value</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> storage = storages.<span class="title function_">create</span>(name)  <span class="comment">// 创建storage对象</span></span><br><span class="line">    storage.<span class="title function_">put</span>(key, value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取本地数据</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getStorageData</span>(<span class="params">name, key</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> storage = storages.<span class="title function_">create</span>(name)</span><br><span class="line">    <span class="keyword">if</span> (storage.<span class="title function_">contains</span>(key)) &#123;</span><br><span class="line">        <span class="keyword">return</span> storage.<span class="title function_">get</span>(key, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 默认返回undefined</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除本地数据</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">delStorageData</span>(<span class="params">name, key</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> storage = storages.<span class="title function_">create</span>(name)</span><br><span class="line">    <span class="keyword">if</span> (storage.<span class="title function_">contains</span>(key)) &#123;</span><br><span class="line">        storage.<span class="title function_">remove</span>(key)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取应用版本号</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getPackageVersion</span>(<span class="params">bundleId</span>) &#123;</span><br><span class="line">    <span class="title function_">importPackage</span>(android.<span class="property">content</span>)</span><br><span class="line">    <span class="keyword">var</span> pckMan = context.<span class="title function_">getPackageManager</span>()</span><br><span class="line">    <span class="keyword">var</span> packageInfo = pckMan.<span class="title function_">getPackageInfo</span>(bundleId, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> packageInfo.<span class="property">versionName</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 屏幕是否为锁定状态</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isDeviceLocked</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">importClass</span>(android.<span class="property">app</span>.<span class="property">KeyguardManager</span>)</span><br><span class="line">    <span class="title function_">importClass</span>(android.<span class="property">content</span>.<span class="property">Context</span>)</span><br><span class="line">    <span class="keyword">var</span> km = context.<span class="title function_">getSystemService</span>(<span class="title class_">Context</span>.<span class="property">KEYGUARD_SERVICE</span>)</span><br><span class="line">    <span class="keyword">return</span> km.<span class="title function_">isKeyguardLocked</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置媒体和通知音量</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setVolume</span>(<span class="params">volume</span>) &#123;</span><br><span class="line">    device.<span class="title function_">setMusicVolume</span>(volume)</span><br><span class="line">    device.<span class="title function_">setNotificationVolume</span>(volume)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">verbose</span>(<span class="string">&quot;媒体音量:&quot;</span> + device.<span class="title function_">getMusicVolume</span>())</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">verbose</span>(<span class="string">&quot;通知音量:&quot;</span> + device.<span class="title function_">getNotificationVolume</span>())</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="📐-工具介绍"><a href="#📐-工具介绍" class="headerlink" title="📐 工具介绍"></a>📐 工具介绍</h2><h3 id="Auto-js"><a href="#Auto-js" class="headerlink" title="Auto.js"></a>Auto.js</h3><p>Auto.js 是利用安卓系统的 「无障碍服务」 实现类似于按键精灵一样，可以通过代码模拟一系列界面动作的辅助工具。</p>
<p>与 「按键精灵」 不同的是，它的模拟动作并不是简单的使用在界面定坐标点来实现，而是找控件来实现的。</p>
<p>免费版：<a target="_blank" rel="noopener" href="https://github.com/georgehuan1994/DingDing-Automatic-Clock-in/raw/master/Autojs%204.1.1a%20Alpha2-armeabi-v7a-release.apk" title="Auto.js 4.1.1a Alpha2-armeabi-v7a-release">Auto.js 4.1.1a Alpha2-armeabi-v7a-release</a></p>
<p>github：<a target="_blank" rel="noopener" href="https://github.com/hyb1996/Auto.js">GitHub - hyb1996&#x2F;Auto.js</a></p>
<p>官方文档：<a target="_blank" rel="noopener" href="https://hyb1996.github.io/AutoJs-Docs/">首页 - Auto.js</a></p>
<p>推荐使用<a target="_blank" rel="noopener" href="https://github.com/hyb1996/Auto.js-VSCode-Extension">VS Code 插件</a>进行调试，调试完成后，还能通过此插件将脚本保存到手机上。</p>
<h3 id="Tasker"><a href="#Tasker" class="headerlink" title="Tasker"></a>Tasker</h3><p><a target="_blank" rel="noopener" href="https://play.google.com/store/apps/details?id=net.dinglisch.android.taskerm">Tasker</a> 也是一个安卓自动化神器，与 Auto.js 结合使用可胜任日常工作流。</p>
<p>此处仅提供 Tasker 5.0 及以下的官方原版，原版不含正版验证，使用不受限制：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/georgehuan1994/DingDing-Automatic-Clock-in/blob/master/Tasker.4.9u4m.apk">Tasker.4.9u4m.apk</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/georgehuan1994/DingDing-Automatic-Clock-in/blob/master/Tasker.5.0u7m.apk">Tasker.5.0u7m.apk</a></p>
<p>Tasker 定时打卡配置：</p>
<ol>
<li>添加一个 「通知」 操作任务，通知标题修改为 「定时打卡」，通知文字随意，通知优先级设为 1。</li>
<li>添加两个配置文件，使用日期和时间作为条件，分别在上班前和下班后触发。</li>
</ol>
<p>你也可以<a target="_blank" rel="noopener" href="https://github.com/georgehuan1994/DingDing-Automatic-Clock-in/tree/master/Tasker%E9%85%8D%E7%BD%AE">下载配置文件</a>，导入到 Tasker 中使用，方法如下：</p>
<ol>
<li>长按 菜单栏-任务，导入”发送通知.tsk.xml”。</li>
<li>长按 菜单栏-配置文件，导入”上班打卡.prf.xml” 和 “下班打卡.prf.xml”。</li>
<li>在任务编辑界面左下方有一个三角形的播放按钮，点击即可发送通知，方便调试。</li>
</ol>
<h2 id="🕹️-使用方法"><a href="#🕹️-使用方法" class="headerlink" title="🕹️ 使用方法"></a>🕹️ 使用方法</h2><h3 id="远程打卡"><a href="#远程打卡" class="headerlink" title="远程打卡"></a>远程打卡</h3><ul>
<li>向本机的 QQ 发送消息 「打卡」，或回复标题为 「打卡」 的邮件，或向 PushDeer 发送标题为「打卡」 的推送请求，即可触发打卡进程。</li>
<li>向本机的 QQ 发送消息 「查询」，或回复标题为 「查询」 的邮件，或向 PushDeer 发送标题为「查询」 的推送请求，即可查询最新一次打卡结果。</li>
</ul>
<h3 id="暂停-恢复定时打卡"><a href="#暂停-恢复定时打卡" class="headerlink" title="暂停&#x2F;恢复定时打卡"></a>暂停&#x2F;恢复定时打卡</h3><ul>
<li>向本机的 QQ 发送消息 「暂停」，或回复标题为 「暂停」 的邮件，或向 PushDeer 发送标题为「暂停」 的推送请求，即可暂停定时打卡功能（仅暂停定时打卡，不影响远程打卡功能）</li>
<li>向本机的 QQ 发送消息 「恢复」，或回复标题为 「恢复」 的邮件，或向 PushDeer 发送标题为「恢复」 的推送请求，即可恢复定时打卡功能。</li>
</ul>
<h2 id="⚠️-注意事项-必读"><a href="#⚠️-注意事项-必读" class="headerlink" title="⚠️ 注意事项 (必读!!!)"></a>⚠️ 注意事项 (必读!!!)</h2><ul>
<li>AutoJs Pro 版本屏蔽了一些主流应用，如果要使用 QQ 作为回复方式，不要使用 AutoJs Pro 版！</li>
<li>首次启动 AutoJs，需要为其开启无障碍权限。</li>
<li>运行脚本前，请在 AutoJs 菜单栏中（从屏幕左边划出），开启 「通知读取权限」。</li>
<li>若无法通过 <code>app.launchPackage()</code> 方法启动应用，请开启该应用的「自启动」「允许后台弹窗」。</li>
<li>AutoJs、Tasker 可息屏运行，需要在系统设置中开启通知亮屏。</li>
<li>为保证 AutoJs、Tasker 进程不被系统清理，可调整它们的电池管理策略、加入管理应用的白名单，为其开启前台服务、添加应用锁…</li>
<li>虽然脚本可执行完整的打卡步骤，但推荐开启钉钉的极速打卡功能，在钉钉启动时即可完成打卡，应把后续的步骤视为极速打卡失败后的保险措施。</li>
</ul>
<h2 id="📜-更新日志"><a href="#📜-更新日志" class="headerlink" title="📜 更新日志"></a>📜 更新日志</h2><h3 id="2022-03-26"><a href="#2022-03-26" class="headerlink" title="2022-03-26"></a>2022-03-26</h3><details open>
<summary></summary>

<ol>
<li>可以通过 PushDeer 接收通知、推送考勤结果</details></li>
</ol>
<h3 id="2022-03-01"><a href="#2022-03-01" class="headerlink" title="2022-03-01"></a>2022-03-01</h3><details open>
<summary></summary>

<ol>
<li>可以通过Server酱来推送考勤结果</details></li>
</ol>
<h3 id="2021-10-23"><a href="#2021-10-23" class="headerlink" title="2021-10-23"></a>2021-10-23</h3><details open>
<summary></summary>

<ol>
<li>适配网易邮箱大师7.0</details></li>
</ol>
<h3 id="2021-09-02"><a href="#2021-09-02" class="headerlink" title="2021-09-02"></a>2021-09-02</h3><details open>
<summary></summary>

<ol>
<li>新增获取日志功能，发送 「日志」，可将运行日志作为邮件附件发送（最好使用内置邮件）</li>
<li>优化通知过滤器，过滤 Tasker 发出的无效通知</details></li>
</ol>
<h3 id="2021-07-07"><a href="#2021-07-07" class="headerlink" title="2021-07-07"></a>2021-07-07</h3><details open>
<summary></summary>

<ol>
<li>登录流程自动同意隐私协议</details></li>
</ol>
<h3 id="2021-05-27"><a href="#2021-05-27" class="headerlink" title="2021-05-27"></a>2021-05-27</h3><details open>
<summary></summary>

<ol>
<li>修改了部分常量的命名</li>
<li>移除了休息日不打卡的判断</li>
<li>在邮件的基础上，增加QQ作为新的通讯方式。除发送考勤结果需要手动指定应用外，使用QQ向本机发送 「查询、暂停、恢复」 指令，则会用QQ来回复查询或操作结果；使用邮件向本机发送指令则用邮件回复。</details></li>
</ol>
<h3 id="2021-05-06"><a href="#2021-05-06" class="headerlink" title="2021-05-06"></a>2021-05-06</h3><details open>
<summary></summary>

<ol>
<li>增加音量上键监听，按下后中断所有子线程，也可以利用回调来进行调试</li>
<li>不再使用考勤机名称来判断连接状态</li>
<li>重新进入打卡界面前，先返回上级菜单，以解决顶号登录无法正常连接到考勤机的问题</li>
<li>启动钉钉时，将媒体音量和通知音量设为0</details></li>
</ol>
<h3 id="2021-03-15"><a href="#2021-03-15" class="headerlink" title="2021-03-15"></a>2021-03-15</h3><details open>
<summary></summary>

<ol>
<li>运行时检查Auto.js版本，脚本需要在Auto.js 4.1.0及以上版本中运行</li>
<li>新增解锁是否成功的判断，若解锁失败则停止运行脚本</li>
<li>优化 <code>signIn()</code> 方法，使用 bundleId + activity 来判断登录情况</li>
<li>优化部分控件和信息的获取方式</details></li>
</ol>
<h3 id="2021-03-09"><a href="#2021-03-09" class="headerlink" title="2021-03-09"></a>2021-03-09</h3><details open>
<summary></summary>

<ol>
<li><p>移除 「结束钉钉」、「检查更新」 这个两个过程，使用最近一次监测到的正在运行的应用的包名进行判断</p>
</li>
<li><p>补充一个万能锁屏方案：向Tasker发送广播，触发Tasker中的系统锁屏操作。</p>
<ul>
<li>在Tasker中添加一个任务，在任务中添加操作 「系统锁屏（关闭屏幕）」</li>
<li>在Tasker中添加一个事件类型的配置文件，事件类别：系统-收到的意图</li>
<li>在事件操作中填写：autojs.intent.action.LOCK_SCREEN ，保持发送方与接收方的action一致即可</li>
</ul>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">sendBroadcast</span>(&#123;</span><br><span class="line">        <span class="attr">action</span>: <span class="string">&#x27;autojs.intent.action.LOCK_SCREEN&#x27;</span></span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
</details>

<h3 id="2021-02-07"><a href="#2021-02-07" class="headerlink" title="2021-02-07"></a>2021-02-07</h3><details open>
<summary></summary>

<ol>
<li>防止监听事件被耗时操作阻塞。</details></li>
</ol>
<h3 id="2021-01-15"><a href="#2021-01-15" class="headerlink" title="2021-01-15"></a>2021-01-15</h3><details open>
<summary></summary> 

<ol>
<li>移除 「进入工作台」 以及 「进入考勤打卡界面」 这两个过程</li>
<li>启动并成功登录钉钉后，直接使用intent拉起考勤打卡界面</details></li>
</ol>
<h3 id="2021-01-08"><a href="#2021-01-08" class="headerlink" title="2021-01-08"></a>2021-01-08</h3><details open>
<summary></summary>

<ol>
<li>修复：通知过滤器报错</details></li>
</ol>
<h3 id="2020-12-30"><a href="#2020-12-30" class="headerlink" title="2020-12-30"></a>2020-12-30</h3><details open>
<summary></summary>

<ol>
<li>优化：现在可以通过邮件来 暂停&#x2F;恢复 定时打卡功能，以应对停工停产，或其他需要暂时停止定时打卡的特殊情况</details></li>
</ol>
<h3 id="2020-12-04"><a href="#2020-12-04" class="headerlink" title="2020-12-04"></a>2020-12-04</h3><details open>
<summary></summary>

<ol>
<li>优化：打卡过程在子线程中执行，钉钉返回打卡结果后，直接中断子线程，减少无效操作</details></li>
</ol>
<h3 id="2020-10-27"><a href="#2020-10-27" class="headerlink" title="2020-10-27"></a>2020-10-27</h3><details open>
<summary></summary>

<ol>
<li>修复：当钉钉的通知文本为null时，indexOf()方法无法正常执行</details></li>
</ol>
<h3 id="2020-09-24"><a href="#2020-09-24" class="headerlink" title="2020-09-24"></a>2020-09-24</h3><details open>
<summary></summary>

<ol>
<li>优化：使用URL Scheme直接拉起考勤打卡界面</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">attendKaoqin</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> a = app.<span class="title function_">intent</span>(&#123;</span><br><span class="line">        <span class="attr">action</span>: <span class="string">&quot;VIEW&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: <span class="string">&quot;dingtalk://dingtalkclient/page/link?url=https://attend.dingtalk.com/attend/index.html&quot;</span></span><br><span class="line">      &#125;);</span><br><span class="line">      app.<span class="title function_">startActivity</span>(a);</span><br><span class="line">      <span class="title function_">sleep</span>(<span class="number">5000</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="获取URL的方式如下："><a href="#获取URL的方式如下：" class="headerlink" title="获取URL的方式如下："></a>获取URL的方式如下：</h4><ol>
<li>在PC端找到 「智能工作助理」 联系人</li>
<li>发送消息 “打卡” ，点击 「立即打卡」 </li>
<li>弹出一个二维码。此二维码就是拉起考勤打卡界面的 URL，用自带的相机或其他应用扫描，并在浏览器中打开，即可获得完整URL</li>
<li>观察获取到的URL，找到 <code>CorpId=xxxxxxxxxxxxxxxxxxx</code> ，将CorpId的值填写到的脚本开头的CORP_ID这个常量中</li>
<li>仅使用 <code>dingtalk://dingtalkclient/page/link?url=https://attend.dingtalk.com/attend/index.html</code>，也可以拉起旧版打卡界面，钉钉会自动获取企业的CorpId。如果加入了多个组织，且没有填写CorpId，则在拉起考勤界面时会弹出一个选择组织的对话框。</details></li>
</ol>
<h3 id="2020-09-11"><a href="#2020-09-11" class="headerlink" title="2020-09-11"></a>2020-09-11</h3><details open>
<summary></summary>

<ol>
<li>将上次考勤结果储存在本地</li>
<li>将运行日志储存在本地 &#x2F;sdcard&#x2F;脚本&#x2F;Archive&#x2F;</li>
<li>修复在下班极速打卡之后，重复打卡的问题</details></li>
</ol>
<h3 id="2020-09-04"><a href="#2020-09-04" class="headerlink" title="2020-09-04"></a>2020-09-04</h3><details open>
<summary></summary>

<ol>
<li>将 “打卡” 与 “发送邮件” 分离成两个过程，打卡完成后，将钉钉返回的考勤结果作为邮件正文发送</details open></li>
</ol>
<h3 id="2020-09-02"><a href="#2020-09-02" class="headerlink" title="2020-09-02"></a>2020-09-02</h3><details open>
<summary></summary>

<ol>
<li>改为使用 “去打卡” 文本获取按钮。若找不到 “去打卡” 按钮，则直接点击 “考勤打卡” 的屏幕坐标</details></li>
</ol>
<h2 id="📢-声明"><a href="#📢-声明" class="headerlink" title="📢 声明"></a>📢 声明</h2><p>此仓库及脚本仅供学习交流，欢迎转载。旨在让人们关注996制度的存在和非法性，并尝试改变这种现象。</p>
<p>根据1994年第八届全国人大常委会通过和2018年第十三届全国人大常委会修正的《中华人民共和国劳动法》规定，劳动者<strong>每日工作时间不超过8小时，平均每周工作时间不超过44小时，而996工作制每周至少要工作72个小时</strong>，远超法律标准，因此996工作制度违反劳动法。</p>
<p><font color=red>而钉钉却允许企业管理者违反法律，非法排班！</font> </p>
<blockquote>

<p><strong>第三十六条</strong>　国家实行劳动者每日工作时间不超过八小时、平均每周工作时间不超过四十四小时的工时制度。</p>
<p><strong>第四十一条</strong>　用人单位由于生产经营需要，经与工会和劳动者协商后可以延长工作时间，一般每日不得超过一小时；因特殊原因需要延长工作时间的，在保障劳动者身体健康的条件下延长工作时间每日不得超过三小时，但是每月不得超过三十六小时。</p>
<p><strong>第四十四条</strong>　有下列情形之一的，用人单位应当按照下列标准支付高于劳动者正常工作时间工资的工资报酬：</p>
<p>（一）安排劳动者延长工作时间的，支付不低于工资的百分之一百五十的工资报酬；<br>（二）休息日安排劳动者工作又不能安排补休的，支付不低于工资的百分之二百的工资报酬；<br>（三）法定休假日安排劳动者工作的，支付不低于工资的百分之三百的工资报酬。  </p>
<p><strong>第九十条</strong>　用人单位违反本法规定，延长劳动者工作时间的，由劳动行政部门给予警告，责令改正，并可以处以罚款。</p>
<p><strong>第九十一条</strong>　用人单位有下列侵害劳动者合法权益情形之一的，由劳动行政部门责令支付劳动者的工资报酬、经济补偿，并可以责令支付赔偿金：</p>
<p>（二）拒不支付劳动者延长工作时间工资报酬的；</p>
</blockquote>

<p>相关项目：<a target="_blank" rel="noopener" href="https://github.com/georgehuan1994/996-Salary-Calculator">996 薪资计算助手</a></p>
<hr>
<pre><code>如果觉得还不错的话，就点击右上角, 给我个Star ⭐️ 鼓励一下我吧~
</code></pre>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/09/16/%E8%84%9A%E6%9C%AC/DingDing-Automatic-Clock-in-master/DingDing-Automatic-Clock-in/">钉钉全自动打卡</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-09-17</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%84%9A%E6%9C%AC/">脚本</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/autojs/">autojs</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E9%92%89%E9%92%89/">钉钉</a></span><div class="content"><h1 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h1><p>本篇文章为摘录自GitHub，自己修改了部分代码，仅作为参考，详见原文</p>
<h2 id="⏰-定时脚本"><a href="#⏰-定时脚本" class="headerlink" title="⏰ 定时脚本"></a>⏰ 定时脚本</h2><p>同时兼容定时和通知两种功能</p>
<ul>
<li>发送 “开启循环” 开启定时功能</li>
<li>发送 “关闭循环” 关闭定时功能</li>
<li>修正 “日志” 功能BUG，发送日志文件到邮箱中</li>
<li>添加 “连接” 功能，实现远程连接电脑 AutoJs Server</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * @Author: George Huan</span></span><br><span class="line"><span class="comment"> * @Date: 2020-08-03 09:30:30</span></span><br><span class="line"><span class="comment"> * @LastEditTime: 2022-03-26 10:56:25</span></span><br><span class="line"><span class="comment"> * @Description: DingDing-Automatic-Clock-in (Run on AutoJs)</span></span><br><span class="line"><span class="comment"> * @URL: https://github.com/georgehuan1994/DingDing-Automatic-Clock-in</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">ACCOUNT</span> = <span class="string">&quot;15868141080&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PASSWORD</span> = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">QQ</span> =              <span class="string">&quot;2757412961&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">EMAILL_ADDRESS</span> =  <span class="string">&quot;2757412961@qq.com&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SERVER_CHAN</span> =     <span class="string">&quot;SCT171904TfSMLDvHz2oGuB8NU9NdMg1W0&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PUSH_DEER</span> =       <span class="string">&quot;PushDeer发送密钥&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PUSH_METHOD</span> = &#123;<span class="attr">QQ</span>: <span class="number">1</span>, <span class="title class_">Email</span>: <span class="number">2</span>, <span class="title class_">ServerChan</span>: <span class="number">3</span>, <span class="title class_">PushDeer</span>: <span class="number">4</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认通信方式：</span></span><br><span class="line"><span class="comment">// PUSH_METHOD.QQ -- QQ</span></span><br><span class="line"><span class="comment">// PUSH_METHOD.Email -- Email </span></span><br><span class="line"><span class="comment">// PUSH_METHOD.ServerChan -- Server酱</span></span><br><span class="line"><span class="comment">// PUSH_METHOD.PushDeer -- Push Deer</span></span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span> = <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_QQ</span> = <span class="string">&quot;com.tencent.mobileqq&quot;</span>                <span class="comment">// QQ</span></span><br><span class="line"><span class="comment">// const PACKAGE_ID_DD = &quot;com.alibaba.android.rimet&quot;           // 钉钉</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_DD</span> = <span class="string">&quot;com.alibaba.android.rimet.zju&quot;</span>       <span class="comment">// 浙大钉</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_XMSF</span> = <span class="string">&quot;com.xiaomi.xmsf&quot;</span>                   <span class="comment">// 小米推送服务</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_TASKER</span> = <span class="string">&quot;net.dinglisch.android.taskerm&quot;</span>   <span class="comment">// Tasker</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_MAIL_163</span> = <span class="string">&quot;com.netease.mail&quot;</span>              <span class="comment">// 网易邮箱大师</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_MAIL_ANDROID</span> = <span class="string">&quot;com.android.email&quot;</span>         <span class="comment">// 系统内置邮箱</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_PUSHDEER</span> = <span class="string">&quot;com.pushdeer.os&quot;</span>               <span class="comment">// Push Deer</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">LOWER_BOUND</span> = <span class="number">1</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 最小等待时间：1min</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">UPPER_BOUND</span> = <span class="number">5</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 最大等待时间：5min</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">ONE_MIN</span> = <span class="number">1</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 等待时间：1min</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">FIF_MIN</span> = <span class="number">15</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 等待时间：0.5h</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">HALF_AN_HOUR</span> = <span class="number">30</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 等待时间：0.5h</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">AN_HOUR</span> = <span class="number">1</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 等待时间：1h</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行时的屏幕亮度（0-255）, 需要&quot;修改系统设置&quot;权限</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SCREEN_BRIGHTNESS</span> = <span class="number">20</span>    </span><br><span class="line"></span><br><span class="line"><span class="comment">// 是否过滤通知</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">NOTIFICATIONS_FILTER</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// PackageId白名单</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_WHITE_LIST</span> = [<span class="variable constant_">PACKAGE_ID_QQ</span>,<span class="variable constant_">PACKAGE_ID_DD</span>,<span class="variable constant_">PACKAGE_ID_XMSF</span>,<span class="variable constant_">PACKAGE_ID_MAIL_163</span>,<span class="variable constant_">PACKAGE_ID_TASKER</span>,<span class="variable constant_">PACKAGE_ID_PUSHDEER</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 公司的钉钉CorpId, 获取方法见 2020-09-24 更新日志。如果只加入了一家公司, 可以不填</span></span><br><span class="line"><span class="comment">// dingtalk://dingtalkclient/page/link?url=&#x27;https://attend.dingtalk.com/attend/index.html?corpId=dingca07f56daee3def1bc961a6cb783455b&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CORP_ID</span> = <span class="string">&quot;dingca07f56daee3def1bc961a6cb783455b&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">// 锁屏意图, 配合 Tasker 完成锁屏动作, 具体配置方法见 2021-03-09 更新日志</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">ACTION_LOCK_SCREEN</span> = <span class="string">&quot;autojs.intent.action.LOCK_SCREEN&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听音量+键, 开启后无法通过音量+键调整音量, 按下音量+键：结束所有子线程</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">OBSERVE_VOLUME_KEY</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">WEEK_DAY</span> = [<span class="string">&quot;Sunday&quot;</span>,<span class="string">&quot;Monday&quot;</span>,<span class="string">&quot;Tuesday&quot;</span>,<span class="string">&quot;Wednesday&quot;</span>,<span class="string">&quot;Thursday&quot;</span>,<span class="string">&quot;Friday&quot;</span>,<span class="string">&quot;Saturday&quot;</span>,]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// =================== ↓↓↓ 主线程：监听通知 ↓↓↓ ====================</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> currentDate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 是否暂停循环打卡</span></span><br><span class="line"><span class="keyword">var</span> recursiveCard = <span class="literal">false</span></span><br><span class="line"><span class="keyword">var</span> timeAnchorPoints = [<span class="number">8</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">22</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 是否暂停定时打卡</span></span><br><span class="line"><span class="keyword">var</span> suspend = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 本次打开钉钉前是否需要等待</span></span><br><span class="line"><span class="keyword">var</span> needWaiting = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 运行日志路径</span></span><br><span class="line"><span class="keyword">var</span> globalLogFilePath = <span class="string">&quot;/sdcard/脚本/Archive/&quot;</span> + <span class="title function_">getCurrentDate</span>() + <span class="string">&quot;-log.txt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查无障碍权限</span></span><br><span class="line">auto.<span class="title function_">waitFor</span>(<span class="string">&quot;normal&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查Autojs版本</span></span><br><span class="line"><span class="title function_">requiresAutojsVersion</span>(<span class="string">&quot;4.1.0&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建运行日志</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">setGlobalLogConfig</span>(&#123;</span><br><span class="line">    <span class="attr">file</span>: <span class="string">&quot;/sdcard/脚本/Archive/&quot;</span> + <span class="title function_">getCurrentDate</span>() + <span class="string">&quot;-log.txt&quot;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听本机通知</span></span><br><span class="line">events.<span class="title function_">observeNotification</span>()    </span><br><span class="line">events.<span class="title function_">on</span>(<span class="string">&quot;notification&quot;</span>, <span class="keyword">function</span>(<span class="params">n</span>) &#123;</span><br><span class="line">    <span class="title function_">notificationHandler</span>(n)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">events.<span class="title function_">setKeyInterceptionEnabled</span>(<span class="string">&quot;volume_up&quot;</span>, <span class="variable constant_">OBSERVE_VOLUME_KEY</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable constant_">OBSERVE_VOLUME_KEY</span>) &#123;</span><br><span class="line">    events.<span class="title function_">observeKey</span>()</span><br><span class="line">&#125;;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 监听音量+键</span></span><br><span class="line">events.<span class="title function_">onKeyDown</span>(<span class="string">&quot;volume_up&quot;</span>, <span class="keyword">function</span>(<span class="params">event</span>)&#123;</span><br><span class="line">    threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">    device.<span class="title function_">setBrightnessMode</span>(<span class="number">1</span>)</span><br><span class="line">    device.<span class="title function_">cancelKeepingAwake</span>()</span><br><span class="line">    <span class="title function_">toast</span>(<span class="string">&quot;已中断所有子线程!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 可以在此调试各个方法</span></span><br><span class="line">    <span class="comment">// doClock()</span></span><br><span class="line">    <span class="comment">// sendQQMsg(&quot;测试文本&quot;)</span></span><br><span class="line">    <span class="comment">// sendEmail(&quot;测试主题&quot;, &quot;测试文本&quot;, null)</span></span><br><span class="line">    <span class="comment">// sendServerChan(测试主题, 测试文本)</span></span><br><span class="line">    <span class="comment">// sendPushDeer(测试主题, 测试文本)</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">toastLog</span>(<span class="string">&quot;监听中, 请在日志中查看记录的通知及其内容&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// =================== ↑↑↑ 主线程：监听通知 ↑↑↑ =====================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// =================== ↑↑↑ 副线程：循环打卡 ↑↑↑ =====================</span></span><br><span class="line"><span class="title function_">startRecursiveCard</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">startRecursiveCard</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">while</span>(recursiveCard)&#123;</span><br><span class="line">        <span class="keyword">var</span> hour = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getHours</span>()</span><br><span class="line">        <span class="comment">// 直到打卡时间点 启动钉钉</span></span><br><span class="line">        <span class="keyword">while</span>(recursiveCard &amp;&amp; !<span class="title function_">existsInArray</span>(timeAnchorPoints, hour))&#123;</span><br><span class="line">            <span class="keyword">var</span> randomTime = <span class="title function_">random</span>(<span class="variable constant_">ONE_MIN</span>, <span class="variable constant_">FIF_MIN</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;【循环打卡】未到时间点，进行&quot;</span> + <span class="title class_">Math</span>.<span class="title function_">floor</span>(randomTime / <span class="number">1000</span>) + <span class="string">&quot;秒随机睡眠...&quot;</span>)</span><br><span class="line">            <span class="title function_">sleep</span>(randomTime)</span><br><span class="line">            hour = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getHours</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="title function_">doClock</span>(); <span class="comment">// 打卡</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title class_">Date</span>() + <span class="string">&quot; 【循环打卡】打卡成功&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span> == <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>)&#123;</span><br><span class="line">            <span class="title function_">sleep</span>(<span class="number">10000</span>) <span class="comment">// 等待默认消息通知程序发送</span></span><br><span class="line">            <span class="title function_">sendQQMsg</span>(<span class="keyword">new</span> <span class="title class_">Date</span>() + <span class="string">&quot; 【循环打卡】打卡成功&quot;</span>)</span><br><span class="line">            <span class="title function_">sendServerChan</span>(<span class="string">&quot;【循环打卡】打卡结果&quot;</span>, <span class="keyword">new</span> <span class="title class_">Date</span>() + <span class="string">&quot; 打卡成功&quot;</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;【循环打卡】QQ&amp;ServerChan 消息发送成功...&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// 直到打卡时间点 启动钉钉</span></span><br><span class="line">        <span class="keyword">while</span>(recursiveCard &amp;&amp; <span class="title function_">existsInArray</span>(timeAnchorPoints, hour))&#123;</span><br><span class="line">            <span class="keyword">var</span> randomTime = <span class="title function_">random</span>(<span class="variable constant_">ONE_MIN</span>, <span class="variable constant_">FIF_MIN</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;【循环打卡】已打卡，进行&quot;</span> + <span class="title class_">Math</span>.<span class="title function_">floor</span>(randomTime / <span class="number">1000</span>) + <span class="string">&quot;秒随机睡眠...&quot;</span>)</span><br><span class="line">            <span class="title function_">sleep</span>(randomTime)</span><br><span class="line">            hour = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getHours</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// =================== ↑↑↑ 副线程：循环打卡 ↑↑↑ =====================</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 处理通知</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">notificationHandler</span>(<span class="params">n</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> packageId = n.<span class="title function_">getPackageName</span>()  <span class="comment">// 获取通知包名</span></span><br><span class="line">    <span class="keyword">var</span> abstract = n.<span class="property">tickerText</span>         <span class="comment">// 获取通知摘要</span></span><br><span class="line">    <span class="keyword">var</span> text = n.<span class="title function_">getText</span>()              <span class="comment">// 获取通知文本</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 过滤 PackageId 白名单之外的应用所发出的通知</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_">filterNotification</span>(packageId, abstract, text)) &#123; </span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 监听摘要为 &quot;定时打卡&quot; 的通知, 不一定要从 Tasker 中发出通知, 日历、定时器等App均可实现</span></span><br><span class="line">    <span class="keyword">if</span> (abstract == <span class="string">&quot;定时打卡&quot;</span> &amp;&amp; !suspend) &#123; </span><br><span class="line">        needWaiting = <span class="literal">true</span></span><br><span class="line">        threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">        threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">doClock</span>()</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(text) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;打卡&quot;</span>: <span class="comment">// 监听文本为 &quot;打卡&quot; 的通知</span></span><br><span class="line">            needWaiting = <span class="literal">false</span></span><br><span class="line">            <span class="comment">// threads.shutDownAll()</span></span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">doClock</span>()</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;查询&quot;</span>: <span class="comment">// 监听文本为 &quot;查询&quot; 的通知</span></span><br><span class="line">            <span class="comment">// threads.shutDownAll()</span></span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                        <span class="title function_">sendQQMsg</span>(<span class="title function_">getStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>))</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                        <span class="title function_">sendEmail</span>(<span class="string">&quot;考勤结果&quot;</span>, <span class="title function_">getStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>), <span class="literal">null</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                        <span class="title function_">sendServerChan</span>(<span class="string">&quot;考勤结果&quot;</span>, <span class="title function_">getStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>))</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                        <span class="title function_">sendPushDeer</span>(<span class="string">&quot;考勤结果&quot;</span>, <span class="title function_">getStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>))</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;暂停&quot;</span>: <span class="comment">// 监听文本为 &quot;暂停&quot; 的通知</span></span><br><span class="line">            suspend = <span class="literal">true</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;暂停定时打卡&quot;</span>)</span><br><span class="line">            threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                        <span class="title function_">sendQQMsg</span>(<span class="string">&quot;修改成功, 已暂停定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                        <span class="title function_">sendEmail</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已暂停定时打卡功能&quot;</span>, <span class="literal">null</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                        <span class="title function_">sendServerChan</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已暂停定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                        <span class="title function_">sendPushDeer</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已暂停定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;恢复&quot;</span>: <span class="comment">// 监听文本为 &quot;恢复&quot; 的通知</span></span><br><span class="line">            suspend = <span class="literal">false</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;恢复定时打卡&quot;</span>)</span><br><span class="line">            threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                        <span class="title function_">sendQQMsg</span>(<span class="string">&quot;修改成功, 已恢复定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                        <span class="title function_">sendEmail</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已恢复定时打卡功能&quot;</span>, <span class="literal">null</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                        <span class="title function_">sendServerChan</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已恢复定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                        <span class="title function_">sendPushDeer</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已恢复定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;日志&quot;</span>: <span class="comment">// 监听文本为 &quot;日志&quot; 的通知</span></span><br><span class="line">            <span class="comment">// threads.shutDownAll()</span></span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">sendEmail</span>(<span class="string">&quot;获取日志&quot;</span>, globalLogFilePath, globalLogFilePath)</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;连接&quot;</span>: <span class="comment">// 连接到 Autojs Server</span></span><br><span class="line">            <span class="comment">// threads.shutDownAll()</span></span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">connectServer</span>()</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;开启循环&quot;</span>: <span class="comment">// 每天循环打卡 早八晚十</span></span><br><span class="line">            recursiveCard = <span class="literal">true</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;每天循环打卡&quot;</span>)</span><br><span class="line">            threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                        <span class="title function_">sendQQMsg</span>(<span class="string">&quot;开启每天循环打卡功能（早八晚十），时间点：&quot;</span> + timeAnchorPoints)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                        <span class="title function_">sendEmail</span>(<span class="string">&quot;开启每天循环打卡功能（早八晚十），时间点：&quot;</span> + timeAnchorPoints, <span class="literal">null</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                        <span class="title function_">sendServerChan</span>(<span class="string">&quot;开启循环打卡成功&quot;</span>, <span class="string">&quot;开启每天循环打卡功能（早八晚十），时间点：&quot;</span> + timeAnchorPoints)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                        <span class="title function_">sendPushDeer</span>(<span class="string">&quot;开启循环打卡成功&quot;</span>, <span class="string">&quot;开启每天循环打卡功能（早八晚十），时间点：&quot;</span> + timeAnchorPoints)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="title function_">startRecursiveCard</span>();</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;关闭循环&quot;</span>: <span class="comment">// 每天循环打卡 早八晚十</span></span><br><span class="line">            recursiveCard = <span class="literal">false</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;关闭每天循环打卡&quot;</span>)</span><br><span class="line">            threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                        <span class="title function_">sendQQMsg</span>(<span class="string">&quot;关闭每天循环打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                        <span class="title function_">sendEmail</span>(<span class="string">&quot;关闭每天循环打卡功能&quot;</span>, <span class="literal">null</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                        <span class="title function_">sendServerChan</span>(<span class="string">&quot;关闭循环打卡成功&quot;</span>, <span class="string">&quot;关闭每天循环打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                        <span class="title function_">sendPushDeer</span>(<span class="string">&quot;关闭循环打卡成功&quot;</span>, <span class="string">&quot;关闭每天循环打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (text == <span class="literal">null</span>) </span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听钉钉返回的考勤结果</span></span><br><span class="line">    <span class="comment">// if (packageId == PACKAGE_ID_DD &amp;&amp; text.indexOf(&quot;考勤打卡&quot;) &gt;= 0) &#123; </span></span><br><span class="line">    <span class="keyword">if</span> (packageId == <span class="variable constant_">PACKAGE_ID_DD</span>) &#123; </span><br><span class="line">        <span class="title function_">setStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>, text)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;监听钉钉返回的消息...&quot;</span>)</span><br><span class="line">        <span class="comment">// threads.shutDownAll()</span></span><br><span class="line">        threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                    <span class="title function_">sendQQMsg</span>(text)</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                    <span class="title function_">sendEmail</span>(<span class="string">&quot;考勤结果&quot;</span>, text, cameraFilePath)</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                    <span class="title function_">sendServerChan</span>(<span class="string">&quot;考勤结果&quot;</span>, text)</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                    <span class="title function_">sendPushDeer</span>(<span class="string">&quot;考勤结果&quot;</span>, text)</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 打卡流程</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">doClock</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    currentDate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;本地时间: &quot;</span> + <span class="title function_">getCurrentDate</span>() + <span class="string">&quot; &quot;</span> + <span class="title function_">getCurrentTime</span>())</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;开始打卡流程!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">brightScreen</span>()      <span class="comment">// 唤醒屏幕</span></span><br><span class="line">    <span class="title function_">unlockScreen</span>()      <span class="comment">// 解锁屏幕</span></span><br><span class="line">    <span class="title function_">holdOn</span>()            <span class="comment">// 随机等待</span></span><br><span class="line">    <span class="title function_">signIn</span>()            <span class="comment">// 自动登录</span></span><br><span class="line">    <span class="title function_">handleLate</span>()        <span class="comment">// 处理迟到</span></span><br><span class="line">    <span class="title function_">attendKaoqin</span>()      <span class="comment">// 考勤打卡</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textContains</span>(<span class="string">&quot;上班打卡&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) </span><br><span class="line">    <span class="title function_">clockIn</span>()           <span class="comment">// 上班打卡</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textContains</span>(<span class="string">&quot;下班打卡&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) </span><br><span class="line">    <span class="title function_">clockOut</span>()          <span class="comment">// 下班打卡</span></span><br><span class="line">    </span><br><span class="line">    <span class="title function_">lockScreen</span>()        <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 发送邮件流程</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; title 邮件主题</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; message 邮件正文</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; attachFilePath 要发送的附件路径</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sendEmail</span>(<span class="params">title, message, attachFilePath</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;开始发送邮件流程!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">brightScreen</span>()      <span class="comment">// 唤醒屏幕</span></span><br><span class="line">    <span class="title function_">unlockScreen</span>()      <span class="comment">// 解锁屏幕</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 内置电子邮件</span></span><br><span class="line">    app.<span class="title function_">launch</span>(<span class="string">&quot;com.android.email&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;等待邮箱启动...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">3000</span>) <span class="comment">// 等待邮箱启动</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(attachFilePath != <span class="literal">null</span> &amp;&amp; files.<span class="title function_">exists</span>(attachFilePath)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(attachFilePath)</span><br><span class="line">        app.<span class="title function_">sendEmail</span>(&#123;</span><br><span class="line">            <span class="attr">email</span>: [<span class="variable constant_">EMAILL_ADDRESS</span>], <span class="attr">subject</span>: title, <span class="attr">text</span>: message, <span class="attr">attachment</span>: <span class="string">&quot;file://&quot;</span> + attachFilePath</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(attachFilePath)</span><br><span class="line">        app.<span class="title function_">sendEmail</span>(&#123;</span><br><span class="line">            <span class="attr">email</span>: [<span class="variable constant_">EMAILL_ADDRESS</span>], <span class="attr">subject</span>: title, <span class="attr">text</span>: message</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 选择邮箱应用，系统默认应用即可</span></span><br><span class="line">    <span class="keyword">var</span> emailText = <span class="title function_">text</span>(<span class="string">&quot;电子邮件&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">null</span> == emailText)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;邮箱应用选择失败...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    emailText.<span class="title function_">parent</span>().<span class="title function_">click</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;邮箱应用选择成功...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 点击发送按钮</span></span><br><span class="line">    <span class="keyword">var</span> sendBtn = <span class="title function_">desc</span>(<span class="string">&quot;发送&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">null</span> == sendBtn)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;邮箱发送失败...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sendBtn.<span class="title function_">click</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在发送邮件...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// =============================================================================================================</span></span><br><span class="line">    <span class="comment">// console.log(&quot;选择邮件应用&quot;)</span></span><br><span class="line">    <span class="comment">// waitForActivity(&quot;com.android.internal.app.ChooserActivity&quot;) // 等待选择应用界面弹窗出现, 如果设置了默认应用就注释掉</span></span><br><span class="line">    <span class="comment">// id(&quot;compose_send_btn&quot;).findOne().click()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// var emailAppName = app.getAppName(PACKAGE_ID_MAIL_163)</span></span><br><span class="line">    <span class="comment">// if (null != emailAppName) &#123;</span></span><br><span class="line">    <span class="comment">//     if (null != textMatches(emailAppName).findOne(1000)) &#123;</span></span><br><span class="line">    <span class="comment">//         btn_email = textMatches(emailAppName).findOnce().parent()</span></span><br><span class="line">    <span class="comment">//         btn_email.click()</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// else &#123;</span></span><br><span class="line">    <span class="comment">//     console.error(&quot;不存在应用: &quot; + PACKAGE_ID_MAIL_163)</span></span><br><span class="line">    <span class="comment">//     lockScreen()</span></span><br><span class="line">    <span class="comment">//     return;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// // 网易邮箱大师</span></span><br><span class="line">    <span class="comment">// var versoin = getPackageVersion(PACKAGE_ID_MAIL_163)</span></span><br><span class="line">    <span class="comment">// console.log(&quot;应用版本: &quot; + versoin)</span></span><br><span class="line">    <span class="comment">// var sp = versoin.split(&quot;.&quot;)</span></span><br><span class="line">    <span class="comment">// if (sp[0] == 6) &#123;</span></span><br><span class="line">    <span class="comment">//     // 网易邮箱大师 6</span></span><br><span class="line">    <span class="comment">//     waitForActivity(&quot;com.netease.mobimail.activity.MailComposeActivity&quot;)</span></span><br><span class="line">    <span class="comment">//     id(&quot;send&quot;).findOne().click()</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// else &#123;</span></span><br><span class="line">    <span class="comment">//     // 网易邮箱大师 7</span></span><br><span class="line">    <span class="comment">//     waitForActivity(&quot;com.netease.mobimail.module.mailcompose.MailComposeActivity&quot;)</span></span><br><span class="line">    <span class="comment">//     var input_address = id(&quot;input&quot;).findOne()</span></span><br><span class="line">    <span class="comment">//     if (null == input_address.getText()) &#123;</span></span><br><span class="line">    <span class="comment">//         input_address.setText(EMAILL_ADDRESS)</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line">    <span class="comment">//     id(&quot;iv_arrow&quot;).findOne().click()</span></span><br><span class="line">    <span class="comment">//     sleep(1000)</span></span><br><span class="line">    <span class="comment">//     id(&quot;img_send_bg&quot;).findOne().click()</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="title function_">home</span>()</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">    <span class="title function_">lockScreen</span>()    <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 发送QQ消息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; message 消息内容</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sendQQMsg</span>(<span class="params">message</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;发送QQ消息&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">brightScreen</span>()      <span class="comment">// 唤醒屏幕</span></span><br><span class="line">    <span class="title function_">unlockScreen</span>()      <span class="comment">// 解锁屏幕</span></span><br><span class="line"></span><br><span class="line">    app.<span class="title function_">startActivity</span>(&#123; </span><br><span class="line">        <span class="attr">action</span>: <span class="string">&quot;android.intent.action.VIEW&quot;</span>, </span><br><span class="line">        <span class="attr">data</span>:<span class="string">&quot;mqq://im/chat?chat_type=wpa&amp;version=1&amp;src_type=web&amp;uin=&quot;</span> + <span class="variable constant_">QQ</span>, </span><br><span class="line">        <span class="attr">packageName</span>: <span class="string">&quot;com.tencent.mobileqq&quot;</span>, </span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// waitForActivity(&quot;com.tencent.mobileqq.activity.SplashActivity&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">id</span>(<span class="string">&quot;input&quot;</span>).<span class="title function_">findOne</span>().<span class="title function_">setText</span>(message)</span><br><span class="line">    <span class="title function_">id</span>(<span class="string">&quot;fun_btn&quot;</span>).<span class="title function_">findOne</span>().<span class="title function_">click</span>()</span><br><span class="line"></span><br><span class="line">    <span class="title function_">home</span>()</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    <span class="title function_">lockScreen</span>()    <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ServerChan推送</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; title 标题</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; message 消息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">sendServerChan</span>(<span class="params">title, message</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;向 ServerChan 发起推送请求&quot;</span>)</span><br><span class="line"></span><br><span class="line">    url = <span class="string">&quot;https://sctapi.ftqq.com/&quot;</span> + <span class="variable constant_">SERVER_CHAN</span> + <span class="string">&quot;.send&quot;</span>;</span><br><span class="line"></span><br><span class="line">    res = http.<span class="title function_">post</span>(<span class="built_in">encodeURI</span>(url), &#123;</span><br><span class="line">        <span class="string">&quot;title&quot;</span>: title,</span><br><span class="line">        <span class="string">&quot;desp&quot;</span>: message</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    <span class="title function_">lockScreen</span>()    <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> PushDeer推送</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; title 标题</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; message 消息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">sendPushDeer</span>(<span class="params">title, message</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;向 PushDeer 发起推送请求&quot;</span>)</span><br><span class="line"></span><br><span class="line">    url = <span class="string">&quot;https://api2.pushdeer.com/message/push&quot;</span></span><br><span class="line"></span><br><span class="line">    res = http.<span class="title function_">post</span>(<span class="built_in">encodeURI</span>(url), &#123;</span><br><span class="line">        <span class="string">&quot;pushkey&quot;</span>: <span class="variable constant_">PUSH_DEER</span>,</span><br><span class="line">        <span class="string">&quot;text&quot;</span>: title,</span><br><span class="line">        <span class="string">&quot;desp&quot;</span>: message,</span><br><span class="line">        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;markdown&quot;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    <span class="title function_">lockScreen</span>()    <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 唤醒设备</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">brightScreen</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;唤醒设备&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    device.<span class="title function_">setBrightnessMode</span>(<span class="number">0</span>) <span class="comment">// 手动亮度模式</span></span><br><span class="line">    device.<span class="title function_">setBrightness</span>(<span class="variable constant_">SCREEN_BRIGHTNESS</span>)</span><br><span class="line">    device.<span class="title function_">wakeUpIfNeeded</span>() <span class="comment">// 唤醒设备</span></span><br><span class="line">    device.<span class="title function_">keepScreenOn</span>()   <span class="comment">// 保持亮屏</span></span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>) <span class="comment">// 等待屏幕亮起</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!device.<span class="title function_">isScreenOn</span>()) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;设备未唤醒, 重试&quot;</span>)</span><br><span class="line">        device.<span class="title function_">wakeUpIfNeeded</span>()</span><br><span class="line">        <span class="title function_">brightScreen</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;设备已唤醒&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 解锁屏幕</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">unlockScreen</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;解锁屏幕&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isDeviceLocked</span>()) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">gesture</span>(</span><br><span class="line">            <span class="number">320</span>, <span class="comment">// 滑动时间：毫秒</span></span><br><span class="line">            [</span><br><span class="line">                device.<span class="property">width</span>  * <span class="number">0.5</span>,    <span class="comment">// 滑动起点 x 坐标：屏幕宽度的一半</span></span><br><span class="line">                device.<span class="property">height</span> * <span class="number">0.9</span>     <span class="comment">// 滑动起点 y 坐标：距离屏幕底部 10% 的位置, 华为系统需要往上一些</span></span><br><span class="line">            ],</span><br><span class="line">            [</span><br><span class="line">                device.<span class="property">width</span> / <span class="number">2</span>,       <span class="comment">// 滑动终点 x 坐标：屏幕宽度的一半</span></span><br><span class="line">                device.<span class="property">height</span> * <span class="number">0.1</span>     <span class="comment">// 滑动终点 y 坐标：距离屏幕顶部 10% 的位置</span></span><br><span class="line">            ]</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>) <span class="comment">// 等待解锁动画完成</span></span><br><span class="line">        <span class="title function_">home</span>()</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>) <span class="comment">// 等待返回动画完成</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isDeviceLocked</span>()) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;上滑解锁失败, 请按脚本中的注释调整 gesture(time, [x1,y1], [x2,y2]) 方法的参数!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;屏幕已解锁&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 随机等待</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">holdOn</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!needWaiting) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> randomTime = <span class="title function_">random</span>(<span class="variable constant_">LOWER_BOUND</span>, <span class="variable constant_">UPPER_BOUND</span>)</span><br><span class="line">    <span class="title function_">toastLog</span>(<span class="title class_">Math</span>.<span class="title function_">floor</span>(randomTime / <span class="number">1000</span>) + <span class="string">&quot;秒后启动&quot;</span> + app.<span class="title function_">getAppName</span>(<span class="variable constant_">PACKAGE_ID_DD</span>) + <span class="string">&quot;...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(randomTime)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 启动并登陆钉钉</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">signIn</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    app.<span class="title function_">launchPackage</span>(<span class="variable constant_">PACKAGE_ID_DD</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在启动&quot;</span> + app.<span class="title function_">getAppName</span>(<span class="variable constant_">PACKAGE_ID_DD</span>) + <span class="string">&quot;...&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">setVolume</span>(<span class="number">0</span>) <span class="comment">// 设备静音</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">10000</span>) <span class="comment">// 等待钉钉启动</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">currentPackage</span>() == <span class="variable constant_">PACKAGE_ID_DD</span> &amp;&amp;</span><br><span class="line">        <span class="title function_">currentActivity</span>() == <span class="string">&quot;com.alibaba.android.user.login.SignUpWithPwdActivity&quot;</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;账号未登录&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> account = <span class="title function_">id</span>(<span class="string">&quot;et_phone_input&quot;</span>).<span class="title function_">findOne</span>()</span><br><span class="line">        account.<span class="title function_">setText</span>(<span class="variable constant_">ACCOUNT</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;输入账号&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> password = <span class="title function_">id</span>(<span class="string">&quot;et_pwd_login&quot;</span>).<span class="title function_">findOne</span>()</span><br><span class="line">        password.<span class="title function_">setText</span>(<span class="variable constant_">PASSWORD</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;输入密码&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> privacy = <span class="title function_">id</span>(<span class="string">&quot;cb_privacy&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="literal">null</span> != privacy)&#123;</span><br><span class="line">            privacy.<span class="title function_">click</span>()</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;同意隐私协议&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> btn_login = <span class="title function_">id</span>(<span class="string">&quot;btn_next&quot;</span>).<span class="title function_">findOne</span>()</span><br><span class="line">        btn_login.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在登陆...&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">3000</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">currentPackage</span>() == <span class="variable constant_">PACKAGE_ID_DD</span> &amp;&amp;</span><br><span class="line">        <span class="title function_">currentActivity</span>() != <span class="string">&quot;com.alibaba.android.user.login.SignUpWithPwdActivity&quot;</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;账号已登录&quot;</span>)</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 处理迟到打卡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleLate</span>(<span class="params"></span>)&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textMatches</span>(<span class="string">&quot;迟到打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        btn_late = <span class="title function_">textMatches</span>(<span class="string">&quot;迟到打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>() </span><br><span class="line">        btn_late.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;迟到打卡&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">descMatches</span>(<span class="string">&quot;迟到打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        btn_late = <span class="title function_">descMatches</span>(<span class="string">&quot;迟到打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>() </span><br><span class="line">        btn_late.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;迟到打卡&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 使用 URL Scheme 进入考勤界面</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">attendKaoqin</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> url_scheme = <span class="string">&quot;dingtalk://dingtalkclient/page/link?url=https://attend.dingtalk.com/attend/index.html&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable constant_">CORP_ID</span> != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">        url_scheme = url_scheme + <span class="string">&quot;?corpId=&quot;</span> + <span class="variable constant_">CORP_ID</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> a = app.<span class="title function_">intent</span>(&#123;</span><br><span class="line">        <span class="comment">// action: &quot;VIEW&quot;,</span></span><br><span class="line">        <span class="attr">action</span>: <span class="string">&quot;android.intent.action.VIEW&quot;</span>, </span><br><span class="line">        <span class="attr">data</span>: url_scheme,</span><br><span class="line">        <span class="comment">//flags: [Intent.FLAG_ACTIVITY_NEW_TASK]</span></span><br><span class="line">    &#125;);</span><br><span class="line">    app.<span class="title function_">startActivity</span>(a);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在进入考勤界面...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">textContains</span>(<span class="string">&quot;申请&quot;</span>).<span class="title function_">waitFor</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;已进入考勤界面&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">8000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 上班打卡 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clockIn</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;上班打卡...&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// if (null != textContains(&quot;已打卡&quot;).findOne(1000)) &#123;</span></span><br><span class="line">    <span class="comment">//     console.info(&quot;已打卡&quot;)</span></span><br><span class="line">    <span class="comment">//     toast(&quot;已打卡&quot;)</span></span><br><span class="line">    <span class="comment">//     home()</span></span><br><span class="line">    <span class="comment">//     sleep(1000)</span></span><br><span class="line">    <span class="comment">//     return;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;等待连接到考勤机...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textContains</span>(<span class="string">&quot;未连接&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;未连接考勤机, 重新进入考勤界面!&quot;</span>)</span><br><span class="line">        <span class="title function_">back</span>()</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">        <span class="title function_">attendKaoqin</span>()</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">textContains</span>(<span class="string">&quot;已连接&quot;</span>).<span class="title function_">waitFor</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;已连接考勤机&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textMatches</span>(<span class="string">&quot;上班打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        btn_clockin = <span class="title function_">textMatches</span>(<span class="string">&quot;上班打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>()</span><br><span class="line">        btn_clockin.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;按下打卡按钮&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">click</span>(device.<span class="property">width</span> / <span class="number">2</span>, device.<span class="property">height</span> * <span class="number">0.560</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;点击打卡按钮坐标&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    <span class="title function_">handleLate</span>() <span class="comment">// 处理迟到打卡</span></span><br><span class="line">    </span><br><span class="line">    <span class="title function_">home</span>()</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 下班打卡 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clockOut</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;下班打卡...&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;等待连接到考勤机...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textContains</span>(<span class="string">&quot;未连接&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;未连接考勤机, 重新进入考勤界面!&quot;</span>)</span><br><span class="line">        <span class="title function_">back</span>()</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">        <span class="title function_">attendKaoqin</span>()</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">textContains</span>(<span class="string">&quot;已连接&quot;</span>).<span class="title function_">waitFor</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;已连接考勤机&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textMatches</span>(<span class="string">&quot;下班打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        btn_clockout = <span class="title function_">textMatches</span>(<span class="string">&quot;下班打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>()</span><br><span class="line">        btn_clockout.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;按下打卡按钮&quot;</span>)</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">click</span>(device.<span class="property">width</span> / <span class="number">2</span>, device.<span class="property">height</span> * <span class="number">0.560</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;点击打卡按钮坐标&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textContains</span>(<span class="string">&quot;早退打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        <span class="title function_">className</span>(<span class="string">&quot;android.widget.Button&quot;</span>).<span class="title function_">text</span>(<span class="string">&quot;早退打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>().<span class="title function_">parent</span>().<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;早退打卡&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">home</span>()</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 锁屏</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">lockScreen</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;关闭屏幕&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 锁屏方案1：Root</span></span><br><span class="line">    <span class="comment">// Power()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 锁屏方案2：No Root</span></span><br><span class="line">    <span class="comment">// press(Math.floor(device.width / 2), Math.floor(device.height * 0.973), 1000) // 小米的快捷手势：长按Home键锁屏</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 万能锁屏方案：向Tasker发送广播, 触发系统锁屏动作。配置方法见 2021-03-09 更新日志</span></span><br><span class="line">    app.<span class="title function_">sendBroadcast</span>(&#123;<span class="attr">action</span>: <span class="variable constant_">ACTION_LOCK_SCREEN</span>&#125;);</span><br><span class="line"></span><br><span class="line">    device.<span class="title function_">setBrightnessMode</span>(<span class="number">1</span>) <span class="comment">// 自动亮度模式</span></span><br><span class="line">    device.<span class="title function_">cancelKeepingAwake</span>() <span class="comment">// 取消设备常亮</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isDeviceLocked</span>()) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;屏幕已关闭&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;屏幕未关闭, 请尝试其他锁屏方案, 或等待屏幕自动关闭&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 连接 AutoJs Server</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">connectServer</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;开始连接 AutoJs Server!&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;本地时间: &quot;</span> + <span class="title function_">getCurrentDate</span>() + <span class="string">&quot; &quot;</span> + <span class="title function_">getCurrentTime</span>())</span><br><span class="line"></span><br><span class="line">    <span class="title function_">brightScreen</span>()      <span class="comment">// 唤醒屏幕</span></span><br><span class="line">    <span class="title function_">unlockScreen</span>()      <span class="comment">// 解锁屏幕</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">connectAutoJsServer</span>() <span class="comment">// 连接 AutoJs Server</span></span><br><span class="line">    </span><br><span class="line">    <span class="title function_">lockScreen</span>()        <span class="comment">// 关闭屏幕</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 启动 AutoJs Server 整体流程</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">connectAutoJsServer</span>(<span class="params"></span>)&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">launchApp</span>(<span class="string">&quot;Auto.js&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在启动 Auto.js...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">10000</span>) <span class="comment">// 等待 Auto.js 启动</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打开侧拉菜单</span></span><br><span class="line">    <span class="keyword">var</span> menuBtn = <span class="title function_">className</span>(<span class="string">&quot;android.widget.ImageButton&quot;</span>).<span class="title function_">desc</span>(<span class="string">&quot;打开侧拉菜单&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">null</span> != menuBtn)&#123;</span><br><span class="line">        menuBtn.<span class="title function_">click</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;打开侧拉菜单...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 滚动屏幕找到连接电脑按钮</span></span><br><span class="line">    <span class="keyword">var</span> menu = <span class="title function_">id</span>(<span class="string">&quot;drawer_menu&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">null</span> == menu)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;滚动屏幕未找到连接电脑按钮...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    menu.<span class="title function_">scrollForward</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;滚动屏幕找到连接电脑按钮...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 连接电脑</span></span><br><span class="line">    <span class="keyword">var</span> textCon = <span class="title function_">className</span>(<span class="string">&quot;android.widget.TextView&quot;</span>).<span class="title function_">text</span>(<span class="string">&quot;连接电脑&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">null</span> != textCon)&#123;</span><br><span class="line">        <span class="comment">// 寻找按钮（Switch）</span></span><br><span class="line">        <span class="keyword">var</span> layerCon = textCon.<span class="title function_">parent</span>();</span><br><span class="line">        <span class="keyword">var</span> switchBtn = layerCon.<span class="title function_">children</span>().<span class="title function_">findOne</span>(<span class="title function_">className</span>(<span class="string">&quot;android.widget.Switch&quot;</span>));</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;找到连接电脑按钮，按钮状态为：&quot;</span> + switchBtn.<span class="title function_">text</span>() + <span class="string">&quot; &quot;</span> + switchBtn.<span class="title function_">checked</span>() +  <span class="string">&quot;...&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(switchBtn.<span class="title function_">checked</span>() == <span class="literal">false</span>)&#123;</span><br><span class="line">            <span class="comment">// 按下按钮</span></span><br><span class="line">            switchBtn.<span class="title function_">click</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;开始连接电脑...&quot;</span>)</span><br><span class="line">            <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 点击确定</span></span><br><span class="line">            <span class="keyword">var</span> okBtn = <span class="title function_">text</span>(<span class="string">&quot;确定&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>);</span><br><span class="line">            okBtn.<span class="title function_">click</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;连接电脑成功...&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>) <span class="comment">// 等待解锁动画完成</span></span><br><span class="line">    <span class="title function_">home</span>()</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>) <span class="comment">// 等待返回动画完成</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// console.log(&quot;==========================================================&quot;);</span></span><br><span class="line">    <span class="comment">// id(&quot;drawer_menu&quot;).findOne().children().forEach(child =&gt; &#123;</span></span><br><span class="line">    <span class="comment">//     var target = child.findOne(id(&quot;sw&quot;));</span></span><br><span class="line">    <span class="comment">//     console.log(target);</span></span><br><span class="line">    <span class="comment">//     &#125;);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ===================== ↓↓↓ 功能函数 ↓↓↓ =======================</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">dateDigitToString</span>(<span class="params">num</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> num &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + num : num</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getCurrentTime</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> currentDate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">    <span class="keyword">var</span> hours = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getHours</span>())</span><br><span class="line">    <span class="keyword">var</span> minute = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getMinutes</span>())</span><br><span class="line">    <span class="keyword">var</span> second = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getSeconds</span>())</span><br><span class="line">    <span class="keyword">var</span> formattedTimeString = hours + <span class="string">&#x27;:&#x27;</span> + minute + <span class="string">&#x27;:&#x27;</span> + second</span><br><span class="line">    <span class="keyword">return</span> formattedTimeString</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getCurrentDate</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> currentDate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">    <span class="keyword">var</span> year = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getFullYear</span>())</span><br><span class="line">    <span class="keyword">var</span> month = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getMonth</span>() + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">var</span> date = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getDate</span>())</span><br><span class="line">    <span class="keyword">var</span> week = currentDate.<span class="title function_">getDay</span>()</span><br><span class="line">    <span class="keyword">var</span> formattedDateString = year + <span class="string">&#x27;-&#x27;</span> + month + <span class="string">&#x27;-&#x27;</span> + date + <span class="string">&#x27;-&#x27;</span> + <span class="variable constant_">WEEK_DAY</span>[week]</span><br><span class="line">    <span class="keyword">return</span> formattedDateString</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">existsInArray</span>(<span class="params">arr, element</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;arr.<span class="property">length</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(arr[i] == element) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通知过滤器</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">filterNotification</span>(<span class="params">bundleId, abstract, text</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> check = <span class="variable constant_">PACKAGE_ID_WHITE_LIST</span>.<span class="title function_">some</span>(<span class="keyword">function</span>(<span class="params">item</span>) &#123;<span class="keyword">return</span> bundleId == item&#125;) </span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable constant_">NOTIFICATIONS_FILTER</span> || check) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">verbose</span>(bundleId)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">verbose</span>(abstract)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">verbose</span>(text)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">verbose</span>(<span class="string">&quot;---------------------------&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 保存本地数据</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setStorageData</span>(<span class="params">name, key, value</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> storage = storages.<span class="title function_">create</span>(name)  <span class="comment">// 创建storage对象</span></span><br><span class="line">    storage.<span class="title function_">put</span>(key, value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取本地数据</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getStorageData</span>(<span class="params">name, key</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> storage = storages.<span class="title function_">create</span>(name)</span><br><span class="line">    <span class="keyword">if</span> (storage.<span class="title function_">contains</span>(key)) &#123;</span><br><span class="line">        <span class="keyword">return</span> storage.<span class="title function_">get</span>(key, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 默认返回undefined</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除本地数据</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">delStorageData</span>(<span class="params">name, key</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> storage = storages.<span class="title function_">create</span>(name)</span><br><span class="line">    <span class="keyword">if</span> (storage.<span class="title function_">contains</span>(key)) &#123;</span><br><span class="line">        storage.<span class="title function_">remove</span>(key)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取应用版本号</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getPackageVersion</span>(<span class="params">bundleId</span>) &#123;</span><br><span class="line">    <span class="title function_">importPackage</span>(android.<span class="property">content</span>)</span><br><span class="line">    <span class="keyword">var</span> pckMan = context.<span class="title function_">getPackageManager</span>()</span><br><span class="line">    <span class="keyword">var</span> packageInfo = pckMan.<span class="title function_">getPackageInfo</span>(bundleId, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> packageInfo.<span class="property">versionName</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 屏幕是否为锁定状态</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isDeviceLocked</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">importClass</span>(android.<span class="property">app</span>.<span class="property">KeyguardManager</span>)</span><br><span class="line">    <span class="title function_">importClass</span>(android.<span class="property">content</span>.<span class="property">Context</span>)</span><br><span class="line">    <span class="keyword">var</span> km = context.<span class="title function_">getSystemService</span>(<span class="title class_">Context</span>.<span class="property">KEYGUARD_SERVICE</span>)</span><br><span class="line">    <span class="keyword">return</span> km.<span class="title function_">isKeyguardLocked</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置媒体和通知音量</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setVolume</span>(<span class="params">volume</span>) &#123;</span><br><span class="line">    device.<span class="title function_">setMusicVolume</span>(volume)</span><br><span class="line">    device.<span class="title function_">setNotificationVolume</span>(volume)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">verbose</span>(<span class="string">&quot;媒体音量:&quot;</span> + device.<span class="title function_">getMusicVolume</span>())</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">verbose</span>(<span class="string">&quot;通知音量:&quot;</span> + device.<span class="title function_">getNotificationVolume</span>())</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Auto-js-VSCodeExt-README"><a href="#Auto-js-VSCodeExt-README" class="headerlink" title="Auto.js-VSCodeExt README"></a>Auto.js-VSCodeExt README</h1><p>桌面编辑器Visual Studio Code的插件。可以让Visual Studio Code支持<a target="_blank" rel="noopener" href="https://github.com/hyb1996/NoRootScriptDroid">Auto.js</a>开发。</p>
<h2 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h2><p>在VS Code中菜单”查看”-&gt;”扩展”-&gt;输入”Auto.js”或”hyb1996”搜索，即可看到”Auto.js-VSCodeExt”插件，安装即可。插件的更新也可以在这里更新。</p>
<h2 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h2><p>目前功能比较基础，仅支持：</p>
<ul>
<li>在VS Code的开发者工具实时显示Auto.js的日志与输出</li>
<li>在VS Code命令中增加Run, Stop, Rerun, Stop all等选项。可以在手机与电脑连接后把Sublime编辑器中的脚本推送到AutoJs中执行，或者停止AutoJs中运行的脚本。</li>
</ul>
<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><h3 id="Step-1"><a href="#Step-1" class="headerlink" title="Step 1"></a>Step 1</h3><p>按 <code>Ctrl+Shift+P</code> 或点击”查看”-&gt;”命令面板”可调出命令面板，输入 <code>Auto.js</code> 可以看到几个命令，移动光标到命令<code>Auto.js: Start Server</code>，按回车键执行该命令。</p>
<p>此时VS Code会在右上角显示”Auto.js server running”，即开启服务成功。</p>
<h3 id="Step-2"><a href="#Step-2" class="headerlink" title="Step 2"></a>Step 2</h3><p>将手机连接到电脑启用的Wifi或者同一局域网中。通过命令行ipconfig(或者其他操作系统的相同功能命令)查看电脑的IP地址。在<a target="_blank" rel="noopener" href="https://github.com/hyb1996/Auto.js">Auto.js</a>的侧拉菜单中启用调试服务，并输入IP地址，等待连接成功。</p>
<h3 id="Step-3"><a href="#Step-3" class="headerlink" title="Step 3"></a>Step 3</h3><p>之后就可以在电脑上编辑JavaScript文件并通过命令<code>Run</code>或者按键<code>F5</code>在手机上运行了。</p>
<h2 id="Commands"><a href="#Commands" class="headerlink" title="Commands"></a>Commands</h2><p>按 <code>Ctrl+Shift+P</code> 或点击”查看”-&gt;”命令面板”可调出命令面板，输入 <code>Auto.js</code> 可以看到几个命令：</p>
<ul>
<li>Start Server: 启动插件服务。之后在确保手机和电脑在同一区域网的情况下，在Auto.js的侧拉菜单中使用连接电脑功能连接。</li>
<li>Stop Server: 停止插件服务。</li>
<li>Run 运行当前编辑器的脚本。如果有多个设备连接，则在所有设备运行。</li>
<li>Rerun 停止当前文件对应的脚本并重新运行。如果有多个设备连接，则在所有设备重新运行。</li>
<li>Stop 停止当前文件对应的脚本。如果有多个设备连接，则在所有设备停止。</li>
<li>StopAll 停止所有正在运行的脚本。如果有多个设备连接，则在所有设备运行所有脚本。</li>
<li>Save 保存当前文件到手机的脚本默认目录（文件名会加上前缀remote)。如果有多个设备连接，则在所有设备保存。</li>
<li>RunOnDevice: 弹出设备菜单并在指定设备运行脚本。</li>
<li>SaveToDevice: 弹出设备菜单并在指定设备保存脚本。</li>
<li>New Project（新建项目）：选择一个空文件夹（或者在文件管理器中新建一个空文件夹），将会自动创建一个项目</li>
<li>Run Project（运行项目）：运行一个项目，需要Auto.js 4.0.4Alpha5以上支持</li>
<li>Save Project（保存项目）：保存一个项目，需要Auto.js 4.0.4Alpha5以上支持</li>
</ul>
<p>以上命令一些有对应的快捷键，参照命令后面的说明即可。</p>
<h2 id="Log"><a href="#Log" class="headerlink" title="Log"></a>Log</h2><p>要显示来自Auto.js的日志，打开 VS Code上面菜单的”帮助”-&gt;”切换开发人员工具”-&gt;”Console”即可。</p>
<h1 id="钉钉打卡脚本原文"><a href="#钉钉打卡脚本原文" class="headerlink" title="钉钉打卡脚本原文"></a>钉钉打卡脚本原文</h1><h2 id="⏰-DingDing-Automatic-Clock-in"><a href="#⏰-DingDing-Automatic-Clock-in" class="headerlink" title="⏰ DingDing-Automatic-Clock-in"></a>⏰ DingDing-Automatic-Clock-in</h2><img width="796" src="https://user-images.githubusercontent.com/49583943/138620009-32d16b4a-d38b-4cb7-9650-db7f45f14520.png"/>

<h2 id="📖-简介"><a href="#📖-简介" class="headerlink" title="📖 简介"></a>📖 简介</h2><p>钉钉全自动打卡 + 远程打卡脚本，无需 root，基于 auto.js，适用于蓝牙考勤机。</p>
<h2 id="💥-功能"><a href="#💥-功能" class="headerlink" title="💥 功能"></a>💥 功能</h2><ul>
<li>定时打卡</li>
<li>远程打卡</li>
<li>发送考勤结果</li>
</ul>
<h2 id="⚙️-工具"><a href="#⚙️-工具" class="headerlink" title="⚙️ 工具"></a>⚙️ 工具</h2><ul>
<li>auto.js</li>
<li>Tasker</li>
<li>一款通讯应用（示例脚本中使用的是 QQ &#x2F; 网易邮箱大师 &#x2F; ServerChan &#x2F; PushDeer，彼此互为备用方案）</li>
</ul>
<h2 id="💡-原理"><a href="#💡-原理" class="headerlink" title="💡 原理"></a>💡 原理</h2><p>通过 auto.js 脚本监听本机通知，在 Tasker 中创建定时任务，发出通知，或在另一设备上发送消息到本机，即可触发脚本中的打卡进程，实现定时打卡和远程打卡。</p>
<p><img src="https://user-images.githubusercontent.com/49583943/163506300-7ef7693b-a273-442f-8449-dcef31063069.png" alt="image"></p>
<p>同理，监听到钉钉发出的打卡成功通知后，将通知文本通过 QQ消息 或 邮件正文 发送，实现发送考勤结果的功能。</p>
<h2 id="📝-脚本"><a href="#📝-脚本" class="headerlink" title="📝 脚本"></a>📝 脚本</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * @Author: George Huan</span></span><br><span class="line"><span class="comment"> * @Date: 2020-08-03 09:30:30</span></span><br><span class="line"><span class="comment"> * @LastEditTime: 2022-03-26 10:56:25</span></span><br><span class="line"><span class="comment"> * @Description: DingDing-Automatic-Clock-in (Run on AutoJs)</span></span><br><span class="line"><span class="comment"> * @URL: https://github.com/georgehuan1994/DingDing-Automatic-Clock-in</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">ACCOUNT</span> = <span class="string">&quot;钉钉账号&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PASSWORD</span> = <span class="string">&quot;钉钉密码&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">QQ</span> =              <span class="string">&quot;用于接收打卡结果的QQ号&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">EMAILL_ADDRESS</span> =  <span class="string">&quot;用于接收打卡结果的邮箱地址&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SERVER_CHAN</span> =     <span class="string">&quot;Server酱发送密钥&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PUSH_DEER</span> =       <span class="string">&quot;PushDeer发送密钥&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PUSH_METHOD</span> = &#123;<span class="attr">QQ</span>: <span class="number">1</span>, <span class="title class_">Email</span>: <span class="number">2</span>, <span class="title class_">ServerChan</span>: <span class="number">3</span>, <span class="title class_">PushDeer</span>: <span class="number">4</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认通信方式：</span></span><br><span class="line"><span class="comment">// PUSH_METHOD.QQ -- QQ</span></span><br><span class="line"><span class="comment">// PUSH_METHOD.Email -- Email </span></span><br><span class="line"><span class="comment">// PUSH_METHOD.ServerChan -- Server酱</span></span><br><span class="line"><span class="comment">// PUSH_METHOD.PushDeer -- Push Deer</span></span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span> = <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_QQ</span> = <span class="string">&quot;com.tencent.mobileqq&quot;</span>                <span class="comment">// QQ</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_DD</span> = <span class="string">&quot;com.alibaba.android.rimet&quot;</span>           <span class="comment">// 钉钉</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_XMSF</span> = <span class="string">&quot;com.xiaomi.xmsf&quot;</span>                   <span class="comment">// 小米推送服务</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_TASKER</span> = <span class="string">&quot;net.dinglisch.android.taskerm&quot;</span>   <span class="comment">// Tasker</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_MAIL_163</span> = <span class="string">&quot;com.netease.mail&quot;</span>              <span class="comment">// 网易邮箱大师</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_MAIL_ANDROID</span> = <span class="string">&quot;com.android.email&quot;</span>         <span class="comment">// 系统内置邮箱</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_PUSHDEER</span> = <span class="string">&quot;com.pushdeer.os&quot;</span>               <span class="comment">// Push Deer</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">LOWER_BOUND</span> = <span class="number">1</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 最小等待时间：1min</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">UPPER_BOUND</span> = <span class="number">5</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 最大等待时间：5min</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行时的屏幕亮度（0-255）, 需要&quot;修改系统设置&quot;权限</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SCREEN_BRIGHTNESS</span> = <span class="number">20</span>    </span><br><span class="line"></span><br><span class="line"><span class="comment">// 是否过滤通知</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">NOTIFICATIONS_FILTER</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// PackageId白名单</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PACKAGE_ID_WHITE_LIST</span> = [<span class="variable constant_">PACKAGE_ID_QQ</span>,<span class="variable constant_">PACKAGE_ID_DD</span>,<span class="variable constant_">PACKAGE_ID_XMSF</span>,<span class="variable constant_">PACKAGE_ID_MAIL_163</span>,<span class="variable constant_">PACKAGE_ID_TASKER</span>,<span class="variable constant_">PACKAGE_ID_PUSHDEER</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 公司的钉钉CorpId, 获取方法见 2020-09-24 更新日志。如果只加入了一家公司, 可以不填</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CORP_ID</span> = <span class="string">&quot;&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">// 锁屏意图, 配合 Tasker 完成锁屏动作, 具体配置方法见 2021-03-09 更新日志</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">ACTION_LOCK_SCREEN</span> = <span class="string">&quot;autojs.intent.action.LOCK_SCREEN&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听音量+键, 开启后无法通过音量+键调整音量, 按下音量+键：结束所有子线程</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">OBSERVE_VOLUME_KEY</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">WEEK_DAY</span> = [<span class="string">&quot;Sunday&quot;</span>,<span class="string">&quot;Monday&quot;</span>,<span class="string">&quot;Tuesday&quot;</span>,<span class="string">&quot;Wednesday&quot;</span>,<span class="string">&quot;Thursday&quot;</span>,<span class="string">&quot;Friday&quot;</span>,<span class="string">&quot;Saturday&quot;</span>,]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// =================== ↓↓↓ 主线程：监听通知 ↓↓↓ ====================</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> currentDate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 是否暂停定时打卡</span></span><br><span class="line"><span class="keyword">var</span> suspend = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 本次打开钉钉前是否需要等待</span></span><br><span class="line"><span class="keyword">var</span> needWaiting = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 运行日志路径</span></span><br><span class="line"><span class="keyword">var</span> globalLogFilePath = <span class="string">&quot;/sdcard/脚本/Archive/&quot;</span> + <span class="title function_">getCurrentDate</span>() + <span class="string">&quot;-log.txt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查无障碍权限</span></span><br><span class="line">auto.<span class="title function_">waitFor</span>(<span class="string">&quot;normal&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查Autojs版本</span></span><br><span class="line"><span class="title function_">requiresAutojsVersion</span>(<span class="string">&quot;4.1.0&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建运行日志</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">setGlobalLogConfig</span>(&#123;</span><br><span class="line">    <span class="attr">file</span>: <span class="string">&quot;/sdcard/脚本/Archive/&quot;</span> + <span class="title function_">getCurrentDate</span>() + <span class="string">&quot;-log.txt&quot;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听本机通知</span></span><br><span class="line">events.<span class="title function_">observeNotification</span>()    </span><br><span class="line">events.<span class="title function_">on</span>(<span class="string">&quot;notification&quot;</span>, <span class="keyword">function</span>(<span class="params">n</span>) &#123;</span><br><span class="line">    <span class="title function_">notificationHandler</span>(n)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">events.<span class="title function_">setKeyInterceptionEnabled</span>(<span class="string">&quot;volume_up&quot;</span>, <span class="variable constant_">OBSERVE_VOLUME_KEY</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable constant_">OBSERVE_VOLUME_KEY</span>) &#123;</span><br><span class="line">    events.<span class="title function_">observeKey</span>()</span><br><span class="line">&#125;;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 监听音量+键</span></span><br><span class="line">events.<span class="title function_">onKeyDown</span>(<span class="string">&quot;volume_up&quot;</span>, <span class="keyword">function</span>(<span class="params">event</span>)&#123;</span><br><span class="line">    threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">    device.<span class="title function_">setBrightnessMode</span>(<span class="number">1</span>)</span><br><span class="line">    device.<span class="title function_">cancelKeepingAwake</span>()</span><br><span class="line">    <span class="title function_">toast</span>(<span class="string">&quot;已中断所有子线程!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 可以在此调试各个方法</span></span><br><span class="line">    <span class="comment">// doClock()</span></span><br><span class="line">    <span class="comment">// sendQQMsg(&quot;测试文本&quot;)</span></span><br><span class="line">    <span class="comment">// sendEmail(&quot;测试主题&quot;, &quot;测试文本&quot;, null)</span></span><br><span class="line">    <span class="comment">// sendServerChan(测试主题, 测试文本)</span></span><br><span class="line">    <span class="comment">// sendPushDeer(测试主题, 测试文本)</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">toastLog</span>(<span class="string">&quot;监听中, 请在日志中查看记录的通知及其内容&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// =================== ↑↑↑ 主线程：监听通知 ↑↑↑ =====================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 处理通知</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">notificationHandler</span>(<span class="params">n</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> packageId = n.<span class="title function_">getPackageName</span>()  <span class="comment">// 获取通知包名</span></span><br><span class="line">    <span class="keyword">var</span> abstract = n.<span class="property">tickerText</span>         <span class="comment">// 获取通知摘要</span></span><br><span class="line">    <span class="keyword">var</span> text = n.<span class="title function_">getText</span>()              <span class="comment">// 获取通知文本</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 过滤 PackageId 白名单之外的应用所发出的通知</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_">filterNotification</span>(packageId, abstract, text)) &#123; </span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 监听摘要为 &quot;定时打卡&quot; 的通知, 不一定要从 Tasker 中发出通知, 日历、定时器等App均可实现</span></span><br><span class="line">    <span class="keyword">if</span> (abstract == <span class="string">&quot;定时打卡&quot;</span> &amp;&amp; !suspend) &#123; </span><br><span class="line">        needWaiting = <span class="literal">true</span></span><br><span class="line">        threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">        threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">doClock</span>()</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(text) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;打卡&quot;</span>: <span class="comment">// 监听文本为 &quot;打卡&quot; 的通知</span></span><br><span class="line">            needWaiting = <span class="literal">false</span></span><br><span class="line">            threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">doClock</span>()</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;查询&quot;</span>: <span class="comment">// 监听文本为 &quot;查询&quot; 的通知</span></span><br><span class="line">            threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                        <span class="title function_">sendQQMsg</span>(<span class="title function_">getStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>))</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                        <span class="title function_">sendEmail</span>(<span class="string">&quot;考勤结果&quot;</span>, <span class="title function_">getStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>), <span class="literal">null</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                        <span class="title function_">sendServerChan</span>(<span class="string">&quot;考勤结果&quot;</span>, <span class="title function_">getStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>))</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                        <span class="title function_">sendPushDeer</span>(<span class="string">&quot;考勤结果&quot;</span>, <span class="title function_">getStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>))</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;暂停&quot;</span>: <span class="comment">// 监听文本为 &quot;暂停&quot; 的通知</span></span><br><span class="line">            suspend = <span class="literal">true</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;暂停定时打卡&quot;</span>)</span><br><span class="line">            threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                        <span class="title function_">sendQQMsg</span>(<span class="string">&quot;修改成功, 已暂停定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                        <span class="title function_">sendEmail</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已暂停定时打卡功能&quot;</span>, <span class="literal">null</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                        <span class="title function_">sendServerChan</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已暂停定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                        <span class="title function_">sendPushDeer</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已暂停定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;恢复&quot;</span>: <span class="comment">// 监听文本为 &quot;恢复&quot; 的通知</span></span><br><span class="line">            suspend = <span class="literal">false</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;恢复定时打卡&quot;</span>)</span><br><span class="line">            threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                        <span class="title function_">sendQQMsg</span>(<span class="string">&quot;修改成功, 已恢复定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                        <span class="title function_">sendEmail</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已恢复定时打卡功能&quot;</span>, <span class="literal">null</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                        <span class="title function_">sendServerChan</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已恢复定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                        <span class="title function_">sendPushDeer</span>(<span class="string">&quot;修改成功&quot;</span>, <span class="string">&quot;已恢复定时打卡功能&quot;</span>)</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;日志&quot;</span>: <span class="comment">// 监听文本为 &quot;日志&quot; 的通知</span></span><br><span class="line">            threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">            threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">sendEmail</span>(<span class="string">&quot;获取日志&quot;</span>, globalLogFilePath, globalLogFilePath)</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (text == <span class="literal">null</span>) </span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 监听钉钉返回的考勤结果</span></span><br><span class="line">    <span class="keyword">if</span> (packageId == <span class="variable constant_">PACKAGE_ID_DD</span> &amp;&amp; text.<span class="title function_">indexOf</span>(<span class="string">&quot;考勤打卡&quot;</span>) &gt;= <span class="number">0</span>) &#123; </span><br><span class="line">        <span class="title function_">setStorageData</span>(<span class="string">&quot;dingding&quot;</span>, <span class="string">&quot;clockResult&quot;</span>, text)</span><br><span class="line">        threads.<span class="title function_">shutDownAll</span>()</span><br><span class="line">        threads.<span class="title function_">start</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">switch</span>(<span class="variable constant_">DEFAULT_MESSAGE_DELIVER</span>) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">QQ</span>:</span><br><span class="line">                    <span class="title function_">sendQQMsg</span>(text)</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">Email</span>:</span><br><span class="line">                    <span class="title function_">sendEmail</span>(<span class="string">&quot;考勤结果&quot;</span>, text, cameraFilePath)</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">ServerChan</span>:</span><br><span class="line">                    <span class="title function_">sendServerChan</span>(<span class="string">&quot;考勤结果&quot;</span>, text)</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="variable constant_">PUSH_METHOD</span>.<span class="property">PushDeer</span>:</span><br><span class="line">                    <span class="title function_">sendPushDeer</span>(<span class="string">&quot;考勤结果&quot;</span>, text)</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 打卡流程</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">doClock</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    currentDate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;本地时间: &quot;</span> + <span class="title function_">getCurrentDate</span>() + <span class="string">&quot; &quot;</span> + <span class="title function_">getCurrentTime</span>())</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;开始打卡流程!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">brightScreen</span>()      <span class="comment">// 唤醒屏幕</span></span><br><span class="line">    <span class="title function_">unlockScreen</span>()      <span class="comment">// 解锁屏幕</span></span><br><span class="line">    <span class="title function_">holdOn</span>()            <span class="comment">// 随机等待</span></span><br><span class="line">    <span class="title function_">signIn</span>()            <span class="comment">// 自动登录</span></span><br><span class="line">    <span class="title function_">handleLate</span>()        <span class="comment">// 处理迟到</span></span><br><span class="line">    <span class="title function_">attendKaoqin</span>()      <span class="comment">// 考勤打卡</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (currentDate.<span class="title function_">getHours</span>() &lt;= <span class="number">12</span>) </span><br><span class="line">    <span class="title function_">clockIn</span>()           <span class="comment">// 上班打卡</span></span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    <span class="title function_">clockOut</span>()          <span class="comment">// 下班打卡</span></span><br><span class="line">    </span><br><span class="line">    <span class="title function_">lockScreen</span>()        <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 发送邮件流程</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; title 邮件主题</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; message 邮件正文</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; attachFilePath 要发送的附件路径</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sendEmail</span>(<span class="params">title, message, attachFilePath</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;开始发送邮件流程!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">brightScreen</span>()      <span class="comment">// 唤醒屏幕</span></span><br><span class="line">    <span class="title function_">unlockScreen</span>()      <span class="comment">// 解锁屏幕</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(attachFilePath != <span class="literal">null</span> &amp;&amp; files.<span class="title function_">exists</span>(attachFilePath)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(attachFilePath)</span><br><span class="line">        app.<span class="title function_">sendEmail</span>(&#123;</span><br><span class="line">            <span class="attr">email</span>: [<span class="variable constant_">EMAILL_ADDRESS</span>], <span class="attr">subject</span>: title, <span class="attr">text</span>: message, <span class="attr">attachment</span>: attachFilePath</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(attachFilePath)</span><br><span class="line">        app.<span class="title function_">sendEmail</span>(&#123;</span><br><span class="line">            <span class="attr">email</span>: [<span class="variable constant_">EMAILL_ADDRESS</span>], <span class="attr">subject</span>: title, <span class="attr">text</span>: message</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;选择邮件应用&quot;</span>)</span><br><span class="line">    <span class="title function_">waitForActivity</span>(<span class="string">&quot;com.android.internal.app.ChooserActivity&quot;</span>) <span class="comment">// 等待选择应用界面弹窗出现, 如果设置了默认应用就注释掉</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> emailAppName = app.<span class="title function_">getAppName</span>(<span class="variable constant_">PACKAGE_ID_MAIL_163</span>)</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != emailAppName) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textMatches</span>(emailAppName).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">            btn_email = <span class="title function_">textMatches</span>(emailAppName).<span class="title function_">findOnce</span>().<span class="title function_">parent</span>()</span><br><span class="line">            btn_email.<span class="title function_">click</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;不存在应用: &quot;</span> + <span class="variable constant_">PACKAGE_ID_MAIL_163</span>)</span><br><span class="line">        <span class="title function_">lockScreen</span>()</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 网易邮箱大师</span></span><br><span class="line">    <span class="keyword">var</span> versoin = <span class="title function_">getPackageVersion</span>(<span class="variable constant_">PACKAGE_ID_MAIL_163</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;应用版本: &quot;</span> + versoin)</span><br><span class="line">    <span class="keyword">var</span> sp = versoin.<span class="title function_">split</span>(<span class="string">&quot;.&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> (sp[<span class="number">0</span>] == <span class="number">6</span>) &#123;</span><br><span class="line">        <span class="comment">// 网易邮箱大师 6</span></span><br><span class="line">        <span class="title function_">waitForActivity</span>(<span class="string">&quot;com.netease.mobimail.activity.MailComposeActivity&quot;</span>)</span><br><span class="line">        <span class="title function_">id</span>(<span class="string">&quot;send&quot;</span>).<span class="title function_">findOne</span>().<span class="title function_">click</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 网易邮箱大师 7</span></span><br><span class="line">        <span class="title function_">waitForActivity</span>(<span class="string">&quot;com.netease.mobimail.module.mailcompose.MailComposeActivity&quot;</span>)</span><br><span class="line">        <span class="keyword">var</span> input_address = <span class="title function_">id</span>(<span class="string">&quot;input&quot;</span>).<span class="title function_">findOne</span>()</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == input_address.<span class="title function_">getText</span>()) &#123;</span><br><span class="line">            input_address.<span class="title function_">setText</span>(<span class="variable constant_">EMAILL_ADDRESS</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">id</span>(<span class="string">&quot;iv_arrow&quot;</span>).<span class="title function_">findOne</span>().<span class="title function_">click</span>()</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">        <span class="title function_">id</span>(<span class="string">&quot;img_send_bg&quot;</span>).<span class="title function_">findOne</span>().<span class="title function_">click</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 内置电子邮件</span></span><br><span class="line">    <span class="comment">// waitForActivity(&quot;com.kingsoft.mail.compose.ComposeActivity&quot;)</span></span><br><span class="line">    <span class="comment">// id(&quot;compose_send_btn&quot;).findOne().click()</span></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在发送邮件...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">home</span>()</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">    <span class="title function_">lockScreen</span>()    <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 发送QQ消息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; message 消息内容</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sendQQMsg</span>(<span class="params">message</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;发送QQ消息&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">brightScreen</span>()      <span class="comment">// 唤醒屏幕</span></span><br><span class="line">    <span class="title function_">unlockScreen</span>()      <span class="comment">// 解锁屏幕</span></span><br><span class="line"></span><br><span class="line">    app.<span class="title function_">startActivity</span>(&#123; </span><br><span class="line">        <span class="attr">action</span>: <span class="string">&quot;android.intent.action.VIEW&quot;</span>, </span><br><span class="line">        <span class="attr">data</span>:<span class="string">&quot;mqq://im/chat?chat_type=wpa&amp;version=1&amp;src_type=web&amp;uin=&quot;</span> + <span class="variable constant_">QQ</span>, </span><br><span class="line">        <span class="attr">packageName</span>: <span class="string">&quot;com.tencent.mobileqq&quot;</span>, </span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// waitForActivity(&quot;com.tencent.mobileqq.activity.SplashActivity&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">id</span>(<span class="string">&quot;input&quot;</span>).<span class="title function_">findOne</span>().<span class="title function_">setText</span>(message)</span><br><span class="line">    <span class="title function_">id</span>(<span class="string">&quot;fun_btn&quot;</span>).<span class="title function_">findOne</span>().<span class="title function_">click</span>()</span><br><span class="line"></span><br><span class="line">    <span class="title function_">home</span>()</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    <span class="title function_">lockScreen</span>()    <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ServerChan推送</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; title 标题</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; message 消息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">sendServerChan</span>(<span class="params">title, message</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;向 ServerChan 发起推送请求&quot;</span>)</span><br><span class="line"></span><br><span class="line">    url = <span class="string">&quot;https://sctapi.ftqq.com/&quot;</span> + <span class="variable constant_">SERVER_CHAN</span> + <span class="string">&quot;.send&quot;</span>;</span><br><span class="line"></span><br><span class="line">    res = http.<span class="title function_">post</span>(<span class="built_in">encodeURI</span>(url), &#123;</span><br><span class="line">        <span class="string">&quot;title&quot;</span>: title,</span><br><span class="line">        <span class="string">&quot;desp&quot;</span>: message</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    <span class="title function_">lockScreen</span>()    <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> PushDeer推送</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; title 标题</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; message 消息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">sendPushDeer</span>(<span class="params">title, message</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;向 PushDeer 发起推送请求&quot;</span>)</span><br><span class="line"></span><br><span class="line">    url = <span class="string">&quot;https://api2.pushdeer.com/message/push&quot;</span></span><br><span class="line"></span><br><span class="line">    res = http.<span class="title function_">post</span>(<span class="built_in">encodeURI</span>(url), &#123;</span><br><span class="line">        <span class="string">&quot;pushkey&quot;</span>: <span class="variable constant_">PUSH_DEER</span>,</span><br><span class="line">        <span class="string">&quot;text&quot;</span>: title,</span><br><span class="line">        <span class="string">&quot;desp&quot;</span>: message,</span><br><span class="line">        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;markdown&quot;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    <span class="title function_">lockScreen</span>()    <span class="comment">// 关闭屏幕</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 唤醒设备</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">brightScreen</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;唤醒设备&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    device.<span class="title function_">setBrightnessMode</span>(<span class="number">0</span>) <span class="comment">// 手动亮度模式</span></span><br><span class="line">    device.<span class="title function_">setBrightness</span>(<span class="variable constant_">SCREEN_BRIGHTNESS</span>)</span><br><span class="line">    device.<span class="title function_">wakeUpIfNeeded</span>() <span class="comment">// 唤醒设备</span></span><br><span class="line">    device.<span class="title function_">keepScreenOn</span>()   <span class="comment">// 保持亮屏</span></span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>) <span class="comment">// 等待屏幕亮起</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!device.<span class="title function_">isScreenOn</span>()) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;设备未唤醒, 重试&quot;</span>)</span><br><span class="line">        device.<span class="title function_">wakeUpIfNeeded</span>()</span><br><span class="line">        <span class="title function_">brightScreen</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;设备已唤醒&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 解锁屏幕</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">unlockScreen</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;解锁屏幕&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isDeviceLocked</span>()) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">gesture</span>(</span><br><span class="line">            <span class="number">320</span>, <span class="comment">// 滑动时间：毫秒</span></span><br><span class="line">            [</span><br><span class="line">                device.<span class="property">width</span>  * <span class="number">0.5</span>,    <span class="comment">// 滑动起点 x 坐标：屏幕宽度的一半</span></span><br><span class="line">                device.<span class="property">height</span> * <span class="number">0.9</span>     <span class="comment">// 滑动起点 y 坐标：距离屏幕底部 10% 的位置, 华为系统需要往上一些</span></span><br><span class="line">            ],</span><br><span class="line">            [</span><br><span class="line">                device.<span class="property">width</span> / <span class="number">2</span>,       <span class="comment">// 滑动终点 x 坐标：屏幕宽度的一半</span></span><br><span class="line">                device.<span class="property">height</span> * <span class="number">0.1</span>     <span class="comment">// 滑动终点 y 坐标：距离屏幕顶部 10% 的位置</span></span><br><span class="line">            ]</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>) <span class="comment">// 等待解锁动画完成</span></span><br><span class="line">        <span class="title function_">home</span>()</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>) <span class="comment">// 等待返回动画完成</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isDeviceLocked</span>()) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;上滑解锁失败, 请按脚本中的注释调整 gesture(time, [x1,y1], [x2,y2]) 方法的参数!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;屏幕已解锁&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 随机等待</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">holdOn</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!needWaiting) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> randomTime = <span class="title function_">random</span>(<span class="variable constant_">LOWER_BOUND</span>, <span class="variable constant_">UPPER_BOUND</span>)</span><br><span class="line">    <span class="title function_">toastLog</span>(<span class="title class_">Math</span>.<span class="title function_">floor</span>(randomTime / <span class="number">1000</span>) + <span class="string">&quot;秒后启动&quot;</span> + app.<span class="title function_">getAppName</span>(<span class="variable constant_">PACKAGE_ID_DD</span>) + <span class="string">&quot;...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(randomTime)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 启动并登陆钉钉</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">signIn</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    app.<span class="title function_">launchPackage</span>(<span class="variable constant_">PACKAGE_ID_DD</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在启动&quot;</span> + app.<span class="title function_">getAppName</span>(<span class="variable constant_">PACKAGE_ID_DD</span>) + <span class="string">&quot;...&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">setVolume</span>(<span class="number">0</span>) <span class="comment">// 设备静音</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">10000</span>) <span class="comment">// 等待钉钉启动</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">currentPackage</span>() == <span class="variable constant_">PACKAGE_ID_DD</span> &amp;&amp;</span><br><span class="line">        <span class="title function_">currentActivity</span>() == <span class="string">&quot;com.alibaba.android.user.login.SignUpWithPwdActivity&quot;</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;账号未登录&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> account = <span class="title function_">id</span>(<span class="string">&quot;et_phone_input&quot;</span>).<span class="title function_">findOne</span>()</span><br><span class="line">        account.<span class="title function_">setText</span>(<span class="variable constant_">ACCOUNT</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;输入账号&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> password = <span class="title function_">id</span>(<span class="string">&quot;et_pwd_login&quot;</span>).<span class="title function_">findOne</span>()</span><br><span class="line">        password.<span class="title function_">setText</span>(<span class="variable constant_">PASSWORD</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;输入密码&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> privacy = <span class="title function_">id</span>(<span class="string">&quot;cb_privacy&quot;</span>).<span class="title function_">findOne</span>()</span><br><span class="line">        privacy.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;同意隐私协议&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> btn_login = <span class="title function_">id</span>(<span class="string">&quot;btn_next&quot;</span>).<span class="title function_">findOne</span>()</span><br><span class="line">        btn_login.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在登陆...&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">3000</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">currentPackage</span>() == <span class="variable constant_">PACKAGE_ID_DD</span> &amp;&amp;</span><br><span class="line">        <span class="title function_">currentActivity</span>() != <span class="string">&quot;com.alibaba.android.user.login.SignUpWithPwdActivity&quot;</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;账号已登录&quot;</span>)</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 处理迟到打卡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleLate</span>(<span class="params"></span>)&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textMatches</span>(<span class="string">&quot;迟到打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        btn_late = <span class="title function_">textMatches</span>(<span class="string">&quot;迟到打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>() </span><br><span class="line">        btn_late.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;迟到打卡&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">descMatches</span>(<span class="string">&quot;迟到打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        btn_late = <span class="title function_">descMatches</span>(<span class="string">&quot;迟到打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>() </span><br><span class="line">        btn_late.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;迟到打卡&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 使用 URL Scheme 进入考勤界面</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">attendKaoqin</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> url_scheme = <span class="string">&quot;dingtalk://dingtalkclient/page/link?url=https://attend.dingtalk.com/attend/index.html&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable constant_">CORP_ID</span> != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">        url_scheme = url_scheme + <span class="string">&quot;?corpId=&quot;</span> + <span class="variable constant_">CORP_ID</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> a = app.<span class="title function_">intent</span>(&#123;</span><br><span class="line">        <span class="attr">action</span>: <span class="string">&quot;VIEW&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: url_scheme,</span><br><span class="line">        <span class="comment">//flags: [Intent.FLAG_ACTIVITY_NEW_TASK]</span></span><br><span class="line">    &#125;);</span><br><span class="line">    app.<span class="title function_">startActivity</span>(a);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在进入考勤界面...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">textContains</span>(<span class="string">&quot;申请&quot;</span>).<span class="title function_">waitFor</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;已进入考勤界面&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 上班打卡 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clockIn</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;上班打卡...&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textContains</span>(<span class="string">&quot;已打卡&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;已打卡&quot;</span>)</span><br><span class="line">        <span class="title function_">toast</span>(<span class="string">&quot;已打卡&quot;</span>)</span><br><span class="line">        <span class="title function_">home</span>()</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;等待连接到考勤机...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textContains</span>(<span class="string">&quot;未连接&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;未连接考勤机, 重新进入考勤界面!&quot;</span>)</span><br><span class="line">        <span class="title function_">back</span>()</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">        <span class="title function_">attendKaoqin</span>()</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">textContains</span>(<span class="string">&quot;已连接&quot;</span>).<span class="title function_">waitFor</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;已连接考勤机&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textMatches</span>(<span class="string">&quot;上班打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        btn_clockin = <span class="title function_">textMatches</span>(<span class="string">&quot;上班打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>()</span><br><span class="line">        btn_clockin.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;按下打卡按钮&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">click</span>(device.<span class="property">width</span> / <span class="number">2</span>, device.<span class="property">height</span> * <span class="number">0.560</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;点击打卡按钮坐标&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    <span class="title function_">handleLate</span>() <span class="comment">// 处理迟到打卡</span></span><br><span class="line">    </span><br><span class="line">    <span class="title function_">home</span>()</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 下班打卡 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clockOut</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;下班打卡...&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;等待连接到考勤机...&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textContains</span>(<span class="string">&quot;未连接&quot;</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;未连接考勤机, 重新进入考勤界面!&quot;</span>)</span><br><span class="line">        <span class="title function_">back</span>()</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">2000</span>)</span><br><span class="line">        <span class="title function_">attendKaoqin</span>()</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">textContains</span>(<span class="string">&quot;已连接&quot;</span>).<span class="title function_">waitFor</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;已连接考勤机&quot;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textMatches</span>(<span class="string">&quot;下班打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        btn_clockout = <span class="title function_">textMatches</span>(<span class="string">&quot;下班打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>()</span><br><span class="line">        btn_clockout.<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;按下打卡按钮&quot;</span>)</span><br><span class="line">        <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">click</span>(device.<span class="property">width</span> / <span class="number">2</span>, device.<span class="property">height</span> * <span class="number">0.560</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;点击打卡按钮坐标&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != <span class="title function_">textContains</span>(<span class="string">&quot;早退打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOne</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">        <span class="title function_">className</span>(<span class="string">&quot;android.widget.Button&quot;</span>).<span class="title function_">text</span>(<span class="string">&quot;早退打卡&quot;</span>).<span class="title function_">clickable</span>(<span class="literal">true</span>).<span class="title function_">findOnce</span>().<span class="title function_">parent</span>().<span class="title function_">click</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;早退打卡&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">home</span>()</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 锁屏</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">lockScreen</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;关闭屏幕&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 锁屏方案1：Root</span></span><br><span class="line">    <span class="comment">// Power()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 锁屏方案2：No Root</span></span><br><span class="line">    <span class="comment">// press(Math.floor(device.width / 2), Math.floor(device.height * 0.973), 1000) // 小米的快捷手势：长按Home键锁屏</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 万能锁屏方案：向Tasker发送广播, 触发系统锁屏动作。配置方法见 2021-03-09 更新日志</span></span><br><span class="line">    app.<span class="title function_">sendBroadcast</span>(&#123;<span class="attr">action</span>: <span class="variable constant_">ACTION_LOCK_SCREEN</span>&#125;);</span><br><span class="line"></span><br><span class="line">    device.<span class="title function_">setBrightnessMode</span>(<span class="number">1</span>) <span class="comment">// 自动亮度模式</span></span><br><span class="line">    device.<span class="title function_">cancelKeepingAwake</span>() <span class="comment">// 取消设备常亮</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isDeviceLocked</span>()) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;屏幕已关闭&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;屏幕未关闭, 请尝试其他锁屏方案, 或等待屏幕自动关闭&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ===================== ↓↓↓ 功能函数 ↓↓↓ =======================</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">dateDigitToString</span>(<span class="params">num</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> num &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + num : num</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getCurrentTime</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> currentDate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">    <span class="keyword">var</span> hours = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getHours</span>())</span><br><span class="line">    <span class="keyword">var</span> minute = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getMinutes</span>())</span><br><span class="line">    <span class="keyword">var</span> second = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getSeconds</span>())</span><br><span class="line">    <span class="keyword">var</span> formattedTimeString = hours + <span class="string">&#x27;:&#x27;</span> + minute + <span class="string">&#x27;:&#x27;</span> + second</span><br><span class="line">    <span class="keyword">return</span> formattedTimeString</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getCurrentDate</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> currentDate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">    <span class="keyword">var</span> year = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getFullYear</span>())</span><br><span class="line">    <span class="keyword">var</span> month = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getMonth</span>() + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">var</span> date = <span class="title function_">dateDigitToString</span>(currentDate.<span class="title function_">getDate</span>())</span><br><span class="line">    <span class="keyword">var</span> week = currentDate.<span class="title function_">getDay</span>()</span><br><span class="line">    <span class="keyword">var</span> formattedDateString = year + <span class="string">&#x27;-&#x27;</span> + month + <span class="string">&#x27;-&#x27;</span> + date + <span class="string">&#x27;-&#x27;</span> + <span class="variable constant_">WEEK_DAY</span>[week]</span><br><span class="line">    <span class="keyword">return</span> formattedDateString</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通知过滤器</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">filterNotification</span>(<span class="params">bundleId, abstract, text</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> check = <span class="variable constant_">PACKAGE_ID_WHITE_LIST</span>.<span class="title function_">some</span>(<span class="keyword">function</span>(<span class="params">item</span>) &#123;<span class="keyword">return</span> bundleId == item&#125;) </span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable constant_">NOTIFICATIONS_FILTER</span> || check) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">verbose</span>(bundleId)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">verbose</span>(abstract)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">verbose</span>(text)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">verbose</span>(<span class="string">&quot;---------------------------&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 保存本地数据</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setStorageData</span>(<span class="params">name, key, value</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> storage = storages.<span class="title function_">create</span>(name)  <span class="comment">// 创建storage对象</span></span><br><span class="line">    storage.<span class="title function_">put</span>(key, value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取本地数据</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getStorageData</span>(<span class="params">name, key</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> storage = storages.<span class="title function_">create</span>(name)</span><br><span class="line">    <span class="keyword">if</span> (storage.<span class="title function_">contains</span>(key)) &#123;</span><br><span class="line">        <span class="keyword">return</span> storage.<span class="title function_">get</span>(key, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 默认返回undefined</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除本地数据</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">delStorageData</span>(<span class="params">name, key</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> storage = storages.<span class="title function_">create</span>(name)</span><br><span class="line">    <span class="keyword">if</span> (storage.<span class="title function_">contains</span>(key)) &#123;</span><br><span class="line">        storage.<span class="title function_">remove</span>(key)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取应用版本号</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getPackageVersion</span>(<span class="params">bundleId</span>) &#123;</span><br><span class="line">    <span class="title function_">importPackage</span>(android.<span class="property">content</span>)</span><br><span class="line">    <span class="keyword">var</span> pckMan = context.<span class="title function_">getPackageManager</span>()</span><br><span class="line">    <span class="keyword">var</span> packageInfo = pckMan.<span class="title function_">getPackageInfo</span>(bundleId, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> packageInfo.<span class="property">versionName</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 屏幕是否为锁定状态</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isDeviceLocked</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">importClass</span>(android.<span class="property">app</span>.<span class="property">KeyguardManager</span>)</span><br><span class="line">    <span class="title function_">importClass</span>(android.<span class="property">content</span>.<span class="property">Context</span>)</span><br><span class="line">    <span class="keyword">var</span> km = context.<span class="title function_">getSystemService</span>(<span class="title class_">Context</span>.<span class="property">KEYGUARD_SERVICE</span>)</span><br><span class="line">    <span class="keyword">return</span> km.<span class="title function_">isKeyguardLocked</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置媒体和通知音量</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setVolume</span>(<span class="params">volume</span>) &#123;</span><br><span class="line">    device.<span class="title function_">setMusicVolume</span>(volume)</span><br><span class="line">    device.<span class="title function_">setNotificationVolume</span>(volume)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">verbose</span>(<span class="string">&quot;媒体音量:&quot;</span> + device.<span class="title function_">getMusicVolume</span>())</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">verbose</span>(<span class="string">&quot;通知音量:&quot;</span> + device.<span class="title function_">getNotificationVolume</span>())</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="📐-工具介绍"><a href="#📐-工具介绍" class="headerlink" title="📐 工具介绍"></a>📐 工具介绍</h2><h3 id="Auto-js"><a href="#Auto-js" class="headerlink" title="Auto.js"></a>Auto.js</h3><p>Auto.js 是利用安卓系统的 「无障碍服务」 实现类似于按键精灵一样，可以通过代码模拟一系列界面动作的辅助工具。</p>
<p>与 「按键精灵」 不同的是，它的模拟动作并不是简单的使用在界面定坐标点来实现，而是找控件来实现的。</p>
<p>免费版：<a target="_blank" rel="noopener" href="https://github.com/georgehuan1994/DingDing-Automatic-Clock-in/raw/master/Autojs%204.1.1a%20Alpha2-armeabi-v7a-release.apk" title="Auto.js 4.1.1a Alpha2-armeabi-v7a-release">Auto.js 4.1.1a Alpha2-armeabi-v7a-release</a></p>
<p>github：<a target="_blank" rel="noopener" href="https://github.com/hyb1996/Auto.js">GitHub - hyb1996&#x2F;Auto.js</a></p>
<p>官方文档：<a target="_blank" rel="noopener" href="https://hyb1996.github.io/AutoJs-Docs/">首页 - Auto.js</a></p>
<p>推荐使用<a target="_blank" rel="noopener" href="https://github.com/hyb1996/Auto.js-VSCode-Extension">VS Code 插件</a>进行调试，调试完成后，还能通过此插件将脚本保存到手机上。</p>
<h3 id="Tasker"><a href="#Tasker" class="headerlink" title="Tasker"></a>Tasker</h3><p><a target="_blank" rel="noopener" href="https://play.google.com/store/apps/details?id=net.dinglisch.android.taskerm">Tasker</a> 也是一个安卓自动化神器，与 Auto.js 结合使用可胜任日常工作流。</p>
<p>此处仅提供 Tasker 5.0 及以下的官方原版，原版不含正版验证，使用不受限制：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/georgehuan1994/DingDing-Automatic-Clock-in/blob/master/Tasker.4.9u4m.apk">Tasker.4.9u4m.apk</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/georgehuan1994/DingDing-Automatic-Clock-in/blob/master/Tasker.5.0u7m.apk">Tasker.5.0u7m.apk</a></p>
<p>Tasker 定时打卡配置：</p>
<ol>
<li>添加一个 「通知」 操作任务，通知标题修改为 「定时打卡」，通知文字随意，通知优先级设为 1。</li>
<li>添加两个配置文件，使用日期和时间作为条件，分别在上班前和下班后触发。</li>
</ol>
<p>你也可以<a target="_blank" rel="noopener" href="https://github.com/georgehuan1994/DingDing-Automatic-Clock-in/tree/master/Tasker%E9%85%8D%E7%BD%AE">下载配置文件</a>，导入到 Tasker 中使用，方法如下：</p>
<ol>
<li>长按 菜单栏-任务，导入”发送通知.tsk.xml”。</li>
<li>长按 菜单栏-配置文件，导入”上班打卡.prf.xml” 和 “下班打卡.prf.xml”。</li>
<li>在任务编辑界面左下方有一个三角形的播放按钮，点击即可发送通知，方便调试。</li>
</ol>
<h2 id="🕹️-使用方法"><a href="#🕹️-使用方法" class="headerlink" title="🕹️ 使用方法"></a>🕹️ 使用方法</h2><h3 id="远程打卡"><a href="#远程打卡" class="headerlink" title="远程打卡"></a>远程打卡</h3><ul>
<li>向本机的 QQ 发送消息 「打卡」，或回复标题为 「打卡」 的邮件，或向 PushDeer 发送标题为「打卡」 的推送请求，即可触发打卡进程。</li>
<li>向本机的 QQ 发送消息 「查询」，或回复标题为 「查询」 的邮件，或向 PushDeer 发送标题为「查询」 的推送请求，即可查询最新一次打卡结果。</li>
</ul>
<h3 id="暂停-恢复定时打卡"><a href="#暂停-恢复定时打卡" class="headerlink" title="暂停&#x2F;恢复定时打卡"></a>暂停&#x2F;恢复定时打卡</h3><ul>
<li>向本机的 QQ 发送消息 「暂停」，或回复标题为 「暂停」 的邮件，或向 PushDeer 发送标题为「暂停」 的推送请求，即可暂停定时打卡功能（仅暂停定时打卡，不影响远程打卡功能）</li>
<li>向本机的 QQ 发送消息 「恢复」，或回复标题为 「恢复」 的邮件，或向 PushDeer 发送标题为「恢复」 的推送请求，即可恢复定时打卡功能。</li>
</ul>
<h2 id="⚠️-注意事项-必读"><a href="#⚠️-注意事项-必读" class="headerlink" title="⚠️ 注意事项 (必读!!!)"></a>⚠️ 注意事项 (必读!!!)</h2><ul>
<li>AutoJs Pro 版本屏蔽了一些主流应用，如果要使用 QQ 作为回复方式，不要使用 AutoJs Pro 版！</li>
<li>首次启动 AutoJs，需要为其开启无障碍权限。</li>
<li>运行脚本前，请在 AutoJs 菜单栏中（从屏幕左边划出），开启 「通知读取权限」。</li>
<li>若无法通过 <code>app.launchPackage()</code> 方法启动应用，请开启该应用的「自启动」「允许后台弹窗」。</li>
<li>AutoJs、Tasker 可息屏运行，需要在系统设置中开启通知亮屏。</li>
<li>为保证 AutoJs、Tasker 进程不被系统清理，可调整它们的电池管理策略、加入管理应用的白名单，为其开启前台服务、添加应用锁…</li>
<li>虽然脚本可执行完整的打卡步骤，但推荐开启钉钉的极速打卡功能，在钉钉启动时即可完成打卡，应把后续的步骤视为极速打卡失败后的保险措施。</li>
</ul>
<h2 id="📜-更新日志"><a href="#📜-更新日志" class="headerlink" title="📜 更新日志"></a>📜 更新日志</h2><h3 id="2022-03-26"><a href="#2022-03-26" class="headerlink" title="2022-03-26"></a>2022-03-26</h3><details open>
<summary></summary>

<ol>
<li>可以通过 PushDeer 接收通知、推送考勤结果</details></li>
</ol>
<h3 id="2022-03-01"><a href="#2022-03-01" class="headerlink" title="2022-03-01"></a>2022-03-01</h3><details open>
<summary></summary>

<ol>
<li>可以通过Server酱来推送考勤结果</details></li>
</ol>
<h3 id="2021-10-23"><a href="#2021-10-23" class="headerlink" title="2021-10-23"></a>2021-10-23</h3><details open>
<summary></summary>

<ol>
<li>适配网易邮箱大师7.0</details></li>
</ol>
<h3 id="2021-09-02"><a href="#2021-09-02" class="headerlink" title="2021-09-02"></a>2021-09-02</h3><details open>
<summary></summary>

<ol>
<li>新增获取日志功能，发送 「日志」，可将运行日志作为邮件附件发送（最好使用内置邮件）</li>
<li>优化通知过滤器，过滤 Tasker 发出的无效通知</details></li>
</ol>
<h3 id="2021-07-07"><a href="#2021-07-07" class="headerlink" title="2021-07-07"></a>2021-07-07</h3><details open>
<summary></summary>

<ol>
<li>登录流程自动同意隐私协议</details></li>
</ol>
<h3 id="2021-05-27"><a href="#2021-05-27" class="headerlink" title="2021-05-27"></a>2021-05-27</h3><details open>
<summary></summary>

<ol>
<li>修改了部分常量的命名</li>
<li>移除了休息日不打卡的判断</li>
<li>在邮件的基础上，增加QQ作为新的通讯方式。除发送考勤结果需要手动指定应用外，使用QQ向本机发送 「查询、暂停、恢复」 指令，则会用QQ来回复查询或操作结果；使用邮件向本机发送指令则用邮件回复。</details></li>
</ol>
<h3 id="2021-05-06"><a href="#2021-05-06" class="headerlink" title="2021-05-06"></a>2021-05-06</h3><details open>
<summary></summary>

<ol>
<li>增加音量上键监听，按下后中断所有子线程，也可以利用回调来进行调试</li>
<li>不再使用考勤机名称来判断连接状态</li>
<li>重新进入打卡界面前，先返回上级菜单，以解决顶号登录无法正常连接到考勤机的问题</li>
<li>启动钉钉时，将媒体音量和通知音量设为0</details></li>
</ol>
<h3 id="2021-03-15"><a href="#2021-03-15" class="headerlink" title="2021-03-15"></a>2021-03-15</h3><details open>
<summary></summary>

<ol>
<li>运行时检查Auto.js版本，脚本需要在Auto.js 4.1.0及以上版本中运行</li>
<li>新增解锁是否成功的判断，若解锁失败则停止运行脚本</li>
<li>优化 <code>signIn()</code> 方法，使用 bundleId + activity 来判断登录情况</li>
<li>优化部分控件和信息的获取方式</details></li>
</ol>
<h3 id="2021-03-09"><a href="#2021-03-09" class="headerlink" title="2021-03-09"></a>2021-03-09</h3><details open>
<summary></summary>

<ol>
<li><p>移除 「结束钉钉」、「检查更新」 这个两个过程，使用最近一次监测到的正在运行的应用的包名进行判断</p>
</li>
<li><p>补充一个万能锁屏方案：向Tasker发送广播，触发Tasker中的系统锁屏操作。</p>
<ul>
<li>在Tasker中添加一个任务，在任务中添加操作 「系统锁屏（关闭屏幕）」</li>
<li>在Tasker中添加一个事件类型的配置文件，事件类别：系统-收到的意图</li>
<li>在事件操作中填写：autojs.intent.action.LOCK_SCREEN ，保持发送方与接收方的action一致即可</li>
</ul>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">sendBroadcast</span>(&#123;</span><br><span class="line">        <span class="attr">action</span>: <span class="string">&#x27;autojs.intent.action.LOCK_SCREEN&#x27;</span></span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
</details>

<h3 id="2021-02-07"><a href="#2021-02-07" class="headerlink" title="2021-02-07"></a>2021-02-07</h3><details open>
<summary></summary>

<ol>
<li>防止监听事件被耗时操作阻塞。</details></li>
</ol>
<h3 id="2021-01-15"><a href="#2021-01-15" class="headerlink" title="2021-01-15"></a>2021-01-15</h3><details open>
<summary></summary> 

<ol>
<li>移除 「进入工作台」 以及 「进入考勤打卡界面」 这两个过程</li>
<li>启动并成功登录钉钉后，直接使用intent拉起考勤打卡界面</details></li>
</ol>
<h3 id="2021-01-08"><a href="#2021-01-08" class="headerlink" title="2021-01-08"></a>2021-01-08</h3><details open>
<summary></summary>

<ol>
<li>修复：通知过滤器报错</details></li>
</ol>
<h3 id="2020-12-30"><a href="#2020-12-30" class="headerlink" title="2020-12-30"></a>2020-12-30</h3><details open>
<summary></summary>

<ol>
<li>优化：现在可以通过邮件来 暂停&#x2F;恢复 定时打卡功能，以应对停工停产，或其他需要暂时停止定时打卡的特殊情况</details></li>
</ol>
<h3 id="2020-12-04"><a href="#2020-12-04" class="headerlink" title="2020-12-04"></a>2020-12-04</h3><details open>
<summary></summary>

<ol>
<li>优化：打卡过程在子线程中执行，钉钉返回打卡结果后，直接中断子线程，减少无效操作</details></li>
</ol>
<h3 id="2020-10-27"><a href="#2020-10-27" class="headerlink" title="2020-10-27"></a>2020-10-27</h3><details open>
<summary></summary>

<ol>
<li>修复：当钉钉的通知文本为null时，indexOf()方法无法正常执行</details></li>
</ol>
<h3 id="2020-09-24"><a href="#2020-09-24" class="headerlink" title="2020-09-24"></a>2020-09-24</h3><details open>
<summary></summary>

<ol>
<li>优化：使用URL Scheme直接拉起考勤打卡界面</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">attendKaoqin</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> a = app.<span class="title function_">intent</span>(&#123;</span><br><span class="line">        <span class="attr">action</span>: <span class="string">&quot;VIEW&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: <span class="string">&quot;dingtalk://dingtalkclient/page/link?url=https://attend.dingtalk.com/attend/index.html&quot;</span></span><br><span class="line">      &#125;);</span><br><span class="line">      app.<span class="title function_">startActivity</span>(a);</span><br><span class="line">      <span class="title function_">sleep</span>(<span class="number">5000</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="获取URL的方式如下："><a href="#获取URL的方式如下：" class="headerlink" title="获取URL的方式如下："></a>获取URL的方式如下：</h4><ol>
<li>在PC端找到 「智能工作助理」 联系人</li>
<li>发送消息 “打卡” ，点击 「立即打卡」 </li>
<li>弹出一个二维码。此二维码就是拉起考勤打卡界面的 URL，用自带的相机或其他应用扫描，并在浏览器中打开，即可获得完整URL</li>
<li>观察获取到的URL，找到 <code>CorpId=xxxxxxxxxxxxxxxxxxx</code> ，将CorpId的值填写到的脚本开头的CORP_ID这个常量中</li>
<li>仅使用 <code>dingtalk://dingtalkclient/page/link?url=https://attend.dingtalk.com/attend/index.html</code>，也可以拉起旧版打卡界面，钉钉会自动获取企业的CorpId。如果加入了多个组织，且没有填写CorpId，则在拉起考勤界面时会弹出一个选择组织的对话框。</details></li>
</ol>
<h3 id="2020-09-11"><a href="#2020-09-11" class="headerlink" title="2020-09-11"></a>2020-09-11</h3><details open>
<summary></summary>

<ol>
<li>将上次考勤结果储存在本地</li>
<li>将运行日志储存在本地 &#x2F;sdcard&#x2F;脚本&#x2F;Archive&#x2F;</li>
<li>修复在下班极速打卡之后，重复打卡的问题</details></li>
</ol>
<h3 id="2020-09-04"><a href="#2020-09-04" class="headerlink" title="2020-09-04"></a>2020-09-04</h3><details open>
<summary></summary>

<ol>
<li>将 “打卡” 与 “发送邮件” 分离成两个过程，打卡完成后，将钉钉返回的考勤结果作为邮件正文发送</details open></li>
</ol>
<h3 id="2020-09-02"><a href="#2020-09-02" class="headerlink" title="2020-09-02"></a>2020-09-02</h3><details open>
<summary></summary>

<ol>
<li>改为使用 “去打卡” 文本获取按钮。若找不到 “去打卡” 按钮，则直接点击 “考勤打卡” 的屏幕坐标</details></li>
</ol>
<h2 id="📢-声明"><a href="#📢-声明" class="headerlink" title="📢 声明"></a>📢 声明</h2><p>此仓库及脚本仅供学习交流，欢迎转载。旨在让人们关注996制度的存在和非法性，并尝试改变这种现象。</p>
<p>根据1994年第八届全国人大常委会通过和2018年第十三届全国人大常委会修正的《中华人民共和国劳动法》规定，劳动者<strong>每日工作时间不超过8小时，平均每周工作时间不超过44小时，而996工作制每周至少要工作72个小时</strong>，远超法律标准，因此996工作制度违反劳动法。</p>
<p><font color=red>而钉钉却允许企业管理者违反法律，非法排班！</font> </p>
<blockquote>

<p><strong>第三十六条</strong>　国家实行劳动者每日工作时间不超过八小时、平均每周工作时间不超过四十四小时的工时制度。</p>
<p><strong>第四十一条</strong>　用人单位由于生产经营需要，经与工会和劳动者协商后可以延长工作时间，一般每日不得超过一小时；因特殊原因需要延长工作时间的，在保障劳动者身体健康的条件下延长工作时间每日不得超过三小时，但是每月不得超过三十六小时。</p>
<p><strong>第四十四条</strong>　有下列情形之一的，用人单位应当按照下列标准支付高于劳动者正常工作时间工资的工资报酬：</p>
<p>（一）安排劳动者延长工作时间的，支付不低于工资的百分之一百五十的工资报酬；<br>（二）休息日安排劳动者工作又不能安排补休的，支付不低于工资的百分之二百的工资报酬；<br>（三）法定休假日安排劳动者工作的，支付不低于工资的百分之三百的工资报酬。  </p>
<p><strong>第九十条</strong>　用人单位违反本法规定，延长劳动者工作时间的，由劳动行政部门给予警告，责令改正，并可以处以罚款。</p>
<p><strong>第九十一条</strong>　用人单位有下列侵害劳动者合法权益情形之一的，由劳动行政部门责令支付劳动者的工资报酬、经济补偿，并可以责令支付赔偿金：</p>
<p>（二）拒不支付劳动者延长工作时间工资报酬的；</p>
</blockquote>

<p>相关项目：<a target="_blank" rel="noopener" href="https://github.com/georgehuan1994/996-Salary-Calculator">996 薪资计算助手</a></p>
<hr>
<pre><code>如果觉得还不错的话，就点击右上角, 给我个Star ⭐️ 鼓励一下我吧~
</code></pre>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/09/02/%E9%83%A8%E7%BD%B2%E6%89%8B%E5%86%8C/">hexo 部署手册</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-09-03</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/hexo/">hexo</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/hexo/">hexo</a></span><div class="content"><h1 id="Hexo-部署手册"><a href="#Hexo-部署手册" class="headerlink" title="Hexo 部署手册"></a>Hexo 部署手册</h1><h2 id="Hexo搭建步骤"><a href="#Hexo搭建步骤" class="headerlink" title="Hexo搭建步骤"></a><strong>Hexo搭建步骤</strong></h2><ol>
<li>安装Git</li>
<li>安装Node.js</li>
<li>安装Hexo</li>
<li>GitHub创建个人仓库</li>
<li>生成SSH添加到GitHub</li>
<li>将hexo部署到GitHub</li>
</ol>
<h2 id="1-安装Git"><a href="#1-安装Git" class="headerlink" title="1. 安装Git"></a><strong>1. 安装Git</strong></h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install git</span><br></pre></td></tr></table></figure>

<p>安装好后，用<code>git --version</code> 来查看一下版本</p>
<h2 id="2-安装nodejs"><a href="#2-安装nodejs" class="headerlink" title="2. 安装nodejs"></a><strong>2. 安装nodejs</strong></h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install nodejs</span><br><span class="line">sudo apt-get install npm</span><br></pre></td></tr></table></figure>

<p>检查一下有没有安装成功</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure>

<p>顺便说一下，windows在git安装完后，就可以直接使用git bash来敲命令行了，不用自带的cmd，cmd有点难用。</p>
<h2 id="3-安装hexo"><a href="#3-安装hexo" class="headerlink" title="3. 安装hexo"></a><strong>3. 安装hexo</strong></h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure>

<p>依旧用<code>hexo -v</code>查看一下版本，至此就全部安装完了。</p>
<p>接下来初始化一下hexo</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init myblog</span><br></pre></td></tr></table></figure>

<p>这个myblog可以自己取什么名字都行，然后</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> myblog //进入这个myblog文件夹</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure>

<p>使用命令 <code>hexo server</code> 可缩写<code>hexo s</code>启动服务</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>部署项目到Github远程仓库</p>
<ul>
<li>修改配置文件 _config.yml</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Deployment</span><br><span class="line">## Docs: https://hexo.io/docs/one-command-deployment</span><br><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: git@github.com:2757412961/2757412961.github.io.git</span><br><span class="line">  branch: web</span><br></pre></td></tr></table></figure>

<ul>
<li>操作命令</li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-deployer-git --save  #安装部署工具</span><br><span class="line">    $ hexo clean                            #清除缓存       可缩写hexo c</span><br><span class="line">    $ hexo generate                         #生成静态文件    可缩写hexo g</span><br><span class="line">    $ hexo deploy                           #部署到Github   可缩写hexo d</span><br><span class="line"># 操作合集</span><br><span class="line">hexo clean &amp;&amp; hexo generate &amp;&amp; hexo deploy</span><br></pre></td></tr></table></figure>

<h2 id="4-GitHub创建个人仓库"><a href="#4-GitHub创建个人仓库" class="headerlink" title="4. GitHub创建个人仓库"></a><strong>4. GitHub创建个人仓库</strong></h2><p>登录Github新建一个仓库，仓库名必须为你的<code>Github用户名.github.io</code>  例如: 我的用户名是:<code>Lete</code> 那么格式因该为：<code>lete.github.io</code></p>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/image-20220903214114617.png" alt="image-20220903214114617"></p>
<p>远程仓库开启 github pages，指定分支为上述提到的web</p>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/image-20220905104750608.png" alt="image-20220905104750608"></p>
<h2 id="5-生成SSH添加到GitHub"><a href="#5-生成SSH添加到GitHub" class="headerlink" title="5. 生成SSH添加到GitHub"></a><strong>5. 生成SSH添加到GitHub</strong></h2><p>安装成功后，将 git 与 GitHub 账号绑定，右键打开 Git Bash，然后设置配置信息：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 配置用户名和邮箱</span><br><span class="line">git config --global user.name &quot;github 用户名&quot;</span><br><span class="line">git config --global user.email &quot;github 注册邮箱&quot;</span><br></pre></td></tr></table></figure>

<p>比如我的配置就是：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">&quot;2757412961&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;2757412961@qq.com&quot;</span></span><br></pre></td></tr></table></figure>

<p>接着生成 ssh 密钥文件，输入如下命令后直接三次回车即可，一般不需要设置密码；</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 生成 ssh 密钥</span><br><span class="line">ssh-keygen -t rsa -C &quot;github 注册邮箱&quot;</span><br></pre></td></tr></table></figure>

<p>我生成秘钥的命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;2757412961@qq.com&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/v2-9e2d268a169026242849e2ff5325fcad_r.jpg" alt="img"></p>
<p>一般执行上述命令之后，会生成 <code>id_rsa</code> 和 <code>id_rsa.pub</code> 两个文件，前者是我们私有的，而后者则是对外开放的。接着找到生成的 <code>.ssh</code> 的文件夹中的 id_rsa.pub 密钥，将内容复制；</p>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/image-20220903214402850.png" alt="image-20220903214402850"></p>
<p>然后打开 <a href="https://link.zhihu.com/?target=https://github.com/settings/keys">GitHub-Settings-Keys</a> 页面，创建一个新的 SSH key，填写 <code>Title</code> 和 <code>Key</code>，<code>Title</code> 可以随意，而 <code>Key</code> 的内容则是我们刚才复制的 <code>id_rsa.pub</code> 中的内容，最后点击 <code>Add SSH key</code> 即可；</p>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/v2-fa367eb2c2c4749be656c34d782d6619_r.jpg" alt="img"></p>
<h2 id="6-将hexo部署到GitHub（手动）"><a href="#6-将hexo部署到GitHub（手动）" class="headerlink" title="6. 将hexo部署到GitHub（手动）"></a><strong>6. 将hexo部署到GitHub</strong>（手动）</h2><p>这一步，我们就可以将hexo和GitHub关联起来，也就是将hexo生成的文章部署到GitHub上，打开站点配置文件 <code>_config.yml</code>，翻到最后，修改为 YourgithubName就是你的GitHub账户</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/one-command-deployment</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:2757412961/2757412961.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">web</span></span><br></pre></td></tr></table></figure>

<p>然后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo generate &amp;&amp; hexo deploy</span><br></pre></td></tr></table></figure>

<h2 id="7-GitHub-Actions（自动）"><a href="#7-GitHub-Actions（自动）" class="headerlink" title="7.GitHub Actions（自动）"></a><strong>7.GitHub Actions（自动）</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">就是DevOps，可以理解成 GitHub 通过一些流水线的配置（CI/CD），然后在本地推送代码的时候触发流水线执行，自动部署站点。</span><br></pre></td></tr></table></figure>

<h3 id="7-1-新建-github-workflows-pages-yml-文件"><a href="#7-1-新建-github-workflows-pages-yml-文件" class="headerlink" title="7.1 新建 .github&#x2F;workflows&#x2F;pages.yml 文件"></a>7.1 新建 .github&#x2F;workflows&#x2F;pages.yml 文件</h3><p>修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 触发器、分支</span><br><span class="line">on:</span><br><span class="line">  push:</span><br><span class="line">    branches:</span><br><span class="line">      - main  # default branch</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">deploy_key: $&#123;&#123; secrets.ACTIONS_DEPLOY_KEY  &#125;&#125;</span><br><span class="line">user_name: 2757412961</span><br><span class="line">user_email: 2757412961@qq.com</span><br></pre></td></tr></table></figure>

<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Pages</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 触发器、分支</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">main</span>  <span class="comment"># default branch</span></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="comment"># 子任务</span></span><br><span class="line">  <span class="attr">pages:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span> <span class="comment"># 定运行所需要的虚拟机环境</span></span><br><span class="line">    <span class="attr">permissions:</span></span><br><span class="line">      <span class="attr">contents:</span> <span class="string">write</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line">        <span class="comment"># with:</span></span><br><span class="line">        <span class="comment">#   submodules: true</span></span><br><span class="line">        <span class="comment">#   fetch-depth: 0</span></span><br><span class="line">      <span class="comment"># 每个name表示一个步骤:step</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Use</span> <span class="string">Node.js</span> <span class="number">16.</span><span class="string">x</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/setup-node@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="string">&#x27;16.14.1&#x27;</span> <span class="comment"># 自己正在使用的node版本即可</span></span><br><span class="line">      <span class="comment"># - run: node -v # 查看node版本号</span></span><br><span class="line">      <span class="comment"># 缓存依赖项: https://docs.github.com/cn/actions/using-workflows/caching-dependencies-to-speed-up-workflows</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Cache</span> <span class="string">NPM</span> <span class="string">dependencies</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/cache@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="comment"># npm cache files are stored in `~/.npm` on Linux/macOS</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">~/.npm</span></span><br><span class="line">          <span class="comment"># path: node_modules</span></span><br><span class="line">          <span class="attr">key:</span> <span class="string">$&#123;&#123;</span> <span class="string">runner.OS</span> <span class="string">&#125;&#125;-npm-cache</span></span><br><span class="line">          <span class="attr">restore-keys:</span> <span class="string">|</span></span><br><span class="line"><span class="string">            $&#123;&#123; runner.OS &#125;&#125;-npm-cache</span></span><br><span class="line"><span class="string"></span>      <span class="comment"># 查看路径 : /home/runner/work/blog/blog</span></span><br><span class="line">      <span class="comment"># - name: Look Path</span></span><br><span class="line">      <span class="comment">#   run: pwd</span></span><br><span class="line">      <span class="comment"># 查看文件</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Look</span> <span class="string">Dir</span> <span class="string">List</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">tree</span> <span class="string">-L</span> <span class="number">3</span> <span class="string">-a</span></span><br><span class="line">      <span class="comment"># 第一次或者依赖发生变化的时候执行 Install Dependencies，其它构建的时候不需要这一步</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">Dependencies</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">npm</span> <span class="string">install</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Look</span> <span class="string">Dir</span> <span class="string">List</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">tree</span> <span class="string">-L</span> <span class="number">3</span> <span class="string">-a</span></span><br><span class="line">      <span class="comment"># - name: clean theme cache</span></span><br><span class="line">      <span class="comment">#   run: git rm -f --cached themes/tenacity</span></span><br><span class="line">        <span class="comment"># run: git submodule deinit themes/tenacity &amp;&amp; git rm themes/tenacity</span></span><br><span class="line">      <span class="comment"># 安装主题</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">Theme</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">git</span> <span class="string">submodule</span> <span class="string">add</span> <span class="string">https://github.com/all-smile/tenacity.git</span> <span class="string">themes/tenacity</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Clean</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">clean</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">build</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">peaceiris/actions-gh-pages@v3</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">deploy_key:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.ACTIONS_DEPLOY_KEY</span>  <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">user_name:</span> <span class="number">2757412961</span></span><br><span class="line">          <span class="attr">user_email:</span> <span class="number">2757412961</span><span class="string">@qq.com</span></span><br><span class="line">          <span class="comment"># 获取提交文章源码时的commit message，作为发布gh-pages分支的信息</span></span><br><span class="line">          <span class="attr">commit_message:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.event.head_commit.message</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">full_commit_message:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.event.head_commit.message</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">github_token:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GITHUB_TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="comment"># GITHUB_TOKEN不是个人访问令牌，GitHub Actions 运行器会自动创建一个GITHUB_TOKEN密钥以在您的工作流程中进行身份验证。因此，您无需任何配置即可立即开始部​​署</span></span><br><span class="line">          <span class="attr">publish_dir:</span> <span class="string">./public</span></span><br><span class="line">          <span class="attr">allow_empty_commit:</span> <span class="literal">true</span> <span class="comment"># 允许空提交</span></span><br><span class="line">      <span class="comment"># Use the output from the `deploy` step(use for test action)</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Get</span> <span class="string">the</span> <span class="string">output</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line">          <span class="string">echo</span> <span class="string">&quot;$<span class="template-variable">&#123;&#123; steps.deploy.outputs.notify &#125;&#125;</span>&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="7-2-修改-config-yml-文件中的Deploy配置"><a href="#7-2-修改-config-yml-文件中的Deploy配置" class="headerlink" title="7.2 修改 _config.yml 文件中的Deploy配置"></a>7.2 修改 <code>_config.yml</code> 文件中的<code>Deploy</code>配置</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/one-command-deployment</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:2757412961/2757412961.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">web</span></span><br><span class="line">  <span class="comment"># 默认提交信息： Site updated: &#123;&#123; now(&#x27;YYYY-MM-DD HH:mm:ss&#x27;) &#125;&#125;</span></span><br><span class="line">  <span class="attr">message:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.event.head_commit.message</span> <span class="string">&#125;&#125;</span> <span class="comment"># 直接将提交消息传输到 GitHub Pages 存储库</span></span><br></pre></td></tr></table></figure>

<h3 id="7-3-设置-deploy-key"><a href="#7-3-设置-deploy-key" class="headerlink" title="7.3 设置 deploy_key"></a>7.3 设置 deploy_key</h3><p>拿到第5步中生成的密钥。</p>
<ul>
<li><code>id_rsa</code> 私钥</li>
<li><code>id_rsa.pub </code>公钥</li>
</ul>
<p>转到<code>Deploy Keys</code>并使用<code>Allow write access</code>添加您的公钥<code>id_rsa.pub</code>，name写为<code>HEXO_ACTIONS_DEPLOY_KEY</code>，指定用途，方便后面维护</p>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/image-20220905113340582.png" alt="image-20220905113340582"></p>
<p>转到<code>Actions secrets</code>并将您的私钥 <code>id_rsa</code>  添加为 <code>ACTIONS_DEPLOY_KEY</code>（这个名称在yml文件中需要使用）</p>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/image-20220905111813096.png" alt="image-20220905111813096"></p>
<h3 id="7-4-启动-Git-Action"><a href="#7-4-启动-Git-Action" class="headerlink" title="7.4 启动 Git Action"></a>7.4 启动 Git Action</h3><p>本地仓库直接<code>push</code>，触发 <code>GitHub Actions</code> 自动构建发布</p>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/image-20220905112116599.png" alt="image-20220905112116599"></p>
<h3 id="7-5-非法输入值"><a href="#7-5-非法输入值" class="headerlink" title="7.5 	非法输入值"></a>7.5 	非法输入值</h3><p>在 <code>pages.yml</code> 文件的 <code>Deploy</code> 步骤下，发布的时候需要一些参数配置，这些参数名是指定好的，不可以随便写，比如 <code>commit_msg</code>应该使用 <code>commit_message</code></p>
<blockquote>
<p>Warning: Unexpected input(s) ‘commit_msg’, valid inputs are [‘deploy_key’, ‘github_token’, ‘personal_token’, ‘publish_branch’, ‘publish_dir’, ‘destination_dir’, ‘external_repository’, ‘allow_empty_commit’, ‘keep_files’, ‘force_orphan’, ‘user_name’, ‘user_email’, ‘commit_message’, ‘full_commit_message’, ‘tag_name’, ‘tag_message’, ‘enable_jekyll’, ‘disable_nojekyll’, ‘cname’, ‘exclude_assets’]</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/1037867-20220820200146599-1908531800.png" alt="img"></p>
<h2 id="8-参考文献"><a href="#8-参考文献" class="headerlink" title="8 参考文献"></a>8 参考文献</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/all-smile/p/16608503.html">https://www.cnblogs.com/all-smile/p/16608503.html</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/04/07/java/Java%20%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/">java 动态代理</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-04-08</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/java/">java</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/">动态代理</a></span><div class="content"><p>[TOC]</p>
<h1 id="一、代理模式简介"><a href="#一、代理模式简介" class="headerlink" title="一、代理模式简介"></a>一、代理模式简介</h1><h2 id="1-1、代理模式"><a href="#1-1、代理模式" class="headerlink" title="1.1、代理模式"></a>1.1、代理模式</h2><p>提供了间接对目标对象进行访问的方式，即通过代理对象访问目标对象。</p>
<h2 id="1-2、代理模式的好处"><a href="#1-2、代理模式的好处" class="headerlink" title="1.2、代理模式的好处"></a>1.2、代理模式的好处</h2><p>在实现目标对象功能的基础上，增加额外的功能，扩充目标对象的功能。符合<strong>开闭原则</strong>：即不改变既有代码的前提下，对功能进行扩展。</p>
<p>例如，需要在所有类的方法执行前后打印日志。</p>
<h1 id="二、JVM-创建对象"><a href="#二、JVM-创建对象" class="headerlink" title="二、JVM 创建对象"></a>二、JVM 创建对象</h1><h2 id="对象创建过程"><a href="#对象创建过程" class="headerlink" title="对象创建过程"></a>对象创建过程</h2><center>
<img style="border-radius: 0.3125em;
box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
src="http://msy-test.oss-cn-hangzhou.aliyuncs.com/share/docs/java/dynamicProxy/Java%20%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%20fig001.png">
<br>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">对象创建过程</div>


<h2 id="关于-Class-对象和实例对象"><a href="#关于-Class-对象和实例对象" class="headerlink" title="关于 Class 对象和实例对象"></a>关于 Class 对象和实例对象</h2><p><strong>Class 对象</strong>：每个类运行时的类型信息由 Class 对象来表示，Class 对象中包含与这个类有关的信息。</p>
<p><strong>实例对象</strong>：实例对象是由 Class 对象创建的。</p>
<center>
<img style="border-radius: 0.3125em;
box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
src="http://msy-test.oss-cn-hangzhou.aliyuncs.com/share/docs/java/dynamicProxy/Java%20%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%20fig002.png">
<br>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;"> Class 对象和实例对象</div>

<p>Java 程序在开始运行之前并非被完全加载，其各个类都是在必需时才加载的 —— 懒加载</p>
<h2 id="获取-Class-对象的方式"><a href="#获取-Class-对象的方式" class="headerlink" title="获取 Class 对象的方式"></a>获取 Class 对象的方式</h2><blockquote>
<p>Class.forName(“类的全限定名”)</p>
</blockquote>
<blockquote>
<p>实例对象.getClass()</p>
</blockquote>
<blockquote>
<p>类名.class —— 类字面常量</p>
<p>如：</p>
<p>Class clazz &#x3D; int.class</p>
</blockquote>
<p>如果字段被 <code>static final</code> 修饰，称为“编译时常量”。调用该字段时，不会对类进行初始化。</p>
<p>因为这个字段在编译期就把结果放入常量池中了。</p>
<h1 id="三、静态代理"><a href="#三、静态代理" class="headerlink" title="三、静态代理"></a>三、静态代理</h1><p>静态代理的逻辑：</p>
<center>
<img style="border-radius: 0.3125em;
box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
src="http://msy-test.oss-cn-hangzhou.aliyuncs.com/share/docs/java/dynamicProxy/Java%20%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%20fig003.png">
<br>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">静态代理的逻辑</div>


<h2 id="静态代理缺陷"><a href="#静态代理缺陷" class="headerlink" title="静态代理缺陷"></a>静态代理缺陷</h2><p>对于每一个目标类都需要写对应的 XXProxy 代理类，如果目标类很多的话，写成百上千个代理类是不切实际的。</p>
<h1 id="四、动态代理"><a href="#四、动态代理" class="headerlink" title="四、动态代理"></a>四、动态代理</h1><h2 id="动态代理的思路"><a href="#动态代理的思路" class="headerlink" title="动态代理的思路"></a>动态代理的思路</h2><center>
<img style="border-radius: 0.3125em;
box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
src="http://msy-test.oss-cn-hangzhou.aliyuncs.com/share/docs/java/dynamicProxy/Java%20%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%20fig004.png">
<br>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">动态代理的思路</div>

<h2 id="动态代理的优势"><a href="#动态代理的优势" class="headerlink" title="动态代理的优势"></a>动态代理的优势</h2><p>在程序运行时，JVM 才对被代理对象（目标对象）生成代理对象。涉及到反射。</p>
<p><em>注意，动态代理的时候目标对象必须得实现接口，否则动态代理无法使用，原因很明显，因为代理对象本身不用实现接口，它用到的是目标对象的引用，所以如果目标对象不实现接口的话，根本没法进行代理。</em></p>
<p>如何从 interface 创建 Class 对象？</p>
<p>JDK 提供：<code>java.lang.reflect.InvocationHandler</code>接口 + <code>java.lang.reflect.Proxy</code> 类</p>
<p>Proxy 类有一个静态方法： </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Class&lt;?&gt; getProxyClass(ClassLoader loader, Class&lt;?&gt;... interfaces)</span><br></pre></td></tr></table></figure>

<p>入参是 ClassLoader 类加载器以及一组接口 Class 对象。出参是 Class 类型，也就是一个 Class 对象，实际就是一个代理 Class，通过这个 Class 可以创建对应入参的代理对象。</p>
<center>
<img style="border-radius: 0.3125em;
box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
src="http://msy-test.oss-cn-hangzhou.aliyuncs.com/share/docs/java/dynamicProxy/Java%20%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%20fig005.png">
<br>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;"> </div>

<h2 id="动态代理的实现"><a href="#动态代理的实现" class="headerlink" title="动态代理的实现"></a>动态代理的实现</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DynamicProxy</span>  &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">    <span class="comment">// 通过 Dog 接口创建了一个代理 Class</span></span><br><span class="line">    <span class="type">Class</span> <span class="variable">proxyClass</span> <span class="operator">=</span> Proxy.getProxyClass(Dog.class.getClassLoader(), Dog.class);</span><br><span class="line">    <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> proxyClass.getConstructor(InvocationHandler.class);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 用构造器创建代理实例对象，需要传入 InvocationHandler</span></span><br><span class="line">    <span class="type">Dog</span> <span class="variable">dog</span> <span class="operator">=</span> (Dog)constructor.newInstance(<span class="keyword">new</span> <span class="title class_">InvocationHandler</span>() &#123;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 调用代理对象的方法，都会调用 invoke()</span></span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="comment">// 代理需要目标对象的引用</span></span><br><span class="line">        <span class="comment">// 手动创建目标对象，硬编码，不推荐</span></span><br><span class="line">        <span class="comment">// 推荐的做法是，将目标对象作为参数传进来</span></span><br><span class="line">        <span class="type">WhiteDog</span> <span class="variable">whiteDog</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WhiteDog</span>();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> method.invoke(whiteDog, args);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    dog.canRun();</span><br><span class="line">    dog.canBark();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 重构之后</span></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DynamicProxy</span>  &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">    <span class="type">WhiteDog</span> <span class="variable">target</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WhiteDog</span>();</span><br><span class="line">    <span class="type">Dog</span> <span class="variable">dog</span> <span class="operator">=</span> (Dog) getProxy(target);</span><br><span class="line"></span><br><span class="line">    dog.canRun();</span><br><span class="line">    dog.canBark();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 传入目标对象的引用 target  </span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Object <span class="title function_">getProxy</span><span class="params">(<span class="keyword">final</span> Object target)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">    <span class="type">Class</span> <span class="variable">proxyClass</span> <span class="operator">=</span> Proxy.getProxyClass(Dog.class.getClassLoader(), Dog.class);</span><br><span class="line">    <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> proxyClass.getConstructor(InvocationHandler.class);</span><br><span class="line">    <span class="comment">// 入参是目标对象 target， 出参是代理对象 proxy， 类型是 Object </span></span><br><span class="line">    <span class="keyword">return</span> constructor.newInstance(<span class="keyword">new</span> <span class="title class_">InvocationHandler</span>() &#123;</span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="keyword">return</span> method.invoke(target, args);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>实际使用的是 <code>Proxy.newProxyInstance()</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 传入目标对象的引用 target  </span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Object <span class="title function_">getProxy2</span><span class="params">(<span class="keyword">final</span> Object target)</span> <span class="keyword">throws</span> Throwable&#123;</span><br><span class="line"><span class="keyword">return</span> Proxy.newProxyInstance(</span><br><span class="line">        target.getClass().getClassLoader(), <span class="comment">// 类加载器</span></span><br><span class="line">        target.getClass().getInterfaces(),	<span class="comment">// 让代理实例对象和原对象实现同一个接口</span></span><br><span class="line">        <span class="comment">// 这么写其实是 匿名内部类 的写法</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">InvocationHandler</span>() &#123;			<span class="comment">// 代理对象的方法最终会导向 invoke 方法</span></span><br><span class="line">          <span class="meta">@Override</span></span><br><span class="line">          <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">            <span class="keyword">return</span> method.invoke(target,args);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="动态代理逻辑图"><a href="#动态代理逻辑图" class="headerlink" title="动态代理逻辑图"></a>动态代理逻辑图</h2><center>
<img style="border-radius: 0.3125em;
box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
src="http://msy-test.oss-cn-hangzhou.aliyuncs.com/share/docs/java/dynamicProxy/Java%20%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%20fig006.png">
<br>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">动态代理逻辑图</div>


<h1 id="五、Cglib-代理"><a href="#五、Cglib-代理" class="headerlink" title="五、Cglib 代理"></a>五、Cglib 代理</h1><h2 id="Cglib-代理的实现"><a href="#Cglib-代理的实现" class="headerlink" title="Cglib 代理的实现"></a>Cglib 代理的实现</h2><p>前面说的动态代理需要目标类实现接口，但是如果某个类根本不实现接口怎么办呢？这时候就需要 Cglib 代理了，也称 <strong>子类代理</strong>。</p>
<p>逻辑是在内存中构建一个子类对象集成目标对象，实现目标对象的功能扩展。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> net.sf.cglib.proxy.Enhancer;</span><br><span class="line"><span class="keyword">import</span> net.sf.cglib.proxy.MethodInterceptor;</span><br><span class="line"><span class="keyword">import</span> net.sf.cglib.proxy.MethodProxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CglibProxy</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="comment">// 目标： 通过 Cglib 代理 BlackDog</span></span><br><span class="line">    <span class="type">Enhancer</span> <span class="variable">enhancer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Enhancer</span>();</span><br><span class="line">    enhancer.setSuperclass(BlackDog.class);</span><br><span class="line">    </span><br><span class="line">    enhancer.setCallback(<span class="keyword">new</span> <span class="title class_">MethodInterceptor</span>() &#123;</span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="keyword">public</span> Object <span class="title function_">intercept</span><span class="params">(Object o, Method method, Object[] objects, MethodProxy methodProxy)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="comment">// 此处一定要使用 proxy 的 invokeSuper 方法来调用目标类的方法  </span></span><br><span class="line">        <span class="keyword">return</span> methodProxy.invokeSuper(o, objects);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 生成代理实例  </span></span><br><span class="line">    <span class="type">BlackDog</span> <span class="variable">dog</span> <span class="operator">=</span> (BlackDog)enhancer.create();</span><br><span class="line">    dog.canBark();</span><br><span class="line">    dog.canRun();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Cglib-代理总结"><a href="#Cglib-代理总结" class="headerlink" title="Cglib 代理总结"></a>Cglib 代理总结</h2><p>在 Spring 的 AOP 编程中: 面向切面编程</p>
<p>如果加入容器的目标对象<strong>有实现接口, 用 JDK 的动态代理</strong></p>
<p>如果目标对象<strong>没有实现接口,用 Cglib 代理</strong>。</p>
<h1 id="六、参考材料"><a href="#六、参考材料" class="headerlink" title="六、参考材料"></a>六、参考材料</h1><p><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/20794107">Java 动态代理作用是什么？</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/jie-y/p/10732347.html">Java中三种代理模式</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/dufufd/article/details/80537638">Java中Class对象详解</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/11/09/%E8%B0%83%E7%A0%94/%E4%BA%91%E5%8E%9F%E7%94%9F-%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%A0%94/">云原生概念和技术路线</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-11-10</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%B0%83%E7%A0%94/">调研</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/">云原生</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E5%8F%91%E5%B1%95%E8%B6%8B%E5%8A%BF/">发展趋势</a></span><div class="content"><h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><p><a href="#_Toc78190625">目录	1</a><br><a href="#_Toc78190626">一、	调研方向	2</a><br><a href="#_Toc78190627">二、	云原生的概念	3</a><br><a href="#_Toc78190630">2.1	云原生的诞生	3</a><br><a href="#_Toc78190631">2.2	云原生的发展历程	3</a><br><a href="#_Toc78190632">2.3	Pivotal的云原生定义	4</a><br><a href="#_Toc78190633">2.4	Gartner的云原生定义	5</a><br><a href="#_Toc78190634">2.5	CNCF的云原生定义	5</a><br><a href="#_Toc78190635">2.6	云原生定义概括	5</a><br><a href="#_Toc78190636">三、	CNCF	7</a><br><a href="#_Toc78190638">3.1	云原生计算基金会CNCF	7</a><br><a href="#_Toc78190639">3.2	CNCF云原生路线图（Trail Map）	7</a><br><a href="#_Toc78190640">3.3	CNCF云原生全景图（Trail Map）	8</a><br><a href="#_Toc78190641">四、	相关技术及发展趋势	10</a><br><a href="#_Toc78190644">4.1	CNCF云原生全景图详解	10</a><br><a href="#_Toc78190645"><strong>4.1.1</strong>	<strong>供应层 （Provisioning）</strong>	10</a><br><a href="#_Toc78190646"><strong>4.1.2</strong>	<strong>运行时层（Runtime）</strong>	10</a><br><a href="#_Toc78190647"><strong>4.1.3</strong>	<strong>编排和管理层（Orchestration and Management）</strong>	10</a><br><a href="#_Toc78190648"><strong>4.1.4</strong>	<strong>应用定义和开发层 （Application Definition and Developement)</strong>	11</a><br><a href="#_Toc78190649">4.1.5	贯穿所有层的工具	11</a><br><a href="#_Toc78190650"><strong>4.1.6</strong>	<strong>可观察性和分析（Observability and Analysis）</strong>	12</a><br><a href="#_Toc78190651"><strong>4.1.7</strong>	<strong>平台类（Platform）</strong>	12</a><br><a href="#_Toc78190652"><strong>4.1.8</strong>	<strong>小结</strong>	12</a><br><a href="#_Toc78190653">4.2	云原生核心概念	12</a><br><a href="#_Toc78190654">4.2.1	DevOps与CI&#x2F;CD	13</a><br><a href="#_Toc78190655">4.2.2	微服务、API管理与集成	14</a><br><a href="#_Toc78190656">4.2.3	容器与Docker	14</a><br><a href="#_Toc78190657">4.2.4	Kubernetes与容器编排之战	15</a><br><a href="#_Toc78190658">4.3	发展趋势和未来展望	15</a><br><a href="#_Toc78190659">4.3.1	机遇和挑战	15</a><br><a href="#_Toc78190660">4.3.2	云原生2.0（华为）	18</a><br><a href="#_Toc78190661">4.3.3	未来发展趋势	18</a><br><a href="#_Toc78190662">五、	参考链接	20</a></p>
<h1 id="1-调研方向"><a href="#1-调研方向" class="headerlink" title="1 调研方向"></a>1 调研方向</h1><p><strong>梳理云原生的概念及相关技术和发展趋势。</strong><br><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/1627293312483-b1fe9a40-7739-4fe9-b0ba-95bd5097721a.png"><br><a target="_blank" rel="noopener" href="https://landscape.cncf.io/">https://landscape.cncf.io/</a><br>图 一.1CNCF云原生全景图（详）</p>
<h1 id="2-云原生的概念"><a href="#2-云原生的概念" class="headerlink" title="2 云原生的概念"></a>2 云原生的概念</h1><p>1. </p>
<p>1. </p>
<h2 id="2-1-云原生的诞生"><a href="#2-1-云原生的诞生" class="headerlink" title="2.1 云原生的诞生"></a>2.1 云原生的诞生</h2><p>随着虚拟化技术的成熟和分布式框架的普及，在容器技术、可持续交付、编排系统等开源社区的推动下，以及微服务等开发理念的带动下，应用上云已经是不可逆转的趋势。<br><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/1627293312952-24b4c269-ad7c-4d09-b4ba-3560ce116dde.png"><br>图 二.1云原生的发展史，来自CNCF基金会执行董事Dan Kohn<br>云计算的3层划分，即基础设施即服务(IaaS)、平台即服务(PaaS)、软件即服务(SaaS)为云原生提供了技术基础和方向指引，真正的云化不仅仅是基础设施和平台的变化，应用也需要做出改变，<strong>摈弃传统的土方法，在架构设计、开发方式、部署维护等各个阶段和方面都基于云的特点，重新设计，从而建设全新的云化的应用，即云原生应用</strong>。</p>
<h2 id="2-2-云原生的发展历程"><a href="#2-2-云原生的发展历程" class="headerlink" title="2.2 云原生的发展历程"></a>2.2 云原生的发展历程</h2><p>云原生（Cloud Native）最初来描述云上应用的典型架构与特性，随着容器、kubernetes、Serverless、FaaS技术的演进，<strong>CNCF（Cloud Native Computing Foundation ，云原生计算基金会）</strong>把云原生的概念更广泛地定义为“让应用更有弹性、容错性、观测性的基础技术，让应用更容易部署、管理的基础软件、让应用更容易编写、编排的运行框架等”，希望能够让开发者最好的利用云的资源、产品和交付能力。<br>下边大致梳理一下云原生的发展过程。</p>
<ul>
<li>2004 年 ~ 2007 年，Google 已在内部大规模地使用像 Cgroups 这样的容器技术；</li>
<li>2008 年，Google 将 Cgroups 合并进入了 Linux 内核主干。</li>
<li>2013 年，Docker 项目正式发布。</li>
<li>2014 年，Kubernetes 项目也正式发布。</li>
<li>2015 年，CNCF （Cloud Native Computing Foundation）云原生基金会成立，CNCF 是目前云计算领域最成功的开源基金会之一，是 Kubernetes、 etcd、Envoy 等知名开源项目的托管基金会。</li>
<li>2017 年，CNCF 达到 170 个成员和 14 个基金项目。</li>
<li>2018 年，CNCF 成立三周年有了 195 个成员，19 个基金会项目和 11 个孵化项目，如此之快的发展速度在整个云计算领域都是非常罕见的。</li>
</ul>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/1627293313305-f9446b43-e3d3-4f41-be97-be7c5dc122fc.png"></p>
<h2 id="2-3-Pivotal的云原生定义"><a href="#2-3-Pivotal的云原生定义" class="headerlink" title="2.3 Pivotal的云原生定义"></a>2.3 Pivotal的云原生定义</h2><p>云原生（Cloud Native）这个概念，是由Pivotal的Matt Stine于2013年首次提出，他还在2015年出版了《Migrating to Cloud-Native Application Architectures（迁移到云原生架构）》一书。<br><strong>Pivotal作为云原生（Cloud Native）应用架构中先驱者和探路者</strong>，于2015年提出了云原生应用。同一年Google主导成立了云原生计算基金会（CNCF），起初CNCF对云原生的定义包含三个方面：应用容器化、面向微服务架构、应用支持容器的编排调度。<br>随着科技的发展，CNCF基金会对云原生进行了重新定义：云原生的代表技术包括<strong>容器、服务网格、微服务、不可变基础设施和声明式API</strong>。<br>上面提到云原生的代表技术包括容器、服务网格（Service Mesh）、微服务、不可变基础设施和声明式API。另外一种比较主流的说法是云原生&#x3D;微服务+DevOps+持续交付+容器化<br><strong>Pivotal最新官网对云原生概括为4个要点：DevOps+持续交付+微服务+容器。</strong><br><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/1627293313678-41e6055a-aa27-4b52-9f8d-9f5a657a697b.jpeg"></p>
<h2 id="2-4-Gartner的云原生定义"><a href="#2-4-Gartner的云原生定义" class="headerlink" title="2.4 Gartner的云原生定义"></a>2.4 Gartner的云原生定义</h2><p>2019年，Gartner曾经发布报告表示云原生时代已经到来，在未来三年中将有75%的全球化企业将在生产中使用容器化的应用。<br>但Gartner提到云原生的定义尚不明确，却含义丰富。云原生对于不同的人和组织来讲，有着不同的理解。众多顶级技术的铸造者、Matt Stine的东家Pivotal<a href="https://link.zhihu.com/?target=https://tanzu.vmware.com/de/cloud-native">如此</a>定义云原生。<br><strong>“Cloud native is an approach to building and running applications that fully exploit the advantages of the cloud computing model.”–云原生是一种构建和运行充分利用云计算模型优势的应用程序的方法。</strong></p>
<h2 id="2-5-CNCF的云原生定义"><a href="#2-5-CNCF的云原生定义" class="headerlink" title="2.5 CNCF的云原生定义"></a>2.5 CNCF的云原生定义</h2><p>CNCF云原生计算基金会<a href="https://link.zhihu.com/?target=https://github.com/cncf/toc/blob/master/DEFINITION.md%25EF%25BC%2589">如此</a>定义云原生：<br><strong>“云原生技术有利于各组织在公有云、私有云和混合云等新型动态环境中，构建和运行可弹性扩展的应用。云原生的代表技术包括<strong><strong>容器、服务网格（Service Mesh）、微服务、不可变基础设施和声明式API</strong></strong>。这些技术能够构建容错性好、易于管理和便于观察的松耦合系统。结合可靠的自动化手段，云原生技术使工程师能够轻松地对系统作出频繁和可预测的重大变更。”</strong><br><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/1627293314003-b21794bd-9807-4fb2-a4ad-5f25193e9b00.jpeg"></p>
<h2 id="2-6-云原生定义概括"><a href="#2-6-云原生定义概括" class="headerlink" title="2.6 云原生定义概括"></a>2.6 云原生定义概括</h2><p>云原生是指从云的原生应用角度出发，一整套设计、开发、部署、运行、维护的流程、技术栈以及背后文化理念的统称。<br><strong>云原生简单来说，摈弃传统的土方法，在架构设计、开发方式、部署维护等各个阶段和方面都基于云的特点，重新设计，从而建设全新的云化的应用，即云原生应用</strong>。</p>
<h1 id="3-CNCF"><a href="#3-CNCF" class="headerlink" title="3 CNCF"></a>3 CNCF</h1><p>1. </p>
<h2 id="3-1-云原生计算基金会CNCF"><a href="#3-1-云原生计算基金会CNCF" class="headerlink" title="3.1 云原生计算基金会CNCF"></a>3.1 云原生计算基金会CNCF</h2><p>提到云原生，就不能不介绍云原生计算基金会CNCF（Cloud Native Computing Foundation）。CNCF于2015 年7月<strong>由Google 牵头成立，隶属于 Linux 基金会，初衷是围绕云原生服务云计算，致力于培育和维护一个厂商中立的开源生态系统</strong>，维护和集成开源技术，支持编排容器化微服务架构应用，通过将最前沿的模式民主化，让这些创新为大众所用。<br>CNCF的使命包括以下三点：<br>• 容器化包装<br>• 通过中心编排系统的动态资源管理<br>• 面向微服务<br>全球主流的科技企业和云计算厂商绝大部分都是CNCF会员，其中不乏多家来自中国的科技巨头。<br><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/1627293314250-21eebf4a-5c45-4560-8e75-f7a2f17a0c79.jpeg"><br>图 二.2 CNCF黄金、白金会员</p>
<h2 id="3-2-CNCF云原生路线图（Trail-Map）"><a href="#3-2-CNCF云原生路线图（Trail-Map）" class="headerlink" title="3.2 CNCF云原生路线图（Trail Map）"></a>3.2 CNCF云原生路线图（Trail Map）</h2><p>对于企业在复杂的基础架构之上如何推动云原生应用的更好落地，从而更好地适应环境与业务的发展，CNCF给出了<strong>路线图（Trail Map）</strong>用于对用户在整体上给出指导建议，<strong>共分成十个步骤（容器化；CI&#x2F;CD；应用定义及编排；监控及分析；服务代理、发现和网格；网络、策略及安全；分布式数据库及存储；流与消息；镜像库与运行时；软件分发）</strong>进行实施，而在不同的步骤都可以结合CNCF全景图（Landscape）中列出的产品或服务进行选择。<br><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/1627293314859-633d3653-eca0-4841-979b-a935bc00f32f.png"></p>
<h2 id="3-3-CNCF云原生全景图（Trail-Map）"><a href="#3-3-CNCF云原生全景图（Trail-Map）" class="headerlink" title="3.3 CNCF云原生全景图（Trail Map）"></a>3.3 CNCF云原生全景图（Trail Map）</h2><p><a href="https://link.zhihu.com/?target=https://www.cncf.io/"><strong>CNCF全景图</strong></a><strong>则列举了和云原生相关的产品及服务的完整名单</strong>，这1381个项目共同构成了恢弘庞大的云原生世界。<strong>整个全景图按照功能分为29个模块，分别归属于9种大的类别（应用定义与开发、编排与管理、运行时、配置、平台、可观察性与分析、Serverless、会员和其它）</strong>。值得注意的是其中专门有一种分类是<a href="https://link.zhihu.com/?target=https://landscape.cncf.io/format=card-mode&grouping=headquarters&headquarters=china,hong-kong,taiwan">Cards from China</a>，列举了来自中国的145个项目，其中不乏许多大家耳熟能详的知名项目。<br>从CNCF的理念及野心来看，基于云原生的基础设施正在壮大和蚕食非云的市场，未来极有可能成为整个IT生态事实上的意见领袖和领导者。<br><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/1627293315531-db288421-d207-441f-a4cc-927b5594b786.png"></p>
<h1 id="4-相关技术及发展趋势"><a href="#4-相关技术及发展趋势" class="headerlink" title="4 相关技术及发展趋势"></a>4 相关技术及发展趋势</h1><p>1. </p>
<p>1. </p>
<h2 id="4-1-CNCF云原生全景图详解"><a href="#4-1-CNCF云原生全景图详解" class="headerlink" title="4.1  CNCF云原生全景图详解"></a>4.1  CNCF云原生全景图详解</h2><p>首先，我们剥离掉所有单个的技术，仅查看类别（如下图）。图中有不同的“行”，像建筑的不同层，每层都有自己的子类别。最底层提供了构建云原生基础设施的工具。往上，你可以开始添加运行和管理应用程序所需的工具，比如运行时和调度层。在最上层，有定义和开发应用程序的工具，比如数据库、镜像构建和 CI&#x2F;CD 工具（我们将在后文讨论）。<br>云原生全景图始于基础设施，往上的每一层都更接近实际的应用程序。这就是每层代表的意思（后面我们会讨论上图右边的两“列”）。下面我们就从最底层开始，逐层进行解析。<br><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/1627293315921-c62033a6-4333-4a16-b4e4-da1dc66a5d21.png"></p>
<h3 id="4-1-1-供应层-（Provisioning）"><a href="#4-1-1-供应层-（Provisioning）" class="headerlink" title="4.1.1 供应层 （Provisioning）"></a>4.1.1 <strong>供应层 （Provisioning）</strong></h3><p><strong>供应指的是为云原生应用准备标准基础环境所涉及的工具。</strong>它包含了基础设施的创建、管理、配置流程的自动化，以及容器镜像的扫描、签名和存储等。供应层通过提供设置和实施策略，在应用程序和平台中构建身份验证和授权，以及处理密钥分发等等的工具，也拓展到了安全领域。</p>
<ul>
<li>自动化和部署工具：帮助工程师在无需人工干预情况下即可构建计算环境；</li>
<li>容器注册表：存储应用程序的可执行文件；</li>
<li>不同安全领域的安全和合规框架；密钥管理解决方案：通过加密确保只有授权的用户才能访问特定的应用程序。</li>
<li>这些工具使工程师可以编写基础设施参数，使系统可以按需搭建新环境，确保了一致性和安全性。</li>
</ul>
<h3 id="4-1-2-运行时层（Runtime）"><a href="#4-1-2-运行时层（Runtime）" class="headerlink" title="4.1.2 运行时层（Runtime）"></a>4.1.2 <strong>运行时层（Runtime）</strong></h3><p>像很多 IT 术语一样，运行时没有严格的定义，且可以根据语境有不同的用法。狭义上讲，<strong>运行时是特定机器上准备运行应用程序的沙盒——也就是保障应用程序正常运行所需的最低配置</strong>。广义上讲，运行时是运行一个应用程序所需的所有工具。在 CNCF 云原生全景图中，运行时保障了容器化应用程序组件的运行和通信。</p>
<ul>
<li>云原生存储：为容器化应用提供虚拟磁盘或持久化存储；</li>
<li>容器运行时：为容器提供隔离、资源和安全；</li>
<li>云网络：分布式系统的节点（机器或进程）通过其连接和通信。</li>
</ul>
<h3 id="4-1-3-编排和管理层（Orchestration-and-Management）"><a href="#4-1-3-编排和管理层（Orchestration-and-Management）" class="headerlink" title="4.1.3 编排和管理层（Orchestration and Management）"></a>4.1.3 <strong>编排和管理层（Orchestration and Management）</strong></h3><p>一旦按照安全和合规性标准（供应层）自动化基础设施供应，并安装了应用程序运行所需的工具（运行时层），工程师就需要弄清楚如何编排和管理应用程序。<strong>编排和管理层将所有容器化服务（应用程序组件）作为一个群组管理</strong>。这些容器化服务需要相互识别和通信，并需要进行协调。这一层可为云原生应用提供自动化和弹性能力，使云原生应用天然具有可扩展性。</p>
<ul>
<li>编排和调度：部署和管理容器集群，确保它们具有<a target="_blank" rel="noopener" href="https://cloud.tencent.com/product/as?from=10680">弹性伸缩</a>能力，相互之间低耦合，并且可扩展。事实上，编排工具（绝大多数情况下就是 Kubernetes）通过管理容器和操作环境构成了集群；</li>
<li>协调和服务发现：使得服务（应用程序组件）之间可以相互定位和通信；</li>
<li>远程进程调用（RPC）：使跨节点服务间通信的技术；</li>
<li>服务代理：服务间通信的中介。服务代理的唯一目的就是对服务之间的通信进行更多控制，而不会对通信本身添加任何内容。服务代理对下面将提到的服务网格（Service Mesh）至关重要。</li>
<li>API 网关：一个抽象层，外部应用可通过 API 网关进行通信；</li>
<li>Service Mesh：某种程度上类似于 API 网关，它是应用程序进行通信的专用基础架构层，提供基于策略的内部服务间通信。此外，它还可能包含流量加密、服务发现、应用程序监控等内容。</li>
</ul>
<h3 id="4-1-4-应用定义和开发层-（Application-Definition-and-Developement"><a href="#4-1-4-应用定义和开发层-（Application-Definition-and-Developement" class="headerlink" title="4.1.4 应用定义和开发层 （Application Definition and Developement)"></a>4.1.4 <strong>应用定义和开发层 （Application Definition and Developement)</strong></h3><p>我们来到了<strong>最顶层</strong>。应用定义和开发层，顾名思义，聚集了让工程师构建和运行应用程序的工具。上述所有内容都是关于构建可靠、安全的环境，以及提供全部所需的应用程序依赖。</p>
<ul>
<li>数据库：使应用程序能以有序的方式收集数据；</li>
<li>流和消息传递：使应用程序能发送和接收消息（事件和流）。它不是网络层，而是让消息成为队列并处理消息的工具；</li>
<li>应用程序定义和镜像构建：用于配置、维护和运行容器镜像（应用程序的可执行文件）的服务；</li>
<li>持续集成和持续交付（CI&#x2F;CD）：使开发者可自动测试代码是否与代码库（应用程序的其余部分）兼容。如果团队足够成熟，甚至可以自动部署代码到生产环境。</li>
</ul>
<h3 id="4-1-5-贯穿所有层的工具"><a href="#4-1-5-贯穿所有层的工具" class="headerlink" title="4.1.5 贯穿所有层的工具"></a>4.1.5 贯穿所有层的工具</h3><p>接下来我们将进入到云原生全景图右侧贯穿所有层的两列。<strong>可观察性和分析（Observability&amp;analysis）</strong>是监控各层的工具，<strong>平台（Platforms）</strong>则将各层中不同的技术捆绑为一个解决方案。<br><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/1627293316220-2ac7bde6-6ebf-425e-ba5f-09dfc9ab5202.png"></p>
<h3 id="4-1-6-可观察性和分析（Observability-and-Analysis）"><a href="#4-1-6-可观察性和分析（Observability-and-Analysis）" class="headerlink" title="4.1.6 可观察性和分析（Observability and Analysis）"></a>4.1.6 <strong>可观察性和分析（Observability and Analysis）</strong></h3><p>为了限制服务中断并降低解决问题的平均时间（MRRT），你需要监控和分析应用层序的方方面面，以便在出现异常时可立即发现并纠正。复杂环境中容易出现故障，这些工具可快速识别并解决故障，从而降低故障带来的影响。由于这一类别<strong>贯穿并监控各层</strong>，因此它在侧面，而不是嵌入到某一层中。</p>
<ul>
<li>日志工具：收集事件日志（有关进程的信息）；</li>
<li>监控方案：收集指标（以数字表示的系统参数，例如 RAM 可用性）；</li>
<li>追踪工具：追踪比监控更进了一步，它们监控用户请求的传播，与服务网格相关。</li>
<li>混沌工程（Chaos Engineering）：在生产环境中测试软件的工具，可识别缺陷并进行修复，减少其对服务交付的影响。</li>
</ul>
<h3 id="4-1-7-平台类（Platform）"><a href="#4-1-7-平台类（Platform）" class="headerlink" title="4.1.7 平台类（Platform）"></a>4.1.7 <strong>平台类（Platform）</strong></h3><p>仅有存储并不能提供应用程序所需的全部功能。你还需要编排工具，容器运行时，服务发现，网络，API 网关等等。平台覆盖多层，将不同的工具组合在一起，以解决更大的问题。<br>配置和微调不同的模块使其安全可靠，并确保它利用的技术都能及时更新、所有漏洞都打了补丁，这并不是一件容易的事情。使用平台时，用户不用额外担心这些细节问题。<br>你可能会注意到，<strong>所有的类别都围绕着 Kubernetes 展开。这是因为 Kubernetes 虽然只是云原生景观图这张拼图中的一块，但它却是云原生技术栈的核心。</strong>顺便说一下，CNCF 刚创建时，Kubernetes 就是其中的第一个种子项目，后来才有了其他项目。</p>
<ul>
<li>Kubernetes 发行版：采用未经修改的开放源代码（尽管有人对其进行了修改），并根据市场需要增加了其他功能；</li>
<li>托管的 Kubernetes：类似于 Kubernetes 发行版，但是由提供商托管；</li>
<li>Kubernetes 安装程序：自动执行 Kubernetes 的安装和配置过程；</li>
<li>PaaS&#x2F;<a target="_blank" rel="noopener" href="https://cloud.tencent.com/product/tke?from=10680">容器服务</a>：类似于托管的 Kubernetes，但是包含了一套更广泛的应用部署工具（通常是来自云原生景观图）。</li>
</ul>
<h3 id="4-1-8-小结"><a href="#4-1-8-小结" class="headerlink" title="4.1.8 小结"></a>4.1.8 <strong>小结</strong></h3><p><strong>在每个类别中，针对相同或相似的问题，都有不同的工具可选择。有一些是适用于新现实的预云原生技术，还有一些则是全新的。区别在于它们的实现和设计方法。没有完美的技术符合你的所有需求。大多数情况下，技术受设计和架构选择的限制——始终需要权衡取舍。</strong><br>在选择技术栈时，工程师必须仔细考虑每种能力和需要权衡取舍的地方，以确定最合适的选项。虽然这样会让情况变得更复杂，但在选择应用程序所需的最适合的数据存储、基础设施管理、消息系统等方案时，这样做是最可行的办法。现在，构建一个系统比云原生之前的时代容易多了。如果构建恰当，云原生技术将提供更强大的灵活性。在现如今快速变化的技术生态中，这可能是最重要的能力之一。<br>详细介绍云原生全景图的每一层，见 <a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1851558">https://cloud.tencent.com/developer/article/1851558</a></p>
<h2 id="4-2-云原生核心概念"><a href="#4-2-云原生核心概念" class="headerlink" title="4.2 云原生核心概念"></a>4.2 云原生核心概念</h2><p>下面的表格里代表性的列举了云原生技术层的几个领域及相关项目。<br><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/1627293316551-62a4bbc5-2ea4-40ad-b61c-11dab4af559d.jpeg"></p>
<h3 id="4-2-1-DevOps与CI-CD"><a href="#4-2-1-DevOps与CI-CD" class="headerlink" title="4.2.1 DevOps与CI&#x2F;CD"></a>4.2.1 DevOps与CI&#x2F;CD</h3><p><strong>DevOps</strong><br>DevOps（Development &amp; Operations，开发和运维）是09年提出来的概念，但一直没有太火。直到14年，容器与微服务架构的提出，DevOps才得到了快速的发展。DevOps不单是一个实现自动化的工具链，而是组织、流程与技术的结合。组织上强调全栈团队、团队特性专一、团队自治；技术上打通开发与运维；流程上强调端到端、可视化、灰度升级、A&#x2F;B测试等。<br><strong>持续集成</strong><br>持续集成（CONTINUOUS INTEGRATION，CI）指的是开发人员频繁的（一天多次的）将所有开发者的工作合并到主干上。这些新提交在最终合并到主线之前，都需要通过编译和自动化测试流进行验证，以保障所有的提交在合并主干之后的质量问题，对可能出现的一些问题进行预警。持续集成的核心在于确保新增的代码能够与原先代码正确的集成。<br><strong>持续交付</strong><br>与持续集成相比，持续交付（CONTINUOUS DELIVERY，CD）的侧重点在于交付，其核心对象不在于代码，而在于可交付的产物。由于持续集成仅仅针对于新旧代码的集成过程执行了一定的测试，其变动到持续交付后还需要一些额外的流程。与持续集成相比较，持续交付添加了测试Test-&gt;模拟Staging-&gt;生产Production的流程，也就是为新增的代码添加了一个保证：确保新增的代码在生产环境中是可用的。<br><strong>持续部署</strong><br>持续部署（CONTINUOUS DEPLOYMENT）指的是通过自动化部署的手段将软件功能频繁的进行交付。与持续交付以及持续集成相比，持续部署强调了通过自动部署的手段，对新的软件功能进行集成。同持续交付相比持续集成的区别体现在对生产的自动化。从开发人员提交代码到编译、测试、部署的全流程不需要人工的干预，完全通过自动化的方式执行。这一策略加快了代码提交到功能上线的速度，保证新的功能能够第一时间部署到生产环境并被使用。</p>
<h3 id="4-2-2-微服务、API管理与集成"><a href="#4-2-2-微服务、API管理与集成" class="headerlink" title="4.2.2 微服务、API管理与集成"></a>4.2.2 微服务、API管理与集成</h3><p><strong>微服务</strong><br>微服务（Microservice）概念最早出现于2012年，2015年以后受到越来越多的关注，并且逐渐开始流行开来。其中著名技术大神Martin Fowler功不可没，他于2014年发表的一篇博客《Microservices: a definition of this new architectural term》（微服务：新技术架构的定义）清晰的定义和阐述了微服务概念。<br>微服务架构将单体应用，按照业务领域拆分为多个高内聚低耦合的小型服务，每个服务运行在独立进程，由不同的团队开发和维护，服务间采用轻量级通信机制，如HTTP RESTful API，独立自动部署，可以采用不同的语言及存储方式。微服务体现去中心化、天然分布式，是中台战略落地到IT系统的具体实现方式的技术架构，用来解决企业业务快速发展与创新时面临的系统弹性可扩展、敏捷迭代、技术驱动业务创新等难题。<br><strong>API管理与API集成</strong><br>微服务相关的两个具体领域，API管理与API集成。</p>
<ul>
<li>全生命周期API管理</li>
<li>API网关：微服务基础设施</li>
<li>Kong：API网关独角兽</li>
<li>RapidAPI：全球最大API市场</li>
<li>Mulesoft：API集成&#x2F;iPaaS&#x2F;API管理领头羊</li>
</ul>
<p><strong>微服务2.0：服务网格与Serverless</strong><br>微服务2.0的服务网格（Service Mesh）应运而生。服务网格这个词最早由著名开源服务网格项目Linkerd所在的Buoyant公司CEO William Morgan所提出。按照他的定义，服务网格是一个软件基础设施层，用于控制和监视微服务应用程序中的内部、服务到服务的流量。<br>Serverless是一种构建和管理基于微服务架构的完整流程，它与传统架构的不同之处在于，完全由第三方管理，由事件触发，存在于无状态、暂存的计算容器内。Serverless相关的重要概念包括FaaS（Functions as a Service，函数即服务）。开发者把函数上传到云厂商的FaaS平台，函数只在被请求时才实例化运行，然后被销毁，其它时候不占用任何服务器资源，完全实现按需使用，大幅度降低了服务器占用和成本。</p>
<h3 id="4-2-3-容器与Docker"><a href="#4-2-3-容器与Docker" class="headerlink" title="4.2.3 容器与Docker"></a>4.2.3 容器与Docker</h3><p><strong>虚拟化与容器</strong><br>虚拟机虽然可以隔离出很多“子电脑”，但占用空间大，启动慢，虚拟机软件可能还要花钱（例如VMware）。而容器技术恰好没有这些缺点，它不需要虚拟出整个操作系统，只需要虚拟一个小规模的环境（类似“沙箱”），启动时间很快，几秒钟就能完成。而且，它对资源的利用率很高（一台主机可以同时运行几千个Docker容器）。此外它占的空间很小，虚拟机一般要几GB到几十GB的空间，而容器只需要MB级甚至KB级。虚拟机和以Docker为代表的容器都是虚拟化技术，不过容器属于轻量级的虚拟化。<br><strong>Docker</strong><br>而Docker与传统的Linux容器也并不完全一致。Docker技术最初是建立在LXC技术之上的，大多数人都把LXC技术与传统的Linux容器联系在一起，尽管后来它已经摆脱了这种依赖性。LXC作为轻量级虚拟化很有用，但它没有很好的开发人员或用户体验。Docker技术带来的不仅仅是运行容器的能力，它还简化了创建和构建容器、加载镜像和镜像版本控制等过程。传统的Linux容器使用可以管理多个进程的init系统，这意味着整个应用可以作为一个整体运行。Docker鼓励将应用程序分解为它们各自的进程，并提供了实现这一点的工具，这种粒度有不少优点。</p>
<h3 id="4-2-4-Kubernetes与容器编排之战"><a href="#4-2-4-Kubernetes与容器编排之战" class="headerlink" title="4.2.4 Kubernetes与容器编排之战"></a>4.2.4 Kubernetes与容器编排之战</h3><p><strong>容器编排与Kubernetes</strong><br>在单机上运行容器，无法发挥它的最大效能，只有形成集群，才能最大程度发挥容器的良好隔离、资源分配与编排管理的优势。所以企业需要一套管理系统，对Docker及容器进行更高级更灵活的管理，按照用户的意愿和整个系统的规则，完全自动化的处理好容器之间的各种关系，这叫做编排（Orchestration）。<br>Kubernetes是基于Docker的开源容器集群管理系统，为容器化的应用提供资源调度、部署运行、服务发现、扩容缩容等整一套功能，因为容器本身可移植，所以Kubernetes容器集群能跑在私有云、公有云或者混合云上。</p>
<h2 id="4-3-发展趋势和未来展望"><a href="#4-3-发展趋势和未来展望" class="headerlink" title="4.3 发展趋势和未来展望"></a>4.3 发展趋势和未来展望</h2><h3 id="4-3-1-机遇和挑战"><a href="#4-3-1-机遇和挑战" class="headerlink" title="4.3.1 机遇和挑战"></a>4.3.1 机遇和挑战</h3><p><strong>机遇</strong><br>每一次IT产业架构的变革都会带来巨大的机遇和行业洗牌的挑战。过去的三四十年间，IT业经历了多次重大的变革，包括20世纪七八十年代从大型机向小型机的转移、九十年代C&#x2F;S架构的普及，以及21世纪初互联网的兴起，先后造就了IBM、思科、惠普、Oracle、EMC、SAP等巨头企业。<br>历次IT技术革命还有个共同特点：无论原有的基础软硬件公司此前有多么牢不可破的垄断地位，一旦不能符合新的IT技术变革的趋势，洗牌在所难免。<br>而云原生是一种理念和架构，用于以针对云环境优化的方式组装上述所有基于云的组件。因此云原生也是一个目的地：对于那些希望实现基础设施和流程现代化，甚至组织文化现代化的企业来说，最终的目标是仔细选择最适合其具体情况的云技术。<br><strong>发展趋势</strong><br><strong>从统计数据和发展趋势来看，云原生被接受的程度和普及速度正在大大加快</strong>，例如下图显示，自从2016年以来容器的使用量每年都在快速上升。IDC预计，到2022年90%的应用程序将采用微服务架构和第三方代码，35%的生产应用程序将诞生于云端。由于容器和敏捷方法的采用，预计2018-2023年间将诞生5亿个新应用程序。由数字化转型，以及接受和采用新技术的需求驱动，云原生将更深入地渗透到大型企业组织中。这意味着云原生技术和方法可能会遵循敏捷和DevOps的模式，越来越多地吸引更多的利益相关者，包括管理者和业务线领导人，在未来几年内覆盖一半或更多的组织。<br><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/1627293316953-800bd837-c741-4c82-9c91-214b63f33740.png"><br>    <strong>云原生安全领域</strong><br>据CNCF统计，采用容器技术的挑战中，开发团队面临的文化挑战、安全性、复杂性、就绪性和监控分别排在前五位。<br><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/1627293317288-dfbe013f-8814-470e-8181-ea9c4ba02ae8.jpeg"><br>在云原生架构中，安全问题显得尤其突出的原因有以下几点：<br>1、快速迁移到云原生架构对企业安全状况和运营产生了深远的影响。在容器、微服务和编排框架的世界中，以持久“状态”运行在“服务器”上的“应用程序”的概念已经过时。现在，该应用程序或服务是一个分布式系统，由多个组件组成，这些组件运行在数量可变的节点上，处于几乎恒定的变化状态。依赖于机器隔离和可预测的系统状态的传统安全控制是无效的。对服务到服务的通信视而不见的安全策略以及缺乏水平可扩展的控件，根本无法跟上当今微服务应用程序的步伐。<br>2、随着企业将工作负载从数据中心转移到AWS、Google Cloud Platform和Microsoft Azure，它们已经改变了购买安全性的方式。他们需要独立于平台的安全工具，这样就不会被绑定到特定的云平台中。<br>3、复杂系统可以创建大量的警报和事件日志，这会是一项惊人的任务。安全项目被堆积如山的繁忙工作所淹没，分析师们疲惫不堪。随着分析师对惊人的数据量变得不敏感，真正的问题就从他们的手指间溜走了。<br>4、DevOps是一种协作方法，它将开发人员和IT操作统一起来，以加快应用程序的构建、测试和部署，它也影响了IT安全。当开发人员可以直接将他们的应用程序部署到生产服务器上，因为业务敏捷性需要它时，他们就不能停下来找出安全问题。DevOps提供了一种完全不同的安全方式，安全自动化有很多机会。<br><strong>和云原生安全相关的初创企业</strong><br><strong>1、Capsule8（B轮）</strong><br><strong>2、Aqua Security（C轮）</strong><br><strong>3、Twistlock（被收购）</strong></p>
<h3 id="4-3-2-云原生2-0（华为）"><a href="#4-3-2-云原生2-0（华为）" class="headerlink" title="4.3.2 云原生2.0（华为）"></a>4.3.2 云原生2.0（华为）</h3><p><strong>随着云原生技术的成熟和市场需求的升级，云计算的发展已步入新的阶段。云原生2.0时代已经到来</strong><br>从技术角度看，以容器、微服务以及动态编排为代表的云原生技术蓬勃发展，成为赋能业务创新的重要推动力，并已经应用到企业核心业务。从市场角度看，云原生技术已在金融、制造、互联网等多个行业得到广泛验证，支持的业务场景也愈加丰富，行业生态日渐繁荣。<br><strong>云原生2.0，企业云化从“ON Cloud”走向“IN Cloud“，生于云、长于云且立而不破</strong><br>企业新生能力基于云原生构建，使其生于云；应用、数据和AI的全生命周期云上完成，使其长于云；同时，既有能力通过立而不破的方式继承下来，并与新生能力有机协同。<br><strong>智能升级新阶段，赋能“新云原生企业”</strong><br>云原生2.0是企业智能升级的新阶段，企业云化从“ON Cloud”走向“IN Cloud“，成为”新云原生企业“。新生能力与既有能力立而不破、有机协同，实现资源高效、应用敏捷、业务智能，安全可信。<br><strong>云原生 IN 基础设施</strong><br>华为云基于“云原生 IN 基础设施”的理念，打造了以应用为中心的云原生基础设施。<br>目前，华为云云原生基础设施包含了云容器引擎CCE、云容器实例CCI、容器镜像服务SWR、智能边缘平台IEF、多云容器平台MCP、应用编排服务AOS等8大核心容器产品，并以此为基础构建了云原生裸金属、云原生高性能计算、云原生混合云、云原生边缘计算四大解决方案，满足企业业务智能升级过程中，对高性能基础设施、分布式业务架构、完善的云原生应用生态的诉求。<br><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/1627293317693-db100538-f8a6-4676-9b8f-68eaf25b8f20.png"></p>
<h3 id="4-3-3-未来发展趋势"><a href="#4-3-3-未来发展趋势" class="headerlink" title="4.3.3 未来发展趋势"></a>4.3.3 未来发展趋势</h3><p><strong>1、运维继续下沉，服务网格将成为主流，Serverless逐步推广</strong><br>云计算的一个发展方向就是运维下沉，将和业务无关的管理功能和运维工作尽量下沉到基础设施中，应用可以聚焦在业务能力的开发和运营。这个趋势演化的过程，影响了云计算的发展方向。从一开始的虚拟化，到IaaS，到PaaS都是将应用系统的部分运维职责交给平台运维的过程。<br><strong>2、软硬结合，解决虚拟化性能问题的利器</strong><br>随着云计算的发展，虚拟化技术越来越多的被使用，从计算虚拟化到存储虚拟化到网络虚拟化。虚拟化技术带来了很多的好处，虚拟化是基础设施服务化的基础，通过虚拟化，可以实现基础设施即代码，大大提升了资源的可管理性和自动化程度。但是虚拟化带来了另外一个问题，就是性能的损耗和软件进程之间的相互影响问题。<br>为了解决这两个问题，目前一个解决思路就是软硬结合，讲云平台的管理进程，如调度管理，网络的虚拟交换机，存储的虚拟存储网关从操作系统进程中剥离出来，让这些进程跑在专门设计的服务器板卡上，这些板卡专门设计的，通常含有定制化的芯片（FPGA），可以进行编程，从而可以保持虚拟化话的优势的同时，使的管理进程和业务进程隔离，避免相互影响；同时由于通过定制芯片（如FPGA）来处理，性能会有很大提升，大大降低了虚拟化的损耗。<br><strong>3、容器虚拟机进一步融合</strong><br>容器和虚拟机的优势和劣势，从容器技术诞生的那天起就一直在争论。容器轻量化，良好的封装能力和部署简便的特点，特别是在Kubernetes出现后，大有取代虚拟机的气势。但是在处理重应用（如关系型数据库，大数据等）的这点上，容器技术显得有些力不从心。在这种情况下，如何实现容器技术和虚拟化技术的融合，发挥两者的长处，成为云计算的一个发展课题。目前的技术主要有三种，一种是容器虚拟机的混布；一种是轻量级虚拟机；最后是安全容器。<br><strong>4、运维：可编程的Linux内核</strong><br>由于引入了可扩展的Berkeley数据包过滤器（Extended Berkeley Packet Filter，eBPF），Linux内核在<a target="_blank" rel="noopener" href="https://thenewstack.io/how-ebpf-turns-linux-into-a-programmable-kernel/">使用方式上有了重大变化</a>。<br><strong>5、开发：Rust逐渐替代C++</strong><br>数十年来，我们的操作系统和其他重要的基础架构软件一直使用C或C ++编写，但是，如今，越来越多的系统架构师得出的结论是，由于用不安全的方式来处理内存和其他因素，要完全安全地保护用这些语言编写的程序从根本上来说是困难的。<br>所以最近，越来越多的拥护者选择了新的语言<a target="_blank" rel="noopener" href="https://www.rust-lang.org/">Rust</a>，它不仅具有C&#x2F;C ++的速度，而且还具有编写安全的应用程序所必需的组件。在2020年的AllThingsOpen虚拟会议上，<a target="_blank" rel="noopener" href="https://www.microsoft.com/">微软</a>云开发倡导者Ryan Levick <a target="_blank" rel="noopener" href="https://youtu.be/NQBVUjdkLAA">解释了</a>为什么Microsoft逐渐改用Rust来构建其基础结构软件，而不再使用C&#x2F;C ++。并鼓励其他软件行业巨头也考虑相同的问题。</p>
<h1 id="5-参考链接"><a href="#5-参考链接" class="headerlink" title="5 参考链接"></a>5 参考链接</h1><ol>
<li><a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/722745">https://developer.aliyun.com/article/722745</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/150190166">https://zhuanlan.zhihu.com/p/150190166</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/390567373">https://zhuanlan.zhihu.com/p/390567373</a></li>
<li><a target="_blank" rel="noopener" href="https://support.huaweicloud.com/productdesc-cce/cce_productdesc_0009.html">https://support.huaweicloud.com/productdesc-cce/cce_productdesc_0009.html</a></li>
<li><a target="_blank" rel="noopener" href="https://landscape.cncf.io/">https://landscape.cncf.io/</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/722745">https://developer.aliyun.com/article/722745</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/149658062">https://zhuanlan.zhihu.com/p/149658062</a></li>
<li><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1851558">https://cloud.tencent.com/developer/article/1851558</a></li>
<li></li>
</ol>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/08/07/%E6%95%B0%E6%8D%AE%E5%BA%93/NewSQL%E4%B8%BB%E6%B5%81%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E6%AF%94-GIS%E7%AF%87/">NewSQL主流数据库对比——GIS篇</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-08-08</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/GIS/">GIS</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/NewSQL/">NewSQL</a></span><div class="content"><h1 id="NewSQL主流数据库对比——GIS篇"><a href="#NewSQL主流数据库对比——GIS篇" class="headerlink" title="NewSQL主流数据库对比——GIS篇"></a>NewSQL主流数据库对比——GIS篇</h1><p>[TOC]</p>
<h2 id="NewSQL-简介"><a href="#NewSQL-简介" class="headerlink" title="NewSQL 简介"></a>NewSQL 简介</h2><p>NewSQL 是一种新方式关系数据库，意在整合 RDBMS 所提供的ACID事务特性，以及 NoSQL 提供的横向可扩展性。</p>
<p>大多数 NewSQL 数据库做了全新的设计，或是主要聚焦于 OLTP，或是采用了 OLTP&#x2F;OLAP 的混合架构载的全新设计。</p>
<ul>
<li>一致性：相对于可用性而言，NewSQL 更重视一致性，即侧重 CAP 中的 C 和 P。</li>
<li>内存数据库：一些 NewSQL 解决方案使用内存（RAM）作为存储介质。</li>
<li>HTAP：HTAP（混合事务 &#x2F; 分析处理，Hybrid Transactional&#x2F;Analytical Processing）</li>
</ul>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/1166059074.png" alt="1166059074"></p>
<h2 id="！！！对比分析"><a href="#！！！对比分析" class="headerlink" title="！！！对比分析"></a>！！！对比分析</h2><table>
<thead>
<tr>
<th>NewSQL</th>
<th>开发商</th>
<th>是否开源</th>
<th>特性</th>
<th>分布式</th>
<th>空间支持</th>
<th>社区活跃度</th>
<th>拓展</th>
</tr>
</thead>
<tbody><tr>
<td>Spanner</td>
<td>谷歌</td>
<td>×</td>
<td>存储的数据是Key-value</td>
<td>水平扩展</td>
<td>×</td>
<td>Google社区</td>
<td></td>
</tr>
<tr>
<td>OceanBase</td>
<td>阿里</td>
<td>开源</td>
<td>MySQL&#x2F;ORACLE兼容、增量数据放在内存、基线数据放在SSD盘、读写分</td>
<td>线性扩展</td>
<td>×</td>
<td>阿里社区、博客</td>
<td></td>
</tr>
<tr>
<td>TDSQL</td>
<td>腾讯</td>
<td>×</td>
<td>提供两种版本MySQL和PostgreSQL</td>
<td>水平扩展</td>
<td>PostGIS</td>
<td>腾讯社区</td>
<td></td>
</tr>
<tr>
<td>Azure Cosmos DB</td>
<td>微软</td>
<td>商业（2RMB&#x2F;月）</td>
<td>支持键值、列存储、文档和图数据库，并支持通过 SQL 和 NoSQL API 提供数据。</td>
<td>水平扩展</td>
<td>支持</td>
<td>微软社区</td>
<td></td>
</tr>
<tr>
<td>TiDB</td>
<td>PingCAP</td>
<td>开源</td>
<td>兼容 MySQL、TiDB、TiKV计算层与存储层的分离解耦架构</td>
<td>水平扩展</td>
<td>×</td>
<td>社区、博客</td>
<td>TiSpark</td>
</tr>
<tr>
<td>SequoiaDB巨杉数据库</td>
<td>巨杉数据库</td>
<td>开源</td>
<td>国产、金融级分布式关系型数据库</td>
<td>集群</td>
<td>×</td>
<td>社区、博客</td>
<td></td>
</tr>
<tr>
<td>CockroachDB蟑螂数据库</td>
<td>蟑螂实验室</td>
<td>商业来源许可证（BSL）</td>
<td>支持PostgreSQL、去中心化架构、支持kuberneter编排</td>
<td>水平扩展</td>
<td>部分兼容PostGIS</td>
<td>Cockroach Labs 博客</td>
<td></td>
</tr>
<tr>
<td>Citus</td>
<td>微软并购</td>
<td>GPL v3</td>
<td>开源 PostgreSQL <strong>扩展</strong>、并行处理、微软云、简单易用</td>
<td>支持分布式 PostgreSQL</td>
<td>PostGIS</td>
<td>论坛、博客</td>
<td></td>
</tr>
<tr>
<td>ClustrixDB</td>
<td>MariaDB 2018年收购</td>
<td>收费</td>
<td>类MYSQL</td>
<td>分布式</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>MemSQL&#x2F;SingleStore</td>
<td>前 Facebook 工程师创办</td>
<td>开源的社区版</td>
<td><strong>内存数据库</strong>、兼容MySQL、MySQL InnoDB</td>
<td>分布式</td>
<td>地理空间和全文搜索</td>
<td><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/image-20210704154249267.png" alt="image-20210704154249267">社区论坛</td>
<td></td>
</tr>
<tr>
<td>VoltDB</td>
<td>Postgres和Ingres联合</td>
<td>GPLv3、AGPL</td>
<td><strong>内存数据库</strong>、采用类MPP架构、并行的单线程处理方式确保数据一致性</td>
<td>水平扩展</td>
<td>仅支持简单空间查询</td>
<td>博客</td>
<td></td>
</tr>
<tr>
<td>Vitess</td>
<td>CNCF</td>
<td>开源</td>
<td>部署，扩展和管理MySQL实例、支持kuberneter编排</td>
<td>无限水平扩展</td>
<td>MySQL Spatial</td>
<td>博客、社区</td>
<td></td>
</tr>
<tr>
<td>NuoDB</td>
<td>NuoDB</td>
<td>×</td>
<td>去集中化、唯一一个具有专利的、弹性可伸缩的SQL关系数据库</td>
<td></td>
<td></td>
<td>文档都是视频</td>
<td></td>
</tr>
<tr>
<td>Altibase</td>
<td></td>
<td></td>
<td>Hybrid DBMS</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>YugabyteDB</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>GenieDB</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ScaleDB</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="Azure-Cosmos-DB"><a href="#Azure-Cosmos-DB" class="headerlink" title="Azure Cosmos DB"></a><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/azure/cosmos-db/use-cases">Azure Cosmos DB</a></h3><blockquote>
<p>Azure Cosmos DB 是一种用于现代应用开发的完全托管式 NoSQL 数据库服务。 获得有保证的个位数毫秒级响应时间和 由 SLA 支持的 99.999% 可用性、 自动、即时的可伸缩性 ，以及用于 MongoDB 和 Cassandra 的开放源代码 API。</p>
<p>使用 Azure Synapse Link for Azure Cosmos DB 通过非 ETL 分析从实时数据中获取见解。</p>
</blockquote>
<h4 id="NoSQL-数据库与关系数据库之间的差别"><a href="#NoSQL-数据库与关系数据库之间的差别" class="headerlink" title="NoSQL 数据库与关系数据库之间的差别"></a>NoSQL 数据库与关系数据库之间的差别</h4><ul>
<li>SQL API</li>
<li>Cassandra API<ul>
<li>Azure Cosmos DB Cassandra API 可以充当为 Apache Cassandra 编写的应用的<strong>列族数据存储</strong>。</li>
<li>通过 Cassandra API 可以使用 Cassandra 查询语言 (CQL)、基于 Cassandra 的工具（如 cqlsh）和熟悉的 Cassandra 客户端驱动程序与 Azure Cosmos DB 中存储的数据进行交互。</li>
</ul>
</li>
<li>Gremlin API<ul>
<li>Azure Cosmos DB 通过 Gremlin API 在为任何规模设计的完全托管数据库服务中提供<strong>图形数据库</strong>服务。</li>
<li>使用 Gremlin 查询语言。</li>
</ul>
</li>
<li>表 API<ul>
<li>类似于CloudTable。</li>
<li>Azure Table Storage  提供的表 API 适用于为 Azure <strong>表存储</strong>。</li>
<li>表 API 包含可用于 .NET、Java、Python 和 Node.js 的客户端 SDK。</li>
</ul>
</li>
<li>Azure Cosmos DB API for MongoDB<ul>
<li>通过用于 MongoDB 的 Azure Cosmos DB API，可以轻松使用 Cosmos DB，就像它是 MongoDB <strong>文档数据库</strong>一样。</li>
</ul>
</li>
</ul>
<h4 id="Azure-Cosmos-DB-中的地理空间和-GeoJSON-位置数据"><a href="#Azure-Cosmos-DB-中的地理空间和-GeoJSON-位置数据" class="headerlink" title="Azure Cosmos DB 中的地理空间和 GeoJSON 位置数据"></a>Azure Cosmos DB 中的地理空间和 GeoJSON 位置数据</h4><ul>
<li><p>支持两种空间数据类型：geometry 数据类型和 geography 数据类型 。</p>
<ul>
<li>geometry 类型在欧几里得（平面）坐标系统中表示数据</li>
<li><strong>Geography</strong> 类型表示圆形地球坐标系中的数据。</li>
</ul>
</li>
<li><p>支持的空间数据类型</p>
<ul>
<li>Point</li>
<li>LineString</li>
<li>Polygon</li>
<li>MultiPolygon</li>
</ul>
</li>
<li><p>地理空间数据查询</p>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/image-20210704152452747.png" alt="image-20210704152452747"></p>
</li>
<li><p>地理空间数据编制索引</p>
<ul>
<li>简单来说，测地坐标的几何图形会投影在 2D 平面上，并使用 <strong>四叉树</strong> 以渐进方式划分成单元格。 这些单元格会根据 <strong>Hilbert 空间填充曲线</strong> 内的单元格位置映射到 1D，并保留点的位置。</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/azure/cosmos-db/sql-query-geospatial-intro">https://docs.microsoft.com/zh-cn/azure/cosmos-db/sql-query-geospatial-intro</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/azure/cosmos-db/sql-query-geospatial-query">https://docs.microsoft.com/zh-cn/azure/cosmos-db/sql-query-geospatial-query</a></p>
</li>
</ul>
<h3 id="Altibase（商用收费）"><a href="#Altibase（商用收费）" class="headerlink" title="Altibase（商用收费）"></a><a target="_blank" rel="noopener" href="http://cn.altibase.com/">Altibase（商用收费）</a></h3><h3 id="CockroachDB"><a href="#CockroachDB" class="headerlink" title="CockroachDB"></a><a target="_blank" rel="noopener" href="https://www.cockroachlabs.com/">CockroachDB</a></h3><blockquote>
<p>CockroachDB（<a target="_blank" rel="noopener" href="https://www.cockroachlabs.com)是google备受瞩目的spanner的开源模仿,承诺提供一种高存活性、强一致性,可横向扩展的sql数据库.主要的设计目标是全球一致性和可靠性,从蟑螂(cockroach)的命名上是就能看出这点/">https://www.cockroachlabs.com）是Google备受瞩目的Spanner的开源模仿，承诺提供一种高存活性、强一致性，可横向扩展的SQL数据库。主要的设计目标是全球一致性和可靠性，从蟑螂（cockroach）的命名上是就能看出这点</a> [ 打不死的小强：) ]。Cockroach节点是均衡的，其设计目标是同质部署（只有一个二进制包）且最小配置。CockroachDB的扩展非常容易，只要一行命令，秒级进行。</p>
</blockquote>
<ul>
<li>PostgreSQL生态中的很多工具、程序和应用能够适用于CockroachDB(不用修改或少量修改)。</li>
<li>虽然CockroachDB支持PostgreSQL语法和驱动程序，但它不是完全兼容PostgreSQL。</li>
<li>2020年的20.2版本开始支持<a target="_blank" rel="noopener" href="https://www.cockroachlabs.com/blog/spatial-data/">geospatial</a>，但未完全兼容PostGIS。</li>
<li>采用分层架构，最顶层是SQL层。SQL层构建于分布式KV存储之上</li>
</ul>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/20190413215412940.png" alt="img"></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_34924156/article/details/89236693">https://blog.csdn.net/qq_34924156/article/details/89236693</a></p>
<ul>
<li>用户手册：<a target="_blank" rel="noopener" href="http://doc.cockroachchina.baidu.com/">http://doc.cockroachchina.baidu.com/</a></li>
<li>社区：<a target="_blank" rel="noopener" href="https://www.cockroachlabs.com/blog/">https://www.cockroachlabs.com/blog/</a></li>
</ul>
<h3 id="Citus"><a href="#Citus" class="headerlink" title="Citus"></a><a target="_blank" rel="noopener" href="http://citusdb.cn/">Citus</a></h3><blockquote>
<p>CitusDB采用PostgreSQL的插件形式(not a fork)，即享受PostgreSQL的强大支持，又同时拥有分布式数据库能力</p>
<p>CitusDB 与 HDFS 的分布式非常相似，在 Master 上存储元数据，Work 节点存储分片，同时 1 个分片至少要存储在 2 个 Work 节点（可配置更多）上保障其可用性。</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/image-20210703221436470.png" alt="image-20210703221436470"></p>
<ul>
<li>苏宁citus分布式数据库应用实践</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://itdks.su.bcebos.com/844d50a9b73f4d8283d746cbff23b5e9.pdf">https://itdks.su.bcebos.com/844d50a9b73f4d8283d746cbff23b5e9.pdf</a></p>
<ul>
<li>利用 citus 支持地理大数据。全世界的点状POI，数据量级已达亿级别，存储在单一的PostgreSQL数据表中，若查询涉及到全表扫描，性能会差很多</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.giserdqy.com/secdev/openlayers/21870/">https://www.giserdqy.com/secdev/openlayers/21870/</a></p>
<ul>
<li><code>Citus</code>是一个PostgreSQL的扩展，类似于PostGIS、pgRouting，它主要的作用是将一张大表进行水平分表，每个分表称为“分片（Shard）”，按照一定的规则分布(?)到多台机器上，并且将查询分布到不同节点并行执行，最后汇总结果。</li>
</ul>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/TUIK%7ES14Z%606A_I%60E%7BFPYT6L.png" alt="img"></p>
<ul>
<li>论坛：<a target="_blank" rel="noopener" href="http://citusdb.cn/?post_type=forum">http://citusdb.cn/?post_type=forum</a></li>
<li>博客：<a target="_blank" rel="noopener" href="http://citusdb.cn/?cat=13">http://citusdb.cn/?cat=13</a></li>
<li>手册：<a target="_blank" rel="noopener" href="http://docs.citusdata.com/en/v10.0/">http://docs.citusdata.com/en/v10.0/</a></li>
</ul>
<h3 id="ClustrixDB-收费"><a href="#ClustrixDB-收费" class="headerlink" title="ClustrixDB(收费)"></a><a target="_blank" rel="noopener" href="https://mariadb.com/products/clustrixdb/">ClustrixDB(收费)</a></h3><h3 id="MemSQL"><a href="#MemSQL" class="headerlink" title="MemSQL"></a><a target="_blank" rel="noopener" href="https://www.memsql.com/software/">MemSQL</a></h3><blockquote>
<p>由前 Facebook 工程师创办的 MemSQL，号称世界上最快的分布式关系型数据库，兼容 MySQL 但快30倍，能实现每秒 150 万次事务。原理是仅用内存并将 SQL 预编译为C++。</p>
</blockquote>
<ul>
<li>MemSQL is Now SingleStore</li>
<li>2018年，MemSQL 搞了个炸裂消息，<a href="https://link.zhihu.com/?target=https://www.memsql.com/blog/memsql67/">宣布</a> MemSQL 6.7 可以免费用于生产环境，没有功能限制，磁盘容量无限制，只限制整个 MemSQL 集群总内存使用不得超过 128 GB，如果做双机备份，那么就是每台机器 64 GB，已经很够用了。</li>
<li>使用ACID事务每秒接收数百万个事件，同时以关系SQL、JSON、地理空间和全文搜索格式分析数十亿行数据。</li>
</ul>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/image-20210704150733553.png" alt="image-20210704150733553"></p>
<ul>
<li><p>地理空间支持</p>
<ul>
<li><p>SingleStore使用了一个类似于googleearth的球形模型。它假设一个半径为6367444.66米的完美球形地球。</p>
</li>
<li><p>地理数据类型</p>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/image-20210704151619023.png" alt="image-20210704151619023"></p>
</li>
<li><p>空间查询</p>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/image-20210704151741992.png" alt="image-20210704151741992"></p>
</li>
<li><p>GEOJSON。SingleStore 没有本机 GeoJSON 支持。但是，我们有通用的 JSON 支持以及计算列。结合这些功能，您可以使用 SingleStore 的内置 JSON 类型和 GEOGRAPHYPOINT 类型导入 GeoJSON 数据的子集。</p>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/image-20210704151949000.png" alt="image-20210704151949000"></p>
</li>
</ul>
</li>
<li><p>社区网址：<a target="_blank" rel="noopener" href="https://www.singlestore.com/community-hub/">https://www.singlestore.com/community-hub/</a></p>
</li>
<li><p>资源手册：<a target="_blank" rel="noopener" href="https://www.singlestore.com/resources/">https://www.singlestore.com/resources/</a></p>
</li>
</ul>
<h3 id="NuoDB"><a href="#NuoDB" class="headerlink" title="NuoDB"></a><a target="_blank" rel="noopener" href="https://nuodb.com/">NuoDB</a></h3><blockquote>
<p>NuoDB 是newsql数据库的典型代表之一，同时也是世界上首个也是唯一一个具有专利的、弹性可伸缩的SQL关系数据库，主要用于去集中化的计算资源。</p>
</blockquote>
<h3 id="OceanBase"><a href="#OceanBase" class="headerlink" title="OceanBase"></a><a target="_blank" rel="noopener" href="https://open.oceanbase.com/">OceanBase</a></h3><blockquote>
<p>OceanBase 社区版是一款开源分布式 HTAP（Hybrid Transactional&#x2F;Analytical Processing）数据库管理系统，具有原生分布式架构，支持金融级高可用、透明水平扩展、分布式事务、多租户和语法兼容等企业级特性。</p>
</blockquote>
<blockquote>
<p>2020 年 5 月，OceanBase 以 7.07亿 tpmC 的在线事务处理性能，打破了 OceanBase 自己在 2019 年创造的 6088万 tpmC 的 TPC-C 世界纪录。截止至目前，OceanBase是第一个也是唯一一个上榜的中国数据库。</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/image-20210704164251964.png" alt="image-20210704164251964"></p>
<ul>
<li><p>版本选择</p>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/image-20210704164312198.png" alt="image-20210704164312198"></p>
</li>
<li><p>产品优势</p>
<ul>
<li><strong>高性能</strong>：OceanBase采用了读写分离的架构，把数据分为基线数据和增量数据。其中增量数据放在内存里（MemTable），基线数据放在SSD盘（SSTable）。对数据的修改都是增量数据，只写内存。所以DML是完全的内存操作，性能非常高。</li>
<li><strong>低成本</strong>：OceanBase通过数据编码压缩技术实现高压缩。数据编码是基于数据库关系表中不同字段的值域和类型信息，所产生的一系列的编码方式，它比通用的压缩算法更懂数据，从而能够实现更高的压缩效率。</li>
<li><strong>高兼容</strong>：兼容常用MySQL&#x2F;ORACLE功能及MySQL&#x2F;ORACLE前后台协议，业务零修改或少量修改即可从MySQL&#x2F;ORACLE迁移至OceanBase。</li>
<li><strong>高可用</strong>：数据采用多副本存储，少数副本故障不影响数据可用性。通过“三地五中心”部署实现城市级故障自动无损容灾。</li>
</ul>
</li>
<li><p>定价</p>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/image-20210704164141515.png" alt="image-20210704164141515"></p>
</li>
<li><p>社区：<a target="_blank" rel="noopener" href="https://open.oceanbase.com/community/contribution">https://open.oceanbase.com/community/contribution</a></p>
</li>
<li><p>博客：<a target="_blank" rel="noopener" href="https://open.oceanbase.com/articles">https://open.oceanbase.com/articles</a></p>
</li>
<li><p>文档：<a target="_blank" rel="noopener" href="https://open.oceanbase.com/docs">https://open.oceanbase.com/docs</a></p>
</li>
</ul>
<h3 id="SequoiaDB"><a href="#SequoiaDB" class="headerlink" title="SequoiaDB"></a>SequoiaDB</h3><h3 id="TDSQL"><a href="#TDSQL" class="headerlink" title="TDSQL"></a><a target="_blank" rel="noopener" href="https://intl.cloud.tencent.com/zh/product/dcdb">TDSQL</a></h3><blockquote>
<p>分布式数据库（Tencent Distributed SQL，以下简称 TDSQL）是腾讯打造的一款企业级数据库产品，具备强一致高可用、全球部署架构、高 SQL 兼容度、分布式水平扩展、高性能、完整的分布式事务支持、企业级安全等特性，同时提供智能 DBA、自动化运营、监控告警等配套设施，为客户提供完整的分布式数据库解决方案。</p>
<p>稳定、安全、高性能的分布式数据库，兼容 PostgreSQL 和 MySQL。</p>
</blockquote>
<ol>
<li><p>MySQL 版</p>
<p>高度兼容 MySQL，支持水平拆分（分表）的高性能数据库。部署在腾讯云上的一种支持自动水平拆分、Shared Nothing 架构的分布式数据库。TDSQL MySQL版 默认部署主备架构，提供容灾、备份、恢复、监控、迁移等全套解决方案，适用于 TB 或 PB 级的海量数据库场景。</p>
</li>
<li><p>PostgreSQL 版 （原 TBase）</p>
<p>稳定、安全、高性能的分布式数据库服务，满足您海量 HTAP 场景。集高扩展性、高SQL兼容度、完整的分布式事务支持、多级容灾能力以及多维度资源隔离等能力于一身。TDSQL PostgreSQL 版采用无共享的集群架构，为用户提供容灾、备份、恢复、监控、安全、审计等全套解决方案，适用于GB～PB级的海量 HTAP 场景。  </p>
<p> 具有丰富的周边生态：</p>
<ul>
<li>支持强大的地理信息系统（GIS）。通过集群化的 PostGis 插件，支持存储空间地理数据，使 TDSQL PostgreSQL版 成为一个空间数据库，能够通过 SQL 语言高效的进行空间数据管理、数量测量和几何拓扑分析。</li>
<li>TDSQL PostgreSQL版 不仅是一个分布式关系型数据库系统，同时还支持非关系数据类型 JSON。</li>
<li>支持 Foreign Data Wrappers（FDW）功能，该功能实现了部分的 SQL&#x2F;MED 规定，允许用户使用普通 SQL 查询来访问位于 PostgreSQL 之外的数据。<br>FDW 功能提供一套编程接口，用户可进行插件式的二次开发，建立外部数据源和数据库间的数据通道。大多数情况下用户可用 oracle_fdw、mysql_fdw、postgres_fdw，非关系型数据库的 redis_fdw、mongodb_fdw，以及大数据的 hive_fdw、hdfs_fdw 等。基于 FDW 功能和已有插件，TDSQL PostgreSQL版 提供强大的数据库联邦能力，通过 TDSQL PostgreSQL版 能够访问已有的多个数据源的数据。</li>
</ul>
</li>
</ol>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/image-20210704180213145.png" alt="image-20210704180213145"></p>
<ul>
<li><p>价格</p>
<p>​	<img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/image-20210704180327148.png" alt="image-20210704180327148"></p>
</li>
</ul>
<h3 id="TiDB"><a href="#TiDB" class="headerlink" title="TiDB "></a><a target="_blank" rel="noopener" href="https://pingcap.com/">TiDB </a></h3><h3 id="VoltDB"><a href="#VoltDB" class="headerlink" title="VoltDB"></a><a target="_blank" rel="noopener" href="https://www.voltdb.com/">VoltDB</a></h3><h3 id="Vitess"><a href="#Vitess" class="headerlink" title="Vitess"></a><a target="_blank" rel="noopener" href="https://vitess.io/zh/">Vitess</a></h3><p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/image-20210703213038339.png" alt="image-20210703213038339"></p>
<ul>
<li><p>Vitess包括使用与本机查询协议兼容的JDBC和Go数据库驱动。自2011年以来，Vitess一直为YouTube所有的数据库提供服务，现在已被许多企业采用并应用于实际生产。</p>
</li>
<li><p>Vitess是一个用于部署、扩展和管理大型MySQL实例集群的数据库解决方案。Vitess集Mysql数据库的很多重要特性和NoSQL数据库的可扩展性于一体。它的架构设计使得您可以像在物理机上一样在公共云或私有云架构中有效运行。它结合并扩展了许多重要的MySQL功能，同时兼具NoSQL数据库的可扩展性。</p>
</li>
<li><p>一种云原生技术 Cloud-native</p>
<ul>
<li>容器化（Containerized）：每个部分（应用程序，进程等）都封装在自己的容器中。这有助于重复性，透明度和资源隔离。</li>
<li>动态编排（Dynamically orchestrated）：动态的调度和管理容器以优化资源利用。</li>
<li>面向微服务（Microservices oriented）：应用程序基于微服务架构，显著提高架构演进的灵活性和可维护性。</li>
</ul>
</li>
</ul>
<p><strong>CNCF案例研究：京东如何使用Vitess管理超大规模数据库</strong></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1548244">https://cloud.tencent.com/developer/article/1548244</a></p>
<h1 id="NewSQL，NoSQL与OldSQL的混合部署"><a href="#NewSQL，NoSQL与OldSQL的混合部署" class="headerlink" title="NewSQL，NoSQL与OldSQL的混合部署"></a>NewSQL，NoSQL与OldSQL的混合部署</h1><ul>
<li>OldSQL+NewSQL</li>
<li>OldSQL+NoSQL</li>
<li>NewSQL+NoSQL</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://supmarket.net/xy/771126462">https://supmarket.net/xy/771126462</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/07/03/%E8%B0%83%E7%A0%94/PostGIS%E8%B0%83%E7%A0%94/">postgis 相关调研</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-07-04</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%B0%83%E7%A0%94/">调研</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E5%9C%B0%E5%9B%BE%E6%9C%8D%E5%8A%A1/">地图服务</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/OGC/">OGC</a></span><div class="content"><h1 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h1><h2 id="相关标准化组织机构介绍"><a href="#相关标准化组织机构介绍" class="headerlink" title="相关标准化组织机构介绍"></a>相关标准化组织机构介绍</h2><ul>
<li><p>OGC 表示开放地理空间信息联盟 （Open Geospatial Consortium-OGC） ，致力于提供地理信息行业软件和数据及服务的标准化工作。OGC在1994年到2004年期间机构名为Open GIS Consortium， 后因业务需要更名。</p>
</li>
<li><p>IS0&#x2F;TC 211(国际标准化组织地理信息技术委员会211)</p>
</li>
<li><p>W3C(World Wide Web onsortium，万维网联盟)</p>
</li>
<li><p>OpenGIS(Open Geodata Interoperation Specification,开放地理数据互操作规范)</p>
</li>
<li><p>GML（Geographic Markup Language）由OGC定义的XML（标准通用标记语言的子集）格式，用来表达地理信息要素。</p>
</li>
</ul>
<h2 id="OpenGIS"><a href="#OpenGIS" class="headerlink" title="OpenGIS"></a>OpenGIS</h2><p>要素（Feature）：几何信息和属性信息</p>
<ul>
<li>OpenGIS定义了一组基于数据的服务，而数据的基础是要素（Feature)。所谓要素，简单地说就是一个独立的对象，在地图中可能表现为一个多边形建筑物，在数据库中即是一个独立的条目。要素具有两个必要的组成部分——几何信息和属性信息。</li>
</ul>
<p>几何信息：点（Point）、边缘（LineString）、面（Polygon）和几何集合（GeometryCollection）</p>
<ul>
<li>OpenGIS将几何信息分为点、边缘、面和几何集合四种： 其中这里熟悉的线（LineString)属于边缘的一个子类，而多边形（Polygon)是面的一个子类。也就是说OpenGIS定义的几何类型并不仅仅是我们常见的点、线、多边形三种，它提供了更复杂更详细的定义，增强了未来的可扩展性。另外，几何类型的设计中采用了组合模式（Composite)，将几何集合（GeometryCollection)也定义为一种几何类型。类似地，要素集合（FeatureCollection)也是一种要素。</li>
</ul>
<p>属性信息（FeatureType）：</p>
<ul>
<li>属性信息没有做太多的限制，可以在实际应用中结合具体的实现进行设置。相同的几何类型、属性类型的组合成为要素类型（FeatureType)，类型相同的要素可以存放在一个数据源中。而一个数据源只能拥有一个要素类型。因此，可以用要素类型来描述一组属性相似的要素。</li>
</ul>
<p>在面向对象的模型中，完全可以把要素类型理解为一个类，而要素则是类的实例。通过GIS中间件可以从数据源中取出数据，供WMS服务器和WFS服务器使用。WMS服务器接收请求，根据请求内容的不同，可以返回不同格式的最终数据。例如，WMS可以返回常用图片格式的地图片段供最终用户阅读（类似GoogleMaps)，其中地图是根据一个样式文件(SLD)生成的，它描述了地图的线的宽度、色彩等；WMS也可以返回GeoRSS和KML用来与其他地图服务互通。WFS服务器也可以接收请求，但WFS将返回GML格式的地理信息数据。GML是一种基于XML的数据格式，它可以完整地再现数据，也是OpenGIS数据源的重要形式。也就是说，WFS返回的GML可以继续作为数据源。在WFS请求中，OpenGIS定义了一个Filter标准，用来实现对数据的筛选，使WFS更加灵活。另一方面，WFS还支持通过WFS-t提交客户端对数据的修改。通俗地说，WMS是只读的，而WFS则是可以读写的。</p>
<h2 id="OGC地图服务标准介绍"><a href="#OGC地图服务标准介绍" class="headerlink" title="OGC地图服务标准介绍"></a>OGC地图服务标准介绍</h2><blockquote>
<p>OGC1999年开始 WMT1（Web Map Tested）和 WMT2 互操作项目。其中著名的GML来自WMT1的成果。在WMT2中OGC定义了三种地理参考信息模型：Web Map Server(WMS) , Web Feature Server(WFS) ，Web Coverage Server(WCS) .</p>
<p>OGC 地图服务协议，包括 WMS、WFS、WCS、WMTS、WPS 。其中比较重要的现在用得比较多的标准是GML、WMS和WFS。</p>
</blockquote>
<h3 id="网络地图服务（WMS）"><a href="#网络地图服务（WMS）" class="headerlink" title="网络地图服务（WMS）"></a>网络地图服务（WMS）</h3><ul>
<li><p>Web Map Server（WMS）能够根据用户的请求返回相应的地图（包括PNG，GIF，JPEG等栅格形式或者是SVG和WEB CGM等矢量形式）。</p>
</li>
<li><p>WMS支持网络协议HTTP，所支持的操作是由URL定义的。有三个重要操作 <code>GetCapabilities</code> ， <code>GetMap</code> ， <code>GetFeatureinfo</code> 。</p>
</li>
</ul>
<h3 id="网络要素服务（WFS）"><a href="#网络要素服务（WFS）" class="headerlink" title="网络要素服务（WFS）"></a>网络要素服务（WFS）</h3><ul>
<li><p>Web 要素服务（WFS）支持对地理要素的插入，更新，删除，检索和发现服务。该服务根据HTTP客户请求返回GML数据。</p>
</li>
<li><p>其基础接口是：GetCapabilities，DescribeFeatureType，GetFeature　 GetCapabilities同上。</p>
</li>
</ul>
<h3 id="网络覆盖服务（WCS）"><a href="#网络覆盖服务（WCS）" class="headerlink" title="网络覆盖服务（WCS）"></a>网络覆盖服务（WCS）</h3><ul>
<li><p>Web地理覆盖服务（WCS）：提供的是包含了地理位置信息或属性的空间栅格图层，而不是静态地图的访问。</p>
</li>
<li><p>根据HTTP客户端要求发送相应数据，包括影像，多光谱影像和其它科学数据. 有二个重要操作GetCapabilities，GetCoverage GetCapabilities返回一个描述服务和XML文档，从中可获取覆盖的数据集合。</p>
</li>
</ul>
<h3 id="切片地图服务（TMS）"><a href="#切片地图服务（TMS）" class="headerlink" title="切片地图服务（TMS）"></a>切片地图服务（TMS）</h3><ul>
<li>切片地图服务（TMS）定义了一些操作，这些操作允许用户访问切片地图。WMTS可能是OGC首个支持RESTful访问的服务标准。</li>
</ul>
<h3 id="WMS和WNTS区别"><a href="#WMS和WNTS区别" class="headerlink" title="WMS和WNTS区别"></a>WMS和WNTS区别</h3><ul>
<li>WMTS服务和WMS服务对客户端请求服务的响应不同，比如在接受客户端请求WMTS服务时，返回给客户端是固定大小的瓦片，客户端根据索引号来获取每一张瓦片，而后拼接成地图进行展示，如图1所示；由于瓦片的规则是固定的，服务端可以预先缓存对应的瓦片，客户端需要时直接返回即可，因而WMTS是可缓存的。</li>
</ul>
<p><img src="https://raw.githubusercontent.com/2757412961/TyporaImageRepository/master/img/fig-wmts-server.png" alt="img"></p>
<h1 id="END"><a href="#END" class="headerlink" title="END"></a>END</h1></div><hr></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2026 By ZJH</div><div class="framework-info"><span>驱动 - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/lib/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.1"></script><script src="/js/fancybox.js?version=1.9.1"></script><script src="/js/sidebar.js?version=1.9.1"></script><script src="/js/copy.js?version=1.9.1"></script><script src="/js/fireworks.js?version=1.9.1"></script><script src="/js/transition.js?version=1.9.1"></script><script src="/js/scroll.js?version=1.9.1"></script><script src="/js/head.js?version=1.9.1"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>